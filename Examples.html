

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Examples &mdash; python-ilorest-library 3.1.0 documentation</title>















    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />





        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="python-ilorest-library 3.1.0 documentation" href="index.html"/>
        <link rel="next" title="Frequently Asked Questions" href="Frequently-Asked-Questions.html"/>
        <link rel="prev" title="System Compatibility" href="System-Compatibility.html"/>


  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">


  <div class="wy-grid-for-nav">


    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">



            <a href="index.html" class="icon icon-home"> python-ilorest-library



          </a>




              <div class="version">
                3.1
              </div>




<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">



                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="API-Overview.html">API Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="Installation-Guide.html">Installation Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="Client-Quick-Start.html">Client Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="Advanced-Usage.html">Advanced Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="Monolith.html">The Monolith</a></li>
<li class="toctree-l1"><a class="reference internal" href="System-Compatibility.html">System Compatibility</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#redfish-example-reference-table">Redfish Example Reference Table</a></li>
<li class="toctree-l2"><a class="reference internal" href="#legacy-rest-example-reference-table">Legacy Rest Example Reference Table</a></li>
<li class="toctree-l2"><a class="reference internal" href="#add-ilo-manager-account">Add iLO Manager Account</a></li>
<li class="toctree-l2"><a class="reference internal" href="#bios-revert-default">BIOS Revert Default</a></li>
<li class="toctree-l2"><a class="reference internal" href="#change-bios-setting">Change BIOS Setting</a></li>
<li class="toctree-l2"><a class="reference internal" href="#change-temporary-boot-order">Change Temporary Boot Order</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#example-of-the-boot-object">Example of the Boot Object</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#change-boot-order">Change Boot Order</a></li>
<li class="toctree-l2"><a class="reference internal" href="#clear-ahs-data">Clear AHS Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#clear-iel-iml-data">Clear IEL/IML Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id1">Clear IEL/IML Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#computer-system-data">Computer System Data</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#configure-snmp">Configure SNMP</a></li>
<li class="toctree-l2"><a class="reference internal" href="#enable-ntp">Enable NTP</a></li>
<li class="toctree-l2"><a class="reference internal" href="#enable-secure-boot">Enable Secure Boot</a></li>
<li class="toctree-l2"><a class="reference internal" href="#expand-data">Expand Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#response-example">Response Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#find-ilo-mac-address">Find iLO MAC Address</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id2">Response Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#get-certificate-signing-request">Get Certificate Signing Request</a></li>
<li class="toctree-l2"><a class="reference internal" href="#get-ahs-data">Get AHS Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#get-base-registries">Get Base Registries</a></li>
<li class="toctree-l2"><a class="reference internal" href="#get-eskm">Get ESKM</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id3">Response Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#get-ilo-ip">Get iLO IP</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id4">Response Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#get-ilo-nic">Get iLO NIC</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id5">Response Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#get-license-key">Get License Key</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id6">Response Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#get-logical-drives">Get Logical Drives</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id7">Response Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#get-power-metrics">Get Power Metrics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id8">Response Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#get-resource-directory">Get Resource Directory</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id9">Response Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#get-schemas">Get Schemas</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id10">Response Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#get-smart-array-encryption">Get Smart Array Encryption</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id11">Response Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#import-ssl-certificate">Import SSL Certificate</a></li>
<li class="toctree-l2"><a class="reference internal" href="#modify-ilo-management-user-account">Modify iLO Management User Account</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id12">Response Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#modify-virtual-media">Modify Virtual Media</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id13">Response Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#reboot-server">Reboot Server</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id14">Response Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#remove-an-ilo-user-management-account">Remove an iLO User Management Account</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id15">Response Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#reset-eskm-event-log">Reset ESKM Event log</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id16">Response Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#reset-ilo">Reset iLO</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id17">Response Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#sessions">Sessions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#session-creation">Session Creation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id18">Session Creation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ilo-management-nic-data">iLO Management NIC Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#bios-iscsi">BIOS iSCSI</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id19">Response Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#set-bios-password">Set BIOS Password</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id20">Response Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#set-eskm-primary-key">Set ESKM Primary Key</a></li>
<li class="toctree-l2"><a class="reference internal" href="#set-ilo-ntp-server-settings">Set iLO NTP Server Settings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id21">Response Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#set-timezone">Set Timezone</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id22">Response Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#configure-ilo-license-key">Configure iLO License Key</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#response-example-valid">Response Example Valid</a></li>
<li class="toctree-l3"><a class="reference internal" href="#response-example-invalid">Response Example Invalid</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#server-asset-tag">Server Asset Tag</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id23">Response Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#server-uid-light">Server UID Light</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id24">Response Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#server-firmware-inventory">Server Firmware Inventory</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id25">Response Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#test-eskm-connectivity">Test ESKM Connectivity</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#response-example-not-configured">Response Example Not Configured</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id26">Test ESKM Connectivity</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id27">Response Example Not Configured</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#update-ilo-firmware">Update iLO Firmware</a></li>
<li class="toctree-l2"><a class="reference internal" href="#upload-firmware-to-ilo-repository">Upload firmware to iLO Repository</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Frequently-Asked-Questions.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Reference.html">Reference Documentation</a></li>
</ul>



        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">


      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">python-ilorest-library</a>
      </nav>



      <div class="wy-nav-content">
        <div class="rst-content">






<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>

    <li>Examples</li>
    <li class="wy-breadcrumbs-aside">


          <a href="_sources/Examples.rest.txt" rel="nofollow"></a>


    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">

  <a class="reference internal image-reference" href="_images/hpe_logo2.png"><img alt="_images/hpe_logo2.png" src="_images/hpe_logo2.png" style="width: 150pt;" /></a>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="toctree-wrapper compound">
</div>
<div class="section" id="examples">
<h1>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Successful creation, modification or deletion of a resource will usually result in a response code of 200 or 201.
An unsuccessful attempt will likely result in a 400 error code with a more detailed error message within the body of
the response, <a class="reference external" href="mailto:'&#37;&#52;&#48;Message&#46;ExtendedInfo">‘<span>&#64;</span>Message<span>&#46;</span>ExtendedInfo</a>’.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Examples showcasing Redfish standard properties and Actions will work for any BMC implementing Redfish. Any HPE OEM extensions are labeled in the examples as such.</p>
</div>
<p>The <a class="reference external" href="https://github.hpe.com/intelligent-provisioning/python-redfish-library/tree/master/examples/Redfish">Redfish</a> and
<a class="reference external" href="https://github.hpe.com/intelligent-provisioning/python-redfish-library/tree/master/examples/Legacy_Rest">Legacy_Rest</a> folders
contain many examples for performing different iLO tasks using the Redfish API and Legacy RESTful API respectively.</p>
<div class="section" id="redfish-example-reference-table">
<h2>Redfish Example Reference Table<a class="headerlink" href="#redfish-example-reference-table" title="Permalink to this headline">¶</a></h2>
<table class="docutils align-default">
<colgroup>
<col style="width: 47%" />
<col style="width: 53%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Example</p></td>
<td><p>Link</p></td>
</tr>
<tr class="row-even"><td><p>Add an iLO Manager Account</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/add_user_account.py">Redfish_add_user_account</a></p></td>
</tr>
<tr class="row-odd"><td><p>Revert the BIOs to default values</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/bios_revert_default.py">Redfish_bios_revert_default</a></p></td>
</tr>
<tr class="row-even"><td><p>Change the BIOs settings.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/change_bios_setting.py">Redfish_change_bios_setting</a></p></td>
</tr>
<tr class="row-odd"><td><p>Change the boot order for HPE iLO systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/change_boot_order.py">Redfish_change_boot_order</a></p></td>
</tr>
<tr class="row-even"><td><p>Change the temporary boot order.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/change_temporary_boot_order.py">Redfish_change_temporary_boot_order</a></p></td>
</tr>
<tr class="row-odd"><td><p>Clear AHS data for HPE iLO systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/clear_ahs_data.py">Redfish_clear_ahs_data</a></p></td>
</tr>
<tr class="row-even"><td><p>Clear IEL or IML Logs for HPE iLO systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/clear_ilo_IEL_IML_log.py">Redfish_clear_ilo_IEL_IML_log</a></p></td>
</tr>
<tr class="row-odd"><td><p>Gather the computer system details.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/computer_details.py">Redfish_computer_details</a></p></td>
</tr>
<tr class="row-even"><td><p>Configure SNMP for HPE iLO systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/configure_snmp.py">Redfish_configure_snmp</a></p></td>
</tr>
<tr class="row-odd"><td><p>Enable NTP servers for HPE iLO systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/enable_ntp_servers.py">Redfish_enable_ntp_servers</a></p></td>
</tr>
<tr class="row-even"><td><p>Enable secure boot.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/enable_secure_boot.py">Redfish_enable_secure_boot</a></p></td>
</tr>
<tr class="row-odd"><td><p>Expand data responses.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/expand_data.py">Redfish_expand_data</a></p></td>
</tr>
<tr class="row-even"><td><p>Clear IEL or IML Logs for HPE iLO systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/find_ilo_mac_address.py">Redfish_find_ilo_mac_address</a></p></td>
</tr>
<tr class="row-odd"><td><p>Generate a certificate signing request for <br>
HPE iLO systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/generate_csr.py">Redfish_generate_csr</a></p></td>
</tr>
<tr class="row-even"><td><p>Gather ESKM data for HPE iLO systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/get_ESKM.py">Redfish_get_ESKM</a></p></td>
</tr>
<tr class="row-odd"><td><p>Gather the Logical Drives on an HPE iLO system.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/get_LogicalDrives.py">Redfish_get_LogicalDrives</a></p></td>
</tr>
<tr class="row-even"><td><p>Gather the Smart Array encryption settings on <br>
HPE iLO based systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/get_SmartArray_EncryptionSettings.py">Redfish_get_SmartArray_EncryptionSettings</a></p></td>
</tr>
<tr class="row-odd"><td><p>Gather AHS data for HPE iLO systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/get_ahs_data.py">Redfish_get_ahs_data</a></p></td>
</tr>
<tr class="row-even"><td><p>Obtain the base message registry.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/get_base_registry.py">Redfish_get_base_registry</a></p></td>
</tr>
<tr class="row-odd"><td><p>Obtain the Manager IP.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/get_ilo_ip.py">Redfish_get_ilo_ip</a></p></td>
</tr>
<tr class="row-even"><td><p>Obtain the Manager NIC data.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/get_ilo_nic.py">Redfish_get_ilo_nic</a></p></td>
</tr>
<tr class="row-odd"><td><p>Obtain an iLO license key for HPE iLO systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/get_license_key.py">Redfish_get_license_key</a></p></td>
</tr>
<tr class="row-even"><td><p>Obtain the power metrics average on HPE iLO <br>
systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/get_powermetrics_average.py">Redfish_get_powermetrics_average</a></p></td>
</tr>
<tr class="row-odd"><td><p>Obtain iLO information.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/get_resource_directory.py">Redfish_get_resource_directory</a></p></td>
</tr>
<tr class="row-even"><td><p>Obtain schema data on any BMC with schemas <br>
available.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/get_schema.py">Redfish_get_schema</a></p></td>
</tr>
<tr class="row-odd"><td><p>Obtain the iLO information, such as iLO <br>
generation, version and resource directory for <br>
HPE iLO systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/ilorest_util.py">Redfish_ilorest_util</a></p></td>
</tr>
<tr class="row-even"><td><p>Import an SSL certificate for HPE iLO systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/import_ssl.py">Redfish_import_ssl</a></p></td>
</tr>
<tr class="row-odd"><td><p>Modify a user account.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/modify_user_account.py">Redfish_modify_user_account</a></p></td>
</tr>
<tr class="row-even"><td><p>Mount virtual media for HPE iLO systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/mount_virtual_media_iso.py">Redfish_mount_virtual_media_iso</a></p></td>
</tr>
<tr class="row-odd"><td><p>Create Redfish client.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/quickstart_redfish.py">Redfish_quickstart_redfish</a></p></td>
</tr>
<tr class="row-even"><td><p>Reboot a server.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/reboot_server.py">Redfish_reboot_server</a></p></td>
</tr>
<tr class="row-odd"><td><p>Remove a user account.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/remove_account.py">Redfish_remove_account</a></p></td>
</tr>
<tr class="row-even"><td><p>Reset the ESKM event log for HPE iLO systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/reset_ESKM_eventlog.py">Redfish_reset_ESKM_eventlog</a></p></td>
</tr>
<tr class="row-odd"><td><p>Reset a Manager.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/reset_ilo.py">Redfish_reset_ilo</a></p></td>
</tr>
<tr class="row-even"><td><p>Reset a sever.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/reset_server.py">Redfish_reset_server</a></p></td>
</tr>
<tr class="row-odd"><td><p>Manually manage sessions with Redfish</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/sessions.py">Redfish_sessions</a></p></td>
</tr>
<tr class="row-even"><td><p>Set the primary ESKM key server properties <br>
for HPE iLO systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/set_ESKM_PrimaryKeyServer.py">Redfish_set_ESKM_PrimaryKeyServer</a></p></td>
</tr>
<tr class="row-odd"><td><p>Set the ESKM username and password for HPE <br>
iLO systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/set_ESKM_username_password.py">Redfish_set_ESKM_username_password</a></p></td>
</tr>
<tr class="row-even"><td><p>Set active Manager NIC.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/set_active_ilo_nic.py">Redfish_set_active_ilo_nic</a></p></td>
</tr>
<tr class="row-odd"><td><p>Set an ISCSI boot instance for HPE iLO <br>
systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/set_bios_iscsi.py">Redfish_set_bios_iscsi</a></p></td>
</tr>
<tr class="row-even"><td><p>Set the BIOS password for HPE iLO systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/set_bios_password.py">Redfish_set_bios_password</a></p></td>
</tr>
<tr class="row-odd"><td><p>Set the Manager ethernet interface static IP.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/set_ethernet_management_iface_static_ip.py">Redfish_set_ethernet_management_iface_static_ip</a></p></td>
</tr>
<tr class="row-even"><td><p>Set the NTP servers for HPE iLO systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/set_ilo_ntp_servers.py">Redfish_set_ilo_ntp_servers</a></p></td>
</tr>
<tr class="row-odd"><td><p>Set the time zone for HPE iLO systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/set_ilo_timezone.py">Redfish_set_ilo_timezone</a></p></td>
</tr>
<tr class="row-even"><td><p>Add a license key for HPE iLO systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/set_license_key.py">Redfish_set_license_key</a></p></td>
</tr>
<tr class="row-odd"><td><p>Set the server asset tag.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/set_server_asset_tag.py">Redfish_set_server_asset_tag</a></p></td>
</tr>
<tr class="row-even"><td><p>Configure SNMP alert for HPE iLO systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/set_snmp_alert.py">Redfish_set_snmp_alert</a></p></td>
</tr>
<tr class="row-odd"><td><p>Set the UID light.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/set_uid_light.py">Redfish_set_uid_light</a></p></td>
</tr>
<tr class="row-even"><td><p>Provide the firmware inventory on HPE iLO <br>
systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/software_firmware_inventory.py">Redfish_software_firmware_inventory</a></p></td>
</tr>
<tr class="row-odd"><td><p>Test a connection to the ESKM system for HPE <br>
iLO systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/test_ESKM_connection.py">Redfish_test_ESKM_connection</a></p></td>
</tr>
<tr class="row-even"><td><p>Update the firmware by using an HTTP URL.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/update_ilo_firmware.py">Redfish_update_ilo_firmware</a></p></td>
</tr>
<tr class="row-odd"><td><p>Upload the firmware to the iLO Repository for <br>
flashing.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/upload_firmware_ilo_repository.py">Redfish_upload_firmware_ilo_repository</a></p></td>
</tr>
<tr class="row-even"><td><p>Upload a firmware component with a size less <br>
than 32 GB and associated compsig signature <br>
file to the iLO repository.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Redfish/upload_firmware_ilo_repository_with_compsig.py">Redfish_upload_firmware_ilo_repository_with_compsig</a></p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="legacy-rest-example-reference-table">
<h2>Legacy Rest Example Reference Table<a class="headerlink" href="#legacy-rest-example-reference-table" title="Permalink to this headline">¶</a></h2>
<table class="docutils align-default">
<colgroup>
<col style="width: 47%" />
<col style="width: 53%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Example</p></td>
<td><p>Link</p></td>
</tr>
<tr class="row-even"><td><p>Add an iLO user account.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/add_ilo_user_account.py">Legacy_Rest_add_ilo_user_account</a></p></td>
</tr>
<tr class="row-odd"><td><p>Revert the BIOs to default values.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/bios_revert_default.py">Legacy_Rest_bios_revert_default</a></p></td>
</tr>
<tr class="row-even"><td><p>Change the BIOs settings.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/change_bios_setting.py">Legacy_Rest_change_bios_setting</a></p></td>
</tr>
<tr class="row-odd"><td><p>Change the boot order for HPE iLO systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/change_boot_order.py">Legacy_Rest_change_boot_order</a></p></td>
</tr>
<tr class="row-even"><td><p>Change the temporary boot order.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/change_temporary_boot_order.py">Legacy_Rest_change_temporary_boot_order</a></p></td>
</tr>
<tr class="row-odd"><td><p>Clear the AHS data.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/clear_ahs_data.py">Legacy_Rest_clear_ahs_data</a></p></td>
</tr>
<tr class="row-even"><td><p>Clear IEL or IML Logs for HPE iLO systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/clear_ilo_event_log.py">Legacy_Rest_clear_ilo_event_log</a></p></td>
</tr>
<tr class="row-odd"><td><p>Clear the IML.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/clear_iml.py">Legacy_Rest_clear_iml</a></p></td>
</tr>
<tr class="row-even"><td><p>Gather the computer system details.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/computer_details.py">Legacy_Rest_computer_details</a></p></td>
</tr>
<tr class="row-odd"><td><p>Configure SNMP for HPE iLO systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/configure_snmp.py">Legacy_Rest_configure_snmp</a></p></td>
</tr>
<tr class="row-even"><td><p>Dump the ESKM event log.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/dump_eskm_event_log.py">Legacy_Rest_dump_eskm_event_log</a></p></td>
</tr>
<tr class="row-odd"><td><p>Dump the iLO event log.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/dump_ilo_event_log.py">Legacy_Rest_dump_ilo_event_log</a></p></td>
</tr>
<tr class="row-even"><td><p>Dump the Manager NIC data.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/dump_ilo_nic.py">Legacy_Rest_dump_ilo_nic</a></p></td>
</tr>
<tr class="row-odd"><td><p>Dump the IML.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/dump_iml.py">Legacy_Rest_dump_iml</a></p></td>
</tr>
<tr class="row-even"><td><p>Enables secure boot.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/enable_secure_boot.py">Legacy_Rest_enable_secure_boot</a></p></td>
</tr>
<tr class="row-odd"><td><p>Clear IEL or IML Logs for HPE iLO systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/find_ilo_mac_address.py">Legacy_Rest_find_ilo_mac_address</a></p></td>
</tr>
<tr class="row-even"><td><p>Generate a certificate signing request for <br>
HPE iLO systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/generate_csr.py">Legacy_Rest_generate_csr</a></p></td>
</tr>
<tr class="row-odd"><td><p>Gather ESKM data for HPE iLO systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/get_ESKM.py">Legacy_Rest_get_ESKM</a></p></td>
</tr>
<tr class="row-even"><td><p>Gather the encryption settings on HPE iLO systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/get_EncryptionSettings.py">Legacy_Rest_get_EncryptionSettings</a></p></td>
</tr>
<tr class="row-odd"><td><p>Obtain the logical drives.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/get_LogicalDrives.py">Legacy_Rest_get_LogicalDrives</a></p></td>
</tr>
<tr class="row-even"><td><p>Gather AHS data for HPE iLO systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/get_ahs_data.py">Legacy_Rest_get_ahs_data</a></p></td>
</tr>
<tr class="row-odd"><td><p>Obtain the base message registry.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/get_base_registry.py">Legacy_Rest_get_base_registry</a></p></td>
</tr>
<tr class="row-even"><td><p>Obtain the CSR.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/get_csr.py">Legacy_Rest_get_csr</a></p></td>
</tr>
<tr class="row-odd"><td><p>Obtain the Manager IP.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/get_ilo_ip.">Legacy_Rest_get_ilo_ip</a></p></td>
</tr>
<tr class="row-even"><td><p>Obtain the Manager NIC data.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/get_ilo_nic.py">Legacy_Rest_get_ilo_nic</a></p></td>
</tr>
<tr class="row-odd"><td><p>Obtain an iLO license key for HPE iLO systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/get_license_key.py">Legacy_Rest_get_license_key</a></p></td>
</tr>
<tr class="row-even"><td><p>Obtain the power metrics average on HPE iLO <br>
systems</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/get_powermetrics_average.py">Legacy_Rest_get_powermetrics_average</a></p></td>
</tr>
<tr class="row-odd"><td><p>Obtain the iLO information, such as iLO <br>
generation, version, and resource directory <br>
for HPE iLO systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/get_resource_directory.py">Legacy_Rest_get_resource_directory</a></p>
<p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/get_resource_directory.py">Legacy_Rest_get_resource_directory</a></p>
</td>
</tr>
<tr class="row-even"><td><p>Obtain the schema data on any system with <br>
schemas on system.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/get_schema.py">Legacy_Rest_get_schema</a></p></td>
</tr>
<tr class="row-odd"><td><p>Import an SSL certificate for HPE iLO systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/import_ssl.py">Legacy_Rest_import_ssl</a></p></td>
</tr>
<tr class="row-even"><td><p>Modify a user account.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/modify_ilo_user_account.py">Legacy_Rest_modify_ilo_user_account</a></p></td>
</tr>
<tr class="row-odd"><td><p>Mount virtual media for HPE iLO systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/mount_virtual_media_iso.py">Legacy_Rest_mount_virtual_media_iso</a></p></td>
</tr>
<tr class="row-even"><td><p>Remove an iLO user account.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/remove_ilo_account.py">Legacy_Rest_remove_ilo_account</a></p></td>
</tr>
<tr class="row-odd"><td><p>Reset the ESKM event log for HPE iLO systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/reset_ESKM_eventlog.py">Legacy_Rest_reset_ESKM_eventlog</a></p></td>
</tr>
<tr class="row-even"><td><p>Reset iLO.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/reset_ilo.py">Legacy_Rest_reset_ilo</a></p></td>
</tr>
<tr class="row-odd"><td><p>Reset a sever.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/reset_server.py">Legacy_Rest_reset_server</a></p></td>
</tr>
<tr class="row-even"><td><p>Create a session.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/sessions.py">Legacy_Rest_sessions</a></p></td>
</tr>
<tr class="row-odd"><td><p>Set active Manager NIC.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/set_active_ilo_nic.py">Legacy_Rest_set_active_ilo_nic</a></p></td>
</tr>
<tr class="row-even"><td><p>Set the DHCP boot instance for HPE iLO systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/set_bios_dhcp.py">Legacy_Rest_set_bios_dhcp</a></p></td>
</tr>
<tr class="row-odd"><td><p>Set the primary ESKM key server for HPE iLO <br>
systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/set_ESKM_PrimaryKeyServer.py">Legacy_Rest_set_ESKM_PrimaryKeyServer</a></p></td>
</tr>
<tr class="row-even"><td><p>Set the ESKM username and password for HPE iLO <br>
systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/set_ESKM_username_password.py">Legacy_Rest_set_ESKM_username_password</a></p></td>
</tr>
<tr class="row-odd"><td><p>Set the NTP servers for HPE iLO systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/set_Ilo_ntp_servers.py">Legacy_Rest_set_Ilo_ntp_servers</a></p></td>
</tr>
<tr class="row-even"><td><p>Set an ISCSI boot instance for HPE iLO systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/set_bios_iscsi.py">Legacy_Rest_set_bios_iscsi</a></p></td>
</tr>
<tr class="row-odd"><td><p>Set the BIOS password for HPE iLO systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/set_bios_password.py">Legacy_Rest_set_bios_password</a></p></td>
</tr>
<tr class="row-even"><td><p>Set the BIOS service.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/set_bios_service.py">Legacy_Rest_set_bios_service</a></p></td>
</tr>
<tr class="row-odd"><td><p>Set the UEFI shell startup.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/set_bios_uefi_shell_startup.py">Legacy_Rest_set_bios_uefi_shell_startup</a></p></td>
</tr>
<tr class="row-even"><td><p>Set the URL boot file.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/set_bios_url_boot_file.py">Legacy_Rest_set_bios_url_boot_file</a></p></td>
</tr>
<tr class="row-odd"><td><p>Set the time zone for HPE iLO systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/set_ilo_timezone.py">Legacy_Rest_set_ilo_timezone</a></p></td>
</tr>
<tr class="row-even"><td><p>Add a license key for HPE iLO systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/set_license_key.py">Legacy_Rest_set_license_key</a></p></td>
</tr>
<tr class="row-odd"><td><p>Set the server asset tag.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/set_server_asset_tag.py">Legacy_Rest_set_server_asset_tag</a></p></td>
</tr>
<tr class="row-even"><td><p>Set the UID light.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/set_uid_light.py">Legacy_Rest_set_uid_light</a></p></td>
</tr>
<tr class="row-odd"><td><p>Test a connection to the ESKM system for HPE <br>
iLO systems.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/test_ESKM_connection.py">Legacy_Rest_test_ESKM_connection</a></p></td>
</tr>
<tr class="row-even"><td><p>Update the firmware by using an HTTP URL.</p></td>
<td><p><a class="reference external" href="https://github.com/HewlettPackard/python-ilorest-library/blob/master/examples/Legacy_Rest/update_ilo_firmware.py">Legacy_Rest_update_ilo_firmware</a></p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="add-ilo-manager-account">
<h2>Add iLO Manager Account<a class="headerlink" href="#add-ilo-manager-account" title="Permalink to this headline">¶</a></h2>
<p>Add an iLO Manager Account based on permissions (iLO 4 and iLO 5) or role ID (iLO 5).</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">add_ilo_user_account</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">,</span> <span class="n">new_loginname</span><span class="p">,</span> <span class="n">new_username</span><span class="p">,</span> <span class="n">new_password</span><span class="p">,</span> <span class="n">role_id</span><span class="p">,</span> \
                     <span class="n">privilege_dict</span><span class="p">):</span>
<span class="n">resource_instances</span> <span class="o">=</span> <span class="n">get_resource_directory</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">)</span>

<span class="k">if</span> <span class="n">DISABLE_RESOURCE_DIR</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">resource_instances</span><span class="p">:</span>
    <span class="c1">#resource directory is not available so we will navigate through paths manually to obtain</span>
    <span class="c1">#account info</span>
    <span class="n">account_service_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;AccountService&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
    <span class="n">account_service_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">account_service_uri</span><span class="p">)</span>
    <span class="n">account_collection_uri</span> <span class="o">=</span> <span class="n">account_service_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Accounts&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
    <span class="c1">#Add via role id</span>
    <span class="n">body</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;RoleId&quot;</span><span class="p">:</span> <span class="n">role_id</span><span class="p">}</span>
<span class="k">else</span><span class="p">:</span>
    <span class="c1">#obtain all account instances from resource directory</span>
    <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">resource_instances</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;#ManagerAccountCollection.&#39;</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.type&#39;</span><span class="p">]:</span>
            <span class="n">account_collection_uri</span> <span class="o">=</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
    <span class="n">body</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Oem&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;Hpe&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;Privileges&quot;</span><span class="p">:</span> <span class="p">{}}}}</span>
    <span class="c1">#HPE server, so add via privileges</span>
    <span class="k">for</span> <span class="n">priv</span> <span class="ow">in</span> <span class="n">privilege_dict</span><span class="p">:</span>
        <span class="n">body</span><span class="p">[</span><span class="s2">&quot;Oem&quot;</span><span class="p">][</span><span class="s2">&quot;Hpe&quot;</span><span class="p">][</span><span class="s2">&quot;Privileges&quot;</span><span class="p">][</span><span class="n">priv</span><span class="p">]</span> <span class="o">=</span> <span class="n">privilege_dict</span><span class="p">[</span><span class="n">priv</span><span class="p">]</span>
    <span class="c1">#Add login name</span>
    <span class="n">body</span><span class="p">[</span><span class="s2">&quot;Oem&quot;</span><span class="p">][</span><span class="s2">&quot;Hpe&quot;</span><span class="p">][</span><span class="s2">&quot;LoginName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_loginname</span>

<span class="c1">#Fill in the rest of the payload</span>
<span class="n">body</span><span class="p">[</span><span class="s2">&quot;UserName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_username</span>
<span class="n">body</span><span class="p">[</span><span class="s2">&quot;Password&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_password</span>

<span class="c1">#We pass the URI and the dictionary as a POST command (part of the redfish object)</span>
<span class="n">resp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">account_collection_uri</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span>

<span class="c1">#If iLO responds with soemthing outside of 200 or 201 then lets check the iLO extended info</span>
<span class="c1">#error message to see what went wrong</span>
<span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">400</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="s1">&#39;@Message.ExtendedInfo&#39;</span><span class="p">],</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;A response error occurred, unable to access iLO Extended Message &quot;</span>\
                         <span class="s2">&quot;Info...&quot;</span><span class="p">)</span>
<span class="k">elif</span> <span class="ow">not</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">201</span><span class="p">]:</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;An http response of &#39;</span><span class="si">%s</span><span class="s2">&#39; was returned.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Success!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">dict</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="bios-revert-default">
<h2>BIOS Revert Default<a class="headerlink" href="#bios-revert-default" title="Permalink to this headline">¶</a></h2>
<p>Set all BIOS attributes to their respective factory default states.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">bios_revert_default</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">):</span>

    <span class="n">bios_reset_action_uri</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">resource_instances</span> <span class="o">=</span> <span class="n">get_resource_directory</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">DISABLE_RESOURCE_DIR</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">resource_instances</span><span class="p">:</span>
        <span class="c1">#if we do not have a resource directory or want to force it&#39;s non use to find the</span>
        <span class="c1">#relevant URI</span>
        <span class="n">systems_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Systems&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">systems_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">systems_uri</span><span class="p">)</span>
        <span class="n">systems_members_uri</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">systems_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]))[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">systems_members_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">systems_members_uri</span><span class="p">)</span>
        <span class="n">bios_uri</span> <span class="o">=</span> <span class="n">systems_members_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Bios&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">bios_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">bios_uri</span><span class="p">)</span>
        <span class="n">bios_reset_action_uri</span> <span class="o">=</span> <span class="n">bios_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Actions&#39;</span><span class="p">][</span><span class="s1">&#39;#Bios.ResetBios&#39;</span><span class="p">][</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#Use Resource directory to find the relevant URI</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">resource_instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;#Bios.&#39;</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.type&#39;</span><span class="p">]:</span>
                <span class="n">bios_uri</span> <span class="o">=</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
                <span class="n">bios_data</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">bios_uri</span><span class="p">)</span>
                <span class="n">bios_reset_action_uri</span> <span class="o">=</span> <span class="n">bios_data</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Actions&#39;</span><span class="p">][</span><span class="s1">&#39;#Bios.ResetBios&#39;</span><span class="p">][</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
                <span class="k">break</span>

    <span class="n">body</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Action&#39;</span><span class="p">:</span> <span class="s1">&#39;Bios.ResetBios&#39;</span><span class="p">,</span> <span class="s1">&#39;ResetType&#39;</span><span class="p">:</span><span class="s1">&#39;default&#39;</span><span class="p">}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">bios_reset_action_uri</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span>

    <span class="c1">#If iLO responds with soemthing outside of 200 or 201 then lets check the iLO extended info</span>
    <span class="c1">#error message to see what went wrong</span>
    <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">400</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="s1">&#39;@Message.ExtendedInfo&#39;</span><span class="p">],</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;A response error occurred, unable to access iLO Extended Message &quot;</span>\
                             <span class="s2">&quot;Info...&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;An http response of </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s2"> was returned.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Success!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">dict</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="change-bios-setting">
<h2>Change BIOS Setting<a class="headerlink" href="#change-bios-setting" title="Permalink to this headline">¶</a></h2>
<p>Alter one ore more BIOS attributes.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">change_bios_setting</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">,</span> <span class="n">bios_property</span><span class="p">,</span> <span class="n">property_value</span><span class="p">,</span> <span class="n">bios_password</span><span class="p">):</span>

    <span class="n">bios_uri</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">bios_data</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">resource_instances</span> <span class="o">=</span> <span class="n">get_resource_directory</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DISABLE_RESOURCE_DIR</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">resource_instances</span><span class="p">:</span>
        <span class="c1">#if we do not have a resource directory or want to force it&#39;s non use to find the</span>
        <span class="c1">#relevant URI</span>
        <span class="n">systems_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Systems&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">systems_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">systems_uri</span><span class="p">)</span>
        <span class="n">systems_members_uri</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">systems_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]))[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">systems_members_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">systems_members_uri</span><span class="p">)</span>
        <span class="n">bios_uri</span> <span class="o">=</span> <span class="n">systems_members_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Bios&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">bios_data</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">bios_uri</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#Use Resource directory to find the relevant URI</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">resource_instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;#Bios.&#39;</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.type&#39;</span><span class="p">]:</span>
                <span class="n">bios_uri</span> <span class="o">=</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
                <span class="n">bios_data</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">bios_uri</span><span class="p">)</span>
                <span class="k">break</span>

    <span class="k">if</span> <span class="n">bios_data</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Showing bios attributes before changes:</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">bios_data</span><span class="o">.</span><span class="n">dict</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">bios_uri</span><span class="p">:</span>
        <span class="c1">#Bios settings URI is needed</span>
        <span class="n">bios_settings_uri</span> <span class="o">=</span> <span class="n">bios_data</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;@Redfish.Settings&#39;</span><span class="p">][</span><span class="s1">&#39;SettingsObject&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">body</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Attributes&#39;</span><span class="p">:</span> <span class="p">{</span><span class="n">bios_property</span><span class="p">:</span> <span class="n">property_value</span><span class="p">}}</span>
        <span class="c1">#update bios password</span>
        <span class="k">if</span> <span class="n">bios_password</span><span class="p">:</span>
            <span class="n">_redfishobj</span><span class="o">.</span><span class="n">bios_password</span> <span class="o">=</span> <span class="n">bios_password</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">patch</span><span class="p">(</span><span class="n">bios_settings_uri</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span>

        <span class="c1">#If iLO responds with soemthing outside of 200 or 201 then lets check the iLO extended info</span>
        <span class="c1">#error message to see what went wrong</span>
        <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">400</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="s1">&#39;@Message.ExtendedInfo&#39;</span><span class="p">],</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> \
                                                                                <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;A response error occurred, unable to access iLO Extended &quot;</span>\
                                 <span class="s2">&quot;Message Info...&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;An http response of </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s2"> was returned.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Success!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">dict</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            <span class="c1">#uncomment if you would like to see the full list of attributes</span>
            <span class="c1">#print(&quot;\n\nShowing bios attributes after changes:\n\n&quot;)</span>
            <span class="c1">#bios_data = _redfishobj.get(bios_uri)</span>
            <span class="c1">#print(json.dumps(bios_data.dict, indent=4, sort_keys=True))</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="change-temporary-boot-order">
<h2>Change Temporary Boot Order<a class="headerlink" href="#change-temporary-boot-order" title="Permalink to this headline">¶</a></h2>
<p>Alter the temporary boot order.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">change_temporary_boot_order</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">,</span> <span class="n">boottarget</span><span class="p">):</span>

    <span class="n">systems_members_uri</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">systems_members_response</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">resource_instances</span> <span class="o">=</span> <span class="n">get_resource_directory</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DISABLE_RESOURCE_DIR</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">resource_instances</span><span class="p">:</span>
        <span class="n">systems_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Systems&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">systems_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">systems_uri</span><span class="p">)</span>
        <span class="n">systems_members_uri</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">systems_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]))[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">systems_members_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">systems_members_uri</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">resource_instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;#ComputerSystem.&#39;</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.type&#39;</span><span class="p">]:</span>
                <span class="n">systems_members_uri</span> <span class="o">=</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
                <span class="n">systems_members_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">systems_members_uri</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">systems_members_response</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Showing bios attributes before changes:</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">systems_members_response</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Boot&#39;</span><span class="p">),</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
    <span class="n">body</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Boot&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;BootSourceOverrideTarget&#39;</span><span class="p">:</span> <span class="n">boottarget</span><span class="p">}}</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">patch</span><span class="p">(</span><span class="n">systems_members_uri</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span>

    <span class="c1">#If iLO responds with soemthing outside of 200 or 201 then lets check the iLO extended info</span>
    <span class="c1">#error message to see what went wrong</span>
    <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">400</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="s1">&#39;@Message.ExtendedInfo&#39;</span><span class="p">],</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">excp</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;A response error occurred, unable to access iLO Extended Message &quot;</span>\
                             <span class="s2">&quot;Info...&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;An http response of </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s2"> was returned.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Success!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">dict</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">systems_members_response</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Showing boot override target:</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">systems_members_response</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Boot&#39;</span><span class="p">),</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="example-of-the-boot-object">
<h3>Example of the Boot Object<a class="headerlink" href="#example-of-the-boot-object" title="Permalink to this headline">¶</a></h3>
<p>The folowing JSON output can be obtained first by noting the <em>systems_members_response</em> on line 42 above.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">else</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">resource_instances</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;#ComputerSystem.&#39;</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.type&#39;</span><span class="p">]:</span>
            <span class="n">systems_members_uri</span> <span class="o">=</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
            <span class="n">systems_members_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">systems_members_uri</span><span class="p">)</span>

<span class="k">if</span> <span class="n">systems_members_response</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Showing bios attributes before changes:</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">systems_members_response</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Boot&#39;</span><span class="p">),</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
<p>The user can preview the data prior:</p>
<div class="highlight-JSON notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;BootOptions&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;@odata.id&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/Systems/1/BootOptions/&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;BootOrder&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;Boot0011&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Boot0019&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Boot0009&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Boot0012&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Boot0010&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Boot0014&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Boot000C&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Boot000E&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Boot000F&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Boot0017&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Boot000D&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Boot0013&quot;</span>
    <span class="p">],</span>
    <span class="nt">&quot;BootSourceOverrideEnabled&quot;</span><span class="p">:</span> <span class="s2">&quot;Disabled&quot;</span><span class="p">,</span>
    <span class="nt">&quot;BootSourceOverrideMode&quot;</span><span class="p">:</span> <span class="s2">&quot;UEFI&quot;</span><span class="p">,</span>
    <span class="nt">&quot;BootSourceOverrideTarget&quot;</span><span class="p">:</span> <span class="s2">&quot;None&quot;</span><span class="p">,</span>
    <span class="nt">&quot;BootSourceOverrideTarget@Redfish.AllowableValues&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;None&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Cd&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Hdd&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Usb&quot;</span><span class="p">,</span>
        <span class="s2">&quot;SDCard&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Utilities&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Diags&quot;</span><span class="p">,</span>
        <span class="s2">&quot;BiosSetup&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Pxe&quot;</span><span class="p">,</span>
        <span class="s2">&quot;UefiShell&quot;</span><span class="p">,</span>
        <span class="s2">&quot;UefiHttp&quot;</span><span class="p">,</span>
        <span class="s2">&quot;UefiTarget&quot;</span>
    <span class="p">],</span>
    <span class="nt">&quot;UefiTargetBootSourceOverride&quot;</span><span class="p">:</span> <span class="s2">&quot;None&quot;</span><span class="p">,</span>
    <span class="nt">&quot;UefiTargetBootSourceOverride@Redfish.AllowableValues&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;HD(1,GPT,0940C33C-EAF1-43CD-8C8F-4426672227FE,0x800,0x4E000)/\\EFI\\sles\\shim.efi&quot;</span><span class="p">,</span>
        <span class="s2">&quot;HD(1,GPT,22F62F69-47E7-4334-BCE6-A0B321810BA1,0x800,0x64000)/\\EFI\\redhat\\shimx64.efi&quot;</span><span class="p">,</span>
        <span class="s2">&quot;PciRoot(0x0)/Pci(0x1C,0x0)/Pci(0x0,0x0)/MAC(98F2B32CB4A8,0x0)/IPv4(0.0.0.0)/Uri()&quot;</span><span class="p">,</span>
        <span class="s2">&quot;PciRoot(0x0)/Pci(0x1C,0x0)/Pci(0x0,0x0)/MAC(98F2B32CB4A8,0x0)/IPv4(0.0.0.0)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;PciRoot(0x0)/Pci(0x1C,0x0)/Pci(0x0,0x0)/MAC(98F2B32CB4A8,0x0)/IPv6(0000:0000:0000:0000:0000:0000:0000:0000)/Uri()&quot;</span><span class="p">,</span>
        <span class="s2">&quot;PciRoot(0x0)/Pci(0x1C,0x0)/Pci(0x0,0x0)/MAC(98F2B32CB4A8,0x0)/IPv6(0000:0000:0000:0000:0000:0000:0000:0000)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;PciRoot(0x3)/Pci(0x0,0x0)/Pci(0x0,0x0)/Scsi(0x0,0x0)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;PciRoot(0x3)/Pci(0x0,0x0)/Pci(0x0,0x0)/Scsi(0x0,0x1)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;PciRoot(0x3)/Pci(0x0,0x0)/Pci(0x0,0x0)/Scsi(0x0,0x2)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;PciRoot(0x3)/Pci(0x0,0x0)/Pci(0x0,0x0)/Scsi(0x0,0x3)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;PciRoot(0x0)/Pci(0x14,0x0)/USB(0xD,0x0)/USB(0x1,0x0)&quot;</span><span class="p">,</span>
        <span class="s2">&quot;PciRoot(0x0)/Pci(0x14,0x0)/USB(0xD,0x0)/USB(0x1,0x1)&quot;</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="change-boot-order">
<h2>Change Boot Order<a class="headerlink" href="#change-boot-order" title="Permalink to this headline">¶</a></h2>
<p>Alter the default boot order.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">change_boot_order</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">,</span> <span class="n">bios_password</span><span class="p">):</span>

    <span class="n">bios_boot_uri</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">bios_boot_response</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">resource_instances</span> <span class="o">=</span> <span class="n">get_resource_directory</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DISABLE_RESOURCE_DIR</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">resource_instances</span><span class="p">:</span>
        <span class="c1">#if we do not have a resource directory or want to force it&#39;s non use to find the</span>
        <span class="c1">#relevant URI</span>
        <span class="n">systems_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Systems&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">systems_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">systems_uri</span><span class="p">)</span>
        <span class="n">systems_members_uri</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">systems_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]))[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">systems_members_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">systems_members_uri</span><span class="p">)</span>
        <span class="n">bios_uri</span> <span class="o">=</span> <span class="n">systems_members_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Bios&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">bios_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">bios_uri</span><span class="p">)</span>
        <span class="n">bios_boot_uri</span> <span class="o">=</span> <span class="n">bios_response</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">Oem</span><span class="o">.</span><span class="n">Hpe</span><span class="o">.</span><span class="n">Links</span><span class="o">.</span><span class="n">Boot</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#Use Resource directory to find the relevant URI</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">resource_instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;#HpeServerBootSettings.&#39;</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.type&#39;</span><span class="p">]:</span>
                <span class="n">bios_boot_uri</span> <span class="o">=</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
                <span class="k">break</span>

    <span class="k">if</span> <span class="n">bios_boot_uri</span><span class="p">:</span>
        <span class="n">bios_boot_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">bios_boot_uri</span><span class="p">)</span>
        <span class="c1">#Bios boot settings URI is needed</span>
        <span class="n">bios_boot_settings_uri</span> <span class="o">=</span> <span class="n">bios_boot_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;@Redfish.Settings&#39;</span><span class="p">][</span><span class="s1">&#39;SettingsObject&#39;</span><span class="p">]</span>\
                                                                                    <span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="c1">#update bios password</span>
        <span class="k">if</span> <span class="n">bios_password</span><span class="p">:</span>
            <span class="n">_redfishobj</span><span class="o">.</span><span class="n">bios_password</span> <span class="o">=</span> <span class="n">bios_password</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Rotating the first boot device to the end of the boot order.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Current Order:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">boot_order</span> <span class="o">=</span> <span class="n">bios_boot_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;DefaultBootOrder&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">indx</span><span class="p">,</span> <span class="n">boot_device</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">boot_order</span><span class="p">):</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Pos &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">indx</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; : &#39;</span> <span class="o">+</span> <span class="n">boot_device</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">device</span> <span class="o">=</span> <span class="n">boot_order</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Rotating device: </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s2"> to the end of the boot order.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">device</span><span class="p">)</span>
        <span class="n">boot_order</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>

        <span class="n">body</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;DefaultBootOrder&#39;</span><span class="p">:</span> <span class="n">boot_order</span><span class="p">}</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">patch</span><span class="p">(</span><span class="n">bios_boot_settings_uri</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span>

        <span class="c1">#If iLO responds with soemthing outside of 200 or 201 then lets check the iLO extended info</span>
        <span class="c1">#error message to see what went wrong</span>
        <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">400</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="s1">&#39;@Message.ExtendedInfo&#39;</span><span class="p">],</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> \
                                                                                <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">excp</span><span class="p">:</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;A response error occurred, unable to access iLO Extended Message&quot;</span>\
                                 <span class="s2">&quot; Info...&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;An http response of </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s2"> was returned.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Success! Your system may need to be restarted.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">dict</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Unable to find Boot Order URI.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="clear-ahs-data">
<h2>Clear AHS Data<a class="headerlink" href="#clear-ahs-data" title="Permalink to this headline">¶</a></h2>
<p>Clear Active Health System log data.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">clear_ahs_data</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">):</span>

    <span class="n">active_health_system_clear_log_uri</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">resource_instances</span> <span class="o">=</span> <span class="n">get_resource_directory</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DISABLE_RESOURCE_DIR</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">resource_instances</span><span class="p">:</span>
        <span class="n">managers_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Managers&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">managers_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">managers_uri</span><span class="p">)</span>
        <span class="n">managers_members_uri</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">managers_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]))[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">managers_members_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">managers_members_uri</span><span class="p">)</span>
        <span class="n">active_health_system_uri</span> <span class="o">=</span> <span class="n">managers_members_response</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">Oem</span><span class="o">.</span><span class="n">Hpe</span><span class="o">.</span><span class="n">Links</span>\
                                    <span class="p">[</span><span class="s1">&#39;ActiveHealthSystem&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">active_health_system_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">active_health_system_uri</span><span class="p">)</span>
        <span class="n">active_health_system_clear_log_uri</span> <span class="o">=</span> <span class="n">active_health_system_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Actions&#39;</span><span class="p">]</span>\
                                            <span class="p">[</span><span class="s1">&#39;#HpeiLOActiveHealthSystem.ClearLog&#39;</span><span class="p">][</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">resource_instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;#HpeiLOActiveHealthSystem.&#39;</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.type&#39;</span><span class="p">]:</span>
                <span class="n">active_health_system_uri</span> <span class="o">=</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
                <span class="n">active_health_system_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">active_health_system_uri</span><span class="p">)</span>
                <span class="n">active_health_system_clear_log_uri</span> <span class="o">=</span> <span class="n">active_health_system_response</span><span class="p">[</span><span class="s1">&#39;Actions&#39;</span><span class="p">]</span>\
                                                    <span class="p">[</span><span class="s1">&#39;#HpeiLOActiveHealthSystem.ClearLog&#39;</span><span class="p">][</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
            <span class="k">break</span>

    <span class="k">if</span> <span class="n">active_health_system_clear_log_uri</span><span class="p">:</span>
        <span class="n">body</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Action&quot;</span><span class="p">:</span> <span class="s2">&quot;HpeiLOActiveHealthSystem.ClearLog&quot;</span><span class="p">}</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">redfish_client</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">active_health_system_clear_log_uri</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span>

        <span class="c1">#If iLO responds with soemthing outside of 200 or 201 then lets check the iLO extended info</span>
        <span class="c1">#error message to see what went wrong</span>
        <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">400</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="s1">&#39;@Message.ExtendedInfo&#39;</span><span class="p">],</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>\
                                                                                <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;A response error occurred, unable to access iLO Extended &quot;</span> \
                                 <span class="s2">&quot;Message Info...&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;An http response of </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s2"> was returned.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Success!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">dict</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="clear-iel-iml-data">
<h2>Clear IEL/IML Data<a class="headerlink" href="#clear-iel-iml-data" title="Permalink to this headline">¶</a></h2>
<p>Clear iLO event log and management log data.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">clear_ilo_event_log</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">,</span> <span class="n">clear_IML_IEL</span><span class="p">):</span>

<span class="n">clear_log_services_uri</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">resource_instances</span> <span class="o">=</span> <span class="n">get_resource_directory</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">)</span>
<span class="k">if</span> <span class="n">DISABLE_RESOURCE_DIR</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">resource_instances</span><span class="p">:</span>
    <span class="c1">#if we do not have a resource directory or want to force it&#39;s non use to find the</span>
    <span class="c1">#relevant URI</span>
    <span class="n">systems_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Systems&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
    <span class="n">systems_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">systems_uri</span><span class="p">)</span>
    <span class="n">systems_members_uri</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">systems_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]))[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
    <span class="n">systems_members_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">systems_members_uri</span><span class="p">)</span>
    <span class="n">log_services_uri</span> <span class="o">=</span> <span class="n">systems_members_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;LogServices&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
    <span class="n">log_services_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">log_services_uri</span><span class="p">)</span>
    <span class="n">log_services_uris</span> <span class="o">=</span> <span class="n">log_services_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">log_services_uri</span> <span class="ow">in</span> <span class="n">log_services_uris</span><span class="p">:</span>
        <span class="n">log_services_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">log_services_uri</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">])</span>
        <span class="n">clear_log_services_uri</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">log_services_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Actions&#39;</span><span class="p">]</span>\
                                                            <span class="p">[</span><span class="s1">&#39;#LogService.ClearLog&#39;</span><span class="p">][</span><span class="s1">&#39;target&#39;</span><span class="p">])</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">resource_instances</span><span class="p">:</span>
        <span class="c1">#Use Resource directory to find the relevant URI</span>
        <span class="k">if</span> <span class="s1">&#39;#LogService.&#39;</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.type&#39;</span><span class="p">]:</span>
            <span class="n">log_service_uri</span> <span class="o">=</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
            <span class="n">clear_log_services_uri</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">log_service_uri</span><span class="p">)</span><span class="o">.</span><span class="n">dict</span><span class="p">[</span><span class="s1">&#39;Actions&#39;</span><span class="p">]</span>\
                                                            <span class="p">[</span><span class="s1">&#39;#LogService.ClearLog&#39;</span><span class="p">][</span><span class="s1">&#39;target&#39;</span><span class="p">])</span>

<span class="k">if</span> <span class="n">clear_log_services_uri</span><span class="p">:</span>
    <span class="n">body</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Action&quot;</span><span class="p">:</span> <span class="s2">&quot;LogService.ClearLog&quot;</span><span class="p">}</span>
    <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">clear_log_services_uri</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;IEL&quot;</span> <span class="ow">in</span> <span class="n">clear_IML_IEL</span> <span class="ow">and</span> <span class="s2">&quot;IEL&quot;</span> <span class="ow">in</span> <span class="n">path</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s2">&quot;IML&quot;</span> <span class="ow">in</span> <span class="n">clear_IML_IEL</span> <span class="ow">and</span> \
                                                                                <span class="s2">&quot;IML&quot;</span> <span class="ow">in</span> <span class="n">path</span><span class="p">):</span>
            <span class="k">if</span> <span class="s2">&quot;IEL&quot;</span> <span class="ow">in</span> <span class="n">path</span><span class="p">:</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Clearing IEL log.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Clearing IML log.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">resp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1">#If iLO responds with soemthing outside of 200 or 201 then lets check the iLO extended</span>
        <span class="c1">#info error message to see what went wrong</span>
        <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">400</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="s1">&#39;@Message.ExtendedInfo&#39;</span><span class="p">],</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> \
                                                                                <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">excp</span><span class="p">:</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;A response error occurred, unable to access iLO &quot;</span>\
                                 <span class="s2">&quot;Extended Message Info...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;An http response of </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s2"> was returned.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Success!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">dict</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id1">
<h2>Clear IEL/IML Data<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>Print computer system JSON data.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">computer_details</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">):</span>
    <span class="n">systems_members_uri</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">systems_members_response</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">resource_instances</span> <span class="o">=</span> <span class="n">get_resource_directory</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DISABLE_RESOURCE_DIR</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">resource_instances</span><span class="p">:</span>
        <span class="c1">#if we do not have a resource directory or want to force it&#39;s non use to find the</span>
        <span class="c1">#relevant URI</span>
        <span class="n">systems_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Systems&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">systems_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">systems_uri</span><span class="p">)</span>
        <span class="n">systems_members_uri</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">systems_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]))[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">systems_members_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">systems_members_uri</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">resource_instances</span><span class="p">:</span>
            <span class="c1">#Use Resource directory to find the relevant URI</span>
            <span class="k">if</span> <span class="s1">&#39;#ComputerSystem.&#39;</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.type&#39;</span><span class="p">]:</span>
                <span class="n">systems_members_uri</span> <span class="o">=</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
                <span class="n">systems_members_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">systems_members_uri</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Printing computer system details:</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">systems_members_response</span><span class="o">.</span><span class="n">dict</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="computer-system-data">
<h3>Computer System Data<a class="headerlink" href="#computer-system-data" title="Permalink to this headline">¶</a></h3>
<p>The folowing JSON output is obtained when accessing type <em>ComputerSystem</em>. Values may vary
from system to system, and key entries may differ based on the schema version for #ComputerSystem.</p>
<p>The user can preview the data prior:</p>
<div class="highlight-JSON notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;@odata.context&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/$metadata#ComputerSystem.ComputerSystem&quot;</span><span class="p">,</span>
    <span class="nt">&quot;@odata.etag&quot;</span><span class="p">:</span> <span class="s2">&quot;W/\&quot;7010F715\&quot;&quot;</span><span class="p">,</span>
    <span class="nt">&quot;@odata.id&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/Systems/1/&quot;</span><span class="p">,</span>
    <span class="nt">&quot;@odata.type&quot;</span><span class="p">:</span> <span class="s2">&quot;#ComputerSystem.v1_10_0.ComputerSystem&quot;</span><span class="p">,</span>
    <span class="nt">&quot;Actions&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;#ComputerSystem.Reset&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;ResetType@Redfish.AllowableValues&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;On&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ForceOff&quot;</span><span class="p">,</span>
                <span class="s2">&quot;GracefulShutdown&quot;</span><span class="p">,</span>
                <span class="s2">&quot;ForceRestart&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Nmi&quot;</span><span class="p">,</span>
                <span class="s2">&quot;PushPowerButton&quot;</span>
            <span class="p">],</span>
            <span class="nt">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/Systems/1/Actions/ComputerSystem.Reset/&quot;</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="nt">&quot;AssetTag&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="nt">&quot;Bios&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;@odata.id&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/systems/1/bios/&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;BiosVersion&quot;</span><span class="p">:</span> <span class="s2">&quot;U32 v2.22 (11/13/2019)&quot;</span><span class="p">,</span>
    <span class="nt">&quot;Boot&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;BootOptions&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;@odata.id&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/Systems/1/BootOptions/&quot;</span>
        <span class="p">},</span>
        <span class="nt">&quot;BootOrder&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;Boot0011&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Boot0019&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Boot0009&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Boot0012&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Boot0010&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Boot0014&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Boot000C&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Boot000E&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Boot000F&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Boot0017&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Boot000D&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Boot0013&quot;</span>
        <span class="p">],</span>
        <span class="nt">&quot;BootSourceOverrideEnabled&quot;</span><span class="p">:</span> <span class="s2">&quot;Once&quot;</span><span class="p">,</span>
        <span class="nt">&quot;BootSourceOverrideMode&quot;</span><span class="p">:</span> <span class="s2">&quot;UEFI&quot;</span><span class="p">,</span>
        <span class="nt">&quot;BootSourceOverrideTarget&quot;</span><span class="p">:</span> <span class="s2">&quot;Hdd&quot;</span><span class="p">,</span>
        <span class="nt">&quot;BootSourceOverrideTarget@Redfish.AllowableValues&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;None&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Cd&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Hdd&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Usb&quot;</span><span class="p">,</span>
            <span class="s2">&quot;SDCard&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Utilities&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Diags&quot;</span><span class="p">,</span>
            <span class="s2">&quot;BiosSetup&quot;</span><span class="p">,</span>
            <span class="s2">&quot;Pxe&quot;</span><span class="p">,</span>
            <span class="s2">&quot;UefiShell&quot;</span><span class="p">,</span>
            <span class="s2">&quot;UefiHttp&quot;</span><span class="p">,</span>
            <span class="s2">&quot;UefiTarget&quot;</span>
        <span class="p">],</span>
        <span class="nt">&quot;UefiTargetBootSourceOverride&quot;</span><span class="p">:</span> <span class="s2">&quot;None&quot;</span><span class="p">,</span>
        <span class="nt">&quot;UefiTargetBootSourceOverride@Redfish.AllowableValues&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;HD(1,GPT,0940C33C-EAF1-43CD-8C8F-4426672227FE,0x800,0x4E000)/\\EFI\\sles\\shim.efi&quot;</span><span class="p">,</span>
            <span class="s2">&quot;HD(1,GPT,22F62F69-47E7-4334-BCE6-A0B321810BA1,0x800,0x64000)/\\EFI\\redhat\\shimx64.efi&quot;</span><span class="p">,</span>
            <span class="s2">&quot;PciRoot(0x0)/Pci(0x1C,0x0)/Pci(0x0,0x0)/MAC(98F2B32CB4A8,0x0)/IPv4(0.0.0.0)/Uri()&quot;</span><span class="p">,</span>
            <span class="s2">&quot;PciRoot(0x0)/Pci(0x1C,0x0)/Pci(0x0,0x0)/MAC(98F2B32CB4A8,0x0)/IPv4(0.0.0.0)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;PciRoot(0x0)/Pci(0x1C,0x0)/Pci(0x0,0x0)/MAC(98F2B32CB4A8,0x0)/IPv6(0000:0000:0000:0000:0000:0000:0000:0000)/Uri()&quot;</span><span class="p">,</span>
            <span class="s2">&quot;PciRoot(0x0)/Pci(0x1C,0x0)/Pci(0x0,0x0)/MAC(98F2B32CB4A8,0x0)/IPv6(0000:0000:0000:0000:0000:0000:0000:0000)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;PciRoot(0x3)/Pci(0x0,0x0)/Pci(0x0,0x0)/Scsi(0x0,0x0)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;PciRoot(0x3)/Pci(0x0,0x0)/Pci(0x0,0x0)/Scsi(0x0,0x1)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;PciRoot(0x3)/Pci(0x0,0x0)/Pci(0x0,0x0)/Scsi(0x0,0x2)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;PciRoot(0x3)/Pci(0x0,0x0)/Pci(0x0,0x0)/Scsi(0x0,0x3)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;PciRoot(0x0)/Pci(0x14,0x0)/USB(0xD,0x0)/USB(0x1,0x0)&quot;</span><span class="p">,</span>
            <span class="s2">&quot;PciRoot(0x0)/Pci(0x14,0x0)/USB(0xD,0x0)/USB(0x1,0x1)&quot;</span>
        <span class="p">]</span>
    <span class="p">},</span>
    <span class="nt">&quot;EthernetInterfaces&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;@odata.id&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/Systems/1/EthernetInterfaces/&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;HostName&quot;</span><span class="p">:</span> <span class="s2">&quot;localhost.americas.hpqcorp.net&quot;</span><span class="p">,</span>
    <span class="nt">&quot;Id&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
    <span class="nt">&quot;IndicatorLED&quot;</span><span class="p">:</span> <span class="s2">&quot;Off&quot;</span><span class="p">,</span>
    <span class="nt">&quot;Links&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;Chassis&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nt">&quot;@odata.id&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/Chassis/1/&quot;</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="nt">&quot;ManagedBy&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nt">&quot;@odata.id&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/Managers/1/&quot;</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">},</span>
    <span class="nt">&quot;LogServices&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;@odata.id&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/Systems/1/LogServices/&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;Manufacturer&quot;</span><span class="p">:</span> <span class="s2">&quot;HPE&quot;</span><span class="p">,</span>
    <span class="nt">&quot;Memory&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;@odata.id&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/Systems/1/Memory/&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;MemoryDomains&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;@odata.id&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/Systems/1/MemoryDomains/&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;MemorySummary&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;Status&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;HealthRollup&quot;</span><span class="p">:</span> <span class="s2">&quot;OK&quot;</span>
        <span class="p">},</span>
        <span class="nt">&quot;TotalSystemMemoryGiB&quot;</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span>
        <span class="nt">&quot;TotalSystemPersistentMemoryGiB&quot;</span><span class="p">:</span> <span class="mi">0</span>
    <span class="p">},</span>
    <span class="nt">&quot;Model&quot;</span><span class="p">:</span> <span class="s2">&quot;ProLiant DL360 Gen10&quot;</span><span class="p">,</span>
    <span class="nt">&quot;Name&quot;</span><span class="p">:</span> <span class="s2">&quot;Computer System&quot;</span><span class="p">,</span>
    <span class="nt">&quot;NetworkInterfaces&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;@odata.id&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/Systems/1/NetworkInterfaces/&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;Oem&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;Hpe&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;@odata.context&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/$metadata#HpeComputerSystemExt.HpeComputerSystemExt&quot;</span><span class="p">,</span>
            <span class="nt">&quot;@odata.type&quot;</span><span class="p">:</span> <span class="s2">&quot;#HpeComputerSystemExt.v2_9_0.HpeComputerSystemExt&quot;</span><span class="p">,</span>
            <span class="nt">&quot;Actions&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;#HpeComputerSystemExt.PowerButton&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;PushType@Redfish.AllowableValues&quot;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="s2">&quot;Press&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;PressAndHold&quot;</span>
                    <span class="p">],</span>
                    <span class="nt">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/Systems/1/Actions/Oem/Hpe/HpeComputerSystemExt.PowerButton/&quot;</span>
                <span class="p">},</span>
                <span class="nt">&quot;#HpeComputerSystemExt.SecureSystemErase&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/Systems/1/Actions/Oem/Hpe/HpeComputerSystemExt.SecureSystemErase/&quot;</span>
                <span class="p">},</span>
                <span class="nt">&quot;#HpeComputerSystemExt.SystemReset&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;ResetType@Redfish.AllowableValues&quot;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="s2">&quot;ColdBoot&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;AuxCycle&quot;</span>
                    <span class="p">],</span>
                    <span class="nt">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/Systems/1/Actions/Oem/Hpe/HpeComputerSystemExt.SystemReset/&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="nt">&quot;AggregateHealthStatus&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;AgentlessManagementService&quot;</span><span class="p">:</span> <span class="s2">&quot;Unavailable&quot;</span><span class="p">,</span>
                <span class="nt">&quot;BiosOrHardwareHealth&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;Status&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="nt">&quot;Health&quot;</span><span class="p">:</span> <span class="s2">&quot;OK&quot;</span>
                    <span class="p">}</span>
                <span class="p">},</span>
                <span class="nt">&quot;FanRedundancy&quot;</span><span class="p">:</span> <span class="s2">&quot;Redundant&quot;</span><span class="p">,</span>
                <span class="nt">&quot;Fans&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;Status&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="nt">&quot;Health&quot;</span><span class="p">:</span> <span class="s2">&quot;OK&quot;</span>
                    <span class="p">}</span>
                <span class="p">},</span>
                <span class="nt">&quot;Memory&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;Status&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="nt">&quot;Health&quot;</span><span class="p">:</span> <span class="s2">&quot;OK&quot;</span>
                    <span class="p">}</span>
                <span class="p">},</span>
                <span class="nt">&quot;Network&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;Status&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="nt">&quot;Health&quot;</span><span class="p">:</span> <span class="s2">&quot;OK&quot;</span>
                    <span class="p">}</span>
                <span class="p">},</span>
                <span class="nt">&quot;PowerSupplies&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;PowerSuppliesMismatch&quot;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
                    <span class="nt">&quot;Status&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="nt">&quot;Health&quot;</span><span class="p">:</span> <span class="s2">&quot;OK&quot;</span>
                    <span class="p">}</span>
                <span class="p">},</span>
                <span class="nt">&quot;Processors&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;Status&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="nt">&quot;Health&quot;</span><span class="p">:</span> <span class="s2">&quot;OK&quot;</span>
                    <span class="p">}</span>
                <span class="p">},</span>
                <span class="nt">&quot;Storage&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;Status&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="nt">&quot;Health&quot;</span><span class="p">:</span> <span class="s2">&quot;Warning&quot;</span>
                    <span class="p">}</span>
                <span class="p">},</span>
                <span class="nt">&quot;Temperatures&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;Status&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="nt">&quot;Health&quot;</span><span class="p">:</span> <span class="s2">&quot;OK&quot;</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="nt">&quot;Bios&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;Backup&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;Date&quot;</span><span class="p">:</span> <span class="s2">&quot;11/13/2019&quot;</span><span class="p">,</span>
                    <span class="nt">&quot;Family&quot;</span><span class="p">:</span> <span class="s2">&quot;U32&quot;</span><span class="p">,</span>
                    <span class="nt">&quot;VersionString&quot;</span><span class="p">:</span> <span class="s2">&quot;U32 v2.22 (11/13/2019)&quot;</span>
                <span class="p">},</span>
                <span class="nt">&quot;Current&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;Date&quot;</span><span class="p">:</span> <span class="s2">&quot;11/13/2019&quot;</span><span class="p">,</span>
                    <span class="nt">&quot;Family&quot;</span><span class="p">:</span> <span class="s2">&quot;U32&quot;</span><span class="p">,</span>
                    <span class="nt">&quot;VersionString&quot;</span><span class="p">:</span> <span class="s2">&quot;U32 v2.22 (11/13/2019)&quot;</span>
                <span class="p">},</span>
                <span class="nt">&quot;UefiClass&quot;</span><span class="p">:</span> <span class="mi">2</span>
            <span class="p">},</span>
            <span class="nt">&quot;CriticalTempRemainOff&quot;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
            <span class="nt">&quot;CurrentPowerOnTimeSeconds&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
            <span class="nt">&quot;DeviceDiscoveryComplete&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;AMSDeviceDiscovery&quot;</span><span class="p">:</span> <span class="s2">&quot;NoAMS&quot;</span><span class="p">,</span>
                <span class="nt">&quot;DeviceDiscovery&quot;</span><span class="p">:</span> <span class="s2">&quot;vMainDeviceDiscoveryComplete&quot;</span><span class="p">,</span>
                <span class="nt">&quot;SmartArrayDiscovery&quot;</span><span class="p">:</span> <span class="s2">&quot;Complete&quot;</span>
            <span class="p">},</span>
            <span class="nt">&quot;ElapsedEraseTimeInMinutes&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="nt">&quot;EndOfPostDelaySeconds&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
            <span class="nt">&quot;EstimatedEraseTimeInMinutes&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="nt">&quot;IntelligentProvisioningAlwaysOn&quot;</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="nt">&quot;IntelligentProvisioningIndex&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
            <span class="nt">&quot;IntelligentProvisioningLocation&quot;</span><span class="p">:</span> <span class="s2">&quot;System Board&quot;</span><span class="p">,</span>
            <span class="nt">&quot;IntelligentProvisioningVersion&quot;</span><span class="p">:</span> <span class="s2">&quot;3.60.12&quot;</span><span class="p">,</span>
            <span class="nt">&quot;IsColdBooting&quot;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
            <span class="nt">&quot;Links&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;EthernetInterfaces&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;@odata.id&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/Systems/1/EthernetInterfaces/&quot;</span>
                <span class="p">},</span>
                <span class="nt">&quot;HpeIpProvider&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;@odata.id&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/systems/1/hpeip/&quot;</span>
                <span class="p">},</span>
                <span class="nt">&quot;NetworkAdapters&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;@odata.id&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/Systems/1/BaseNetworkAdapters/&quot;</span>
                <span class="p">},</span>
                <span class="nt">&quot;PCIDevices&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;@odata.id&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/Systems/1/PCIDevices/&quot;</span>
                <span class="p">},</span>
                <span class="nt">&quot;PCISlots&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;@odata.id&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/Systems/1/PCISlots/&quot;</span>
                <span class="p">},</span>
                <span class="nt">&quot;SUT&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;@odata.id&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/systems/1/hpsut/&quot;</span>
                <span class="p">},</span>
                <span class="nt">&quot;SecureEraseReportService&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;@odata.id&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/Systems/1/SecureEraseReportService/&quot;</span>
                <span class="p">},</span>
                <span class="nt">&quot;SmartStorage&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;@odata.id&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/Systems/1/SmartStorage/&quot;</span>
                <span class="p">},</span>
                <span class="nt">&quot;USBDevices&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;@odata.id&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/Systems/1/USBDevices/&quot;</span>
                <span class="p">},</span>
                <span class="nt">&quot;USBPorts&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;@odata.id&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/Systems/1/USBPorts/&quot;</span>
                <span class="p">},</span>
                <span class="nt">&quot;WorkloadPerformanceAdvisor&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;@odata.id&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/Systems/1/WorkloadPerformanceAdvisor/&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="nt">&quot;PCAPartNumber&quot;</span><span class="p">:</span> <span class="s2">&quot;847479-001&quot;</span><span class="p">,</span>
            <span class="nt">&quot;PCASerialNumber&quot;</span><span class="p">:</span> <span class="s2">&quot;PVZEK0ARHA014I&quot;</span><span class="p">,</span>
            <span class="nt">&quot;PostDiscoveryCompleteTimeStamp&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
            <span class="nt">&quot;PostDiscoveryMode&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
            <span class="nt">&quot;PostMode&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
            <span class="nt">&quot;PostState&quot;</span><span class="p">:</span> <span class="s2">&quot;FinishedPost&quot;</span><span class="p">,</span>
            <span class="nt">&quot;PowerAllocationLimit&quot;</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span>
            <span class="nt">&quot;PowerAutoOn&quot;</span><span class="p">:</span> <span class="s2">&quot;Restore&quot;</span><span class="p">,</span>
            <span class="nt">&quot;PowerOnDelay&quot;</span><span class="p">:</span> <span class="s2">&quot;Minimum&quot;</span><span class="p">,</span>
            <span class="nt">&quot;PowerOnMinutes&quot;</span><span class="p">:</span> <span class="mi">80051</span><span class="p">,</span>
            <span class="nt">&quot;PowerRegulatorMode&quot;</span><span class="p">:</span> <span class="s2">&quot;OSControl&quot;</span><span class="p">,</span>
            <span class="nt">&quot;PowerRegulatorModesSupported&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;OSControl&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Dynamic&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Max&quot;</span><span class="p">,</span>
                <span class="s2">&quot;Min&quot;</span>
            <span class="p">],</span>
            <span class="nt">&quot;ProcessorJitterControl&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;ConfiguredFrequencyLimitMHz&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                <span class="nt">&quot;Mode&quot;</span><span class="p">:</span> <span class="s2">&quot;Disabled&quot;</span>
            <span class="p">},</span>
            <span class="nt">&quot;SMBIOS&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;extref&quot;</span><span class="p">:</span> <span class="s2">&quot;/smbios&quot;</span>
            <span class="p">},</span>
            <span class="nt">&quot;ServerFQDN&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="nt">&quot;SmartStorageConfig&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="nt">&quot;@odata.id&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/systems/1/smartstorageconfig/&quot;</span>
                <span class="p">}</span>
            <span class="p">],</span>
            <span class="nt">&quot;SystemROMAndiLOEraseComponentStatus&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;BIOSSettingsEraseStatus&quot;</span><span class="p">:</span> <span class="s2">&quot;Idle&quot;</span><span class="p">,</span>
                <span class="nt">&quot;iLOSettingsEraseStatus&quot;</span><span class="p">:</span> <span class="s2">&quot;Idle&quot;</span>
            <span class="p">},</span>
            <span class="nt">&quot;SystemROMAndiLOEraseStatus&quot;</span><span class="p">:</span> <span class="s2">&quot;Idle&quot;</span><span class="p">,</span>
            <span class="nt">&quot;UserDataEraseComponentStatus&quot;</span><span class="p">:</span> <span class="p">{},</span>
            <span class="nt">&quot;UserDataEraseStatus&quot;</span><span class="p">:</span> <span class="s2">&quot;Idle&quot;</span><span class="p">,</span>
            <span class="nt">&quot;VirtualProfile&quot;</span><span class="p">:</span> <span class="s2">&quot;Inactive&quot;</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="nt">&quot;PowerState&quot;</span><span class="p">:</span> <span class="s2">&quot;On&quot;</span><span class="p">,</span>
    <span class="nt">&quot;ProcessorSummary&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;Count&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="nt">&quot;Model&quot;</span><span class="p">:</span> <span class="s2">&quot;Intel(R) Xeon(R) Bronze 3106 CPU @ 1.70GHz&quot;</span><span class="p">,</span>
        <span class="nt">&quot;Status&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;HealthRollup&quot;</span><span class="p">:</span> <span class="s2">&quot;OK&quot;</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="nt">&quot;Processors&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;@odata.id&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/Systems/1/Processors/&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;SKU&quot;</span><span class="p">:</span> <span class="s2">&quot;DL3000GEN10&quot;</span><span class="p">,</span>
    <span class="nt">&quot;SecureBoot&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;@odata.id&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/Systems/1/SecureBoot/&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;SerialNumber&quot;</span><span class="p">:</span> <span class="s2">&quot;TX86NP0121&quot;</span><span class="p">,</span>
    <span class="nt">&quot;Status&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;Health&quot;</span><span class="p">:</span> <span class="s2">&quot;Warning&quot;</span><span class="p">,</span>
        <span class="nt">&quot;HealthRollup&quot;</span><span class="p">:</span> <span class="s2">&quot;Warning&quot;</span><span class="p">,</span>
        <span class="nt">&quot;State&quot;</span><span class="p">:</span> <span class="s2">&quot;Enabled&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;Storage&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;@odata.id&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/Systems/1/Storage/&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;SystemType&quot;</span><span class="p">:</span> <span class="s2">&quot;Physical&quot;</span><span class="p">,</span>
    <span class="nt">&quot;TrustedModules&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="nt">&quot;Oem&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;Hpe&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;@odata.context&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/$metadata#HpeTrustedModuleExt.HpeTrustedModuleExt&quot;</span><span class="p">,</span>
                    <span class="nt">&quot;@odata.type&quot;</span><span class="p">:</span> <span class="s2">&quot;#HpeTrustedModuleExt.v2_0_0.HpeTrustedModuleExt&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="nt">&quot;Status&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;State&quot;</span><span class="p">:</span> <span class="s2">&quot;Absent&quot;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="nt">&quot;UUID&quot;</span><span class="p">:</span> <span class="s2">&quot;30334C44-3030-5854-3836-4E5030313231&quot;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="configure-snmp">
<h2>Configure SNMP<a class="headerlink" href="#configure-snmp" title="Permalink to this headline">¶</a></h2>
<p>Configure iLO Simple Network Management Protocol.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">configure_snmp</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">,</span> <span class="n">read_communities</span><span class="p">,</span> <span class="n">snmp_alerts</span><span class="p">):</span>

    <span class="n">snmp_service_uri</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">resource_instances</span> <span class="o">=</span> <span class="n">get_resource_directory</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DISABLE_RESOURCE_DIR</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">resource_instances</span><span class="p">:</span>
        <span class="c1">#if we do not have a resource directory or want to force it&#39;s non use to find the</span>
        <span class="c1">#relevant URI</span>
        <span class="n">managers_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Managers&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">managers_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">managers_uri</span><span class="p">)</span>
        <span class="n">managers_members_uri</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">managers_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]))[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">managers_members_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">managers_members_uri</span><span class="p">)</span>
        <span class="n">snmp_service_uri</span> <span class="o">=</span> <span class="n">managers_members_response</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">Oem</span><span class="o">.</span><span class="n">Hpe</span><span class="o">.</span><span class="n">Links</span><span class="p">[</span><span class="s1">&#39;Snmp&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">resource_instances</span><span class="p">:</span>
            <span class="c1">#Use Resource directory to find the relevant URI</span>
            <span class="k">if</span> <span class="s1">&#39;#HpeiLOSnmpService.&#39;</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.type&#39;</span><span class="p">]:</span>
                <span class="n">snmp_service_uri</span> <span class="o">=</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">snmp_service_uri</span><span class="p">:</span>
        <span class="n">body</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;AlertsEnabled&quot;</span><span class="p">:</span> <span class="n">snmp_alerts</span><span class="p">,</span> <span class="s2">&quot;ReadCommunities&quot;</span><span class="p">:</span> <span class="n">read_communities</span><span class="p">}</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">patch</span><span class="p">(</span><span class="n">snmp_service_uri</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span>

        <span class="c1">#If iLO responds with soemthing outside of 200 or 201 then lets check the iLO extended info</span>
        <span class="c1">#error message to see what went wrong</span>
        <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">400</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="s1">&#39;@Message.ExtendedInfo&#39;</span><span class="p">],</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> \
                                                                                <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">excp</span><span class="p">:</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;A response error occurred, unable to access iLO Extended &quot;</span>\
                                 <span class="s2">&quot;Message Info...&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;An http response of </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s2"> was returned.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Success!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">dict</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="enable-ntp">
<h2>Enable NTP<a class="headerlink" href="#enable-ntp" title="Permalink to this headline">¶</a></h2>
<p>In order to configure iLO Network Time Protocol, certain settings must be in-place on the iLO Management
NIC(s) including settings the value of the OEM/HPE object key-value pair <em>UseNTPServers</em> to <em>True</em>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>An iLO Reset will be required in order for the change to be applied.</p>
</div>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">enable_ntp</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">,</span> <span class="n">ntp_servers</span><span class="p">):</span>

    <span class="n">ethernet_data</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">resource_instances</span> <span class="o">=</span> <span class="n">get_resource_directory</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DISABLE_RESOURCE_DIR</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">resource_instances</span><span class="p">:</span>
        <span class="c1">#if we do not have a resource directory or want to force it&#39;s non use to find the</span>
        <span class="c1">#relevant URI</span>
        <span class="n">managers_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Managers&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">managers_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">managers_uri</span><span class="p">)</span>
        <span class="n">managers_members_uri</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">managers_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]))[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">managers_members_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">managers_members_uri</span><span class="p">)</span>
        <span class="n">manager_ethernet_interfaces</span> <span class="o">=</span> <span class="n">managers_members_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;EthernetInterfaces&#39;</span><span class="p">]</span>\
                                                                                    <span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">manager_ethernet_interfaces_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">manager_ethernet_interfaces</span><span class="p">)</span>
        <span class="n">manager_ethernet_interfaces_members</span> <span class="o">=</span> <span class="n">manager_ethernet_interfaces_response</span><span class="o">.</span>\
                                                            <span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">_member</span> <span class="ow">in</span> <span class="n">manager_ethernet_interfaces_members</span><span class="p">:</span>
            <span class="n">_tmp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">_member</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">obj</span>
            <span class="n">ethernet_data</span><span class="p">[</span><span class="n">_member</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">_tmp</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#Use Resource directory to find the relevant URI</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">resource_instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;#EthernetInterfaceCollection.&#39;</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.type&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="s1">&#39;Managers&#39;</span> <span class="ow">in</span> \
                                                                        <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]:</span>
                <span class="n">ethernet_uri</span> <span class="o">=</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
                <span class="n">ethernet_interfaces</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ethernet_uri</span><span class="p">)</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">_ethernet_interface</span> <span class="ow">in</span> <span class="n">ethernet_interfaces</span><span class="p">:</span>
                    <span class="n">ethernet_data</span><span class="p">[</span><span class="n">_ethernet_interface</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span>\
                                                        <span class="n">get</span><span class="p">(</span><span class="n">_ethernet_interface</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">dict</span>
                <span class="k">break</span>

    <span class="k">if</span> <span class="n">ethernet_data</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Showing all available ethernet management interfaces before changes:</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">ethernet_data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

    <span class="n">body</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Oem&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;Hpe&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;DHCPv4&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;UseNTPServers&quot;</span><span class="p">:</span> <span class="n">ntp_servers</span><span class="p">},</span> \
                            <span class="s2">&quot;DHCPv6&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;UseNTPServers&quot;</span><span class="p">:</span> <span class="n">ntp_servers</span><span class="p">}}}}</span>
    <span class="k">for</span> <span class="n">ethernet</span> <span class="ow">in</span> <span class="n">ethernet_data</span><span class="p">:</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">patch</span><span class="p">(</span><span class="n">ethernet</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">400</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="s1">&#39;@Message.ExtendedInfo&#39;</span><span class="p">],</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> \
                                                                                <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">excp</span><span class="p">:</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;A response error occurred, unable to access iLO Extended &quot;</span>\
                                 <span class="s2">&quot;Message Info...&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;An http response of </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s2"> was returned.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Success!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">dict</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            <span class="n">_data</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ethernet</span><span class="p">)</span><span class="o">.</span><span class="n">dict</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Showing </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s2"> interface after changes:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ethernet</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">_data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="enable-secure-boot">
<h2>Enable Secure Boot<a class="headerlink" href="#enable-secure-boot" title="Permalink to this headline">¶</a></h2>
<p>Enable/Disable Secure Boot.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">enable_secure_boot</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">,</span> <span class="n">secure_boot_enable</span><span class="p">):</span>

    <span class="n">secure_boot_uri</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">secure_boot_data</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">resource_instances</span> <span class="o">=</span> <span class="n">get_resource_directory</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DISABLE_RESOURCE_DIR</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">resource_instances</span><span class="p">:</span>
        <span class="c1">#if we do not have a resource directory or want to force it&#39;s non use to find the</span>
        <span class="c1">#relevant URI</span>
        <span class="n">systems_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Systems&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">systems_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">systems_uri</span><span class="p">)</span>
        <span class="n">systems_members_uri</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">systems_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]))[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">systems_members_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">systems_members_uri</span><span class="p">)</span>
        <span class="n">secure_boot_uri</span> <span class="o">=</span> <span class="n">systems_members_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;SecureBoot&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">secure_boot_data</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">secure_boot_uri</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#Use Resource directory to find the relevant URI</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">resource_instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;#SecureBoot.&#39;</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.type&#39;</span><span class="p">]:</span>
                <span class="n">secure_boot_uri</span> <span class="o">=</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
                <span class="n">secure_boot_data</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">secure_boot_uri</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">secure_boot_data</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Showing Secure Boot properties before changes:</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">secure_boot_data</span><span class="o">.</span><span class="n">dict</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">secure_boot_uri</span><span class="p">:</span>
        <span class="n">body</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;SecureBootEnable&#39;</span><span class="p">:</span> <span class="n">secure_boot_enable</span><span class="p">}</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">patch</span><span class="p">(</span><span class="n">secure_boot_uri</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span>
        <span class="c1">#If iLO responds with soemthing outside of 200 or 201 then lets check the iLO extended info</span>
        <span class="c1">#error message to see what went wrong</span>
        <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">400</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="s1">&#39;@Message.ExtendedInfo&#39;</span><span class="p">],</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> \
                                                                                <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;A response error occurred, unable to access iLO Extended &quot;</span> \
                                 <span class="s2">&quot;Message Info...&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;An http response of </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s2"> was returned.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Success!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">dict</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Showing Secure Boot properties after changes:</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">secure_boot_data</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">secure_boot_uri</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">secure_boot_data</span><span class="o">.</span><span class="n">dict</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="expand-data">
<h2>Expand Data<a class="headerlink" href="#expand-data" title="Permalink to this headline">¶</a></h2>
<p>JSON data is typically provided in a collapsed/compactted state. Use <em>$expand</em> as a query string on the
desired URI.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">expand_data</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">,</span> <span class="n">expand_url</span><span class="o">=</span><span class="s2">&quot;/redfish/v1/&quot;</span><span class="p">):</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">expand_url</span><span class="p">)</span>
    <span class="n">exp_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">expand_url</span><span class="o">+</span><span class="s1">&#39;?$expand=.&#39;</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Standard response:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">dict</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Expanded response:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">exp_response</span><span class="o">.</span><span class="n">dict</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="response-example">
<h3>Response Example<a class="headerlink" href="#response-example" title="Permalink to this headline">¶</a></h3>
<p>Standard response:</p>
<div class="highlight-TEXT notranslate"><div class="highlight"><pre><span></span>{&#39;@odata.context&#39;: &#39;/redfish/v1/$metadata#ComputerSystemCollection.ComputerSystemCollection&#39;, &#39;@odata.etag&#39;: &#39;W/&quot;AA6D42B0&quot;&#39;, &#39;@odata.id&#39;: &#39;/redfish/v1/Systems/&#39;, &#39;@odata.type&#39;: &#39;#ComputerSystemCollection.ComputerSystemCollection&#39;, &#39;Description&#39;: &#39;Computer Systems view&#39;, &#39;Name&#39;: &#39;Computer Systems&#39;, &#39;Members&#39;: [{&#39;@odata.id&#39;: &#39;/redfish/v1/Systems/1/&#39;}], &#39;Members@odata.count&#39;: 1}
</pre></div>
</div>
<p>Expanded response:</p>
<div class="highlight-TEXT notranslate"><div class="highlight"><pre><span></span>{&#39;@odata.context&#39;: &#39;/redfish/v1/$metadata#ComputerSystemCollection.ComputerSystemCollection&#39;, &#39;@odata.etag&#39;: &#39;W/&quot;5737F79D&quot;&#39;, &#39;@odata.id&#39;: &#39;/redfish/v1/Systems/&#39;, &#39;@odata.type&#39;: &#39;#ComputerSystemCollection.ComputerSystemCollection&#39;, &#39;Description&#39;: &#39;Computer Systems view&#39;, &#39;Name&#39;: &#39;Computer Systems&#39;, &#39;Members&#39;: [{&#39;@odata.context&#39;: &#39;/redfish/v1/$metadata#ComputerSystem.ComputerSystem&#39;, &#39;@odata.id&#39;: &#39;/redfish/v1/Systems/1/&#39;, &#39;@odata.type&#39;: &#39;#ComputerSystem.v1_10_0.ComputerSystem&#39;, &#39;Id&#39;: &#39;1&#39;, &#39;Actions&#39;: {&#39;#ComputerSystem.Reset&#39;: {&#39;ResetType@Redfish.AllowableValues&#39;: [&#39;On&#39;, &#39;ForceOff&#39;, &#39;GracefulShutdown&#39;, &#39;ForceRestart&#39;, &#39;Nmi&#39;, &#39;PushPowerButton&#39;], &#39;target&#39;: &#39;/redfish/v1/Systems/1/Actions/ComputerSystem.Reset/&#39;}}, &#39;AssetTag&#39;: &#39;&#39;, &#39;Bios&#39;: {&#39;@odata.id&#39;: &#39;/redfish/v1/systems/1/bios/&#39;}, &#39;BiosVersion&#39;: &#39;U32 v2.22 (11/13/2019)&#39;, &#39;Boot&#39;: {&#39;BootOptions&#39;: {&#39;@odata.id&#39;: &#39;/redfish/v1/Systems/1/BootOptions/&#39;}, &#39;BootOrder&#39;: [&#39;Boot0011&#39;, &#39;Boot0019&#39;, &#39;Boot0009&#39;, &#39;Boot0012&#39;, &#39;Boot0010&#39;, &#39;Boot0014&#39;, &#39;Boot000C&#39;, &#39;Boot000E&#39;, &#39;Boot000F&#39;, &#39;Boot0017&#39;, &#39;Boot000D&#39;, &#39;Boot0013&#39;], &#39;BootSourceOverrideEnabled&#39;: &#39;Once&#39;, &#39;BootSourceOverrideMode&#39;: &#39;UEFI&#39;, &#39;BootSourceOverrideTarget&#39;: &#39;Hdd&#39;, &#39;BootSourceOverrideTarget@Redfish.AllowableValues&#39;: [&#39;None&#39;, &#39;Cd&#39;, &#39;Hdd&#39;, &#39;Usb&#39;, &#39;SDCard&#39;, &#39;Utilities&#39;, &#39;Diags&#39;, &#39;BiosSetup&#39;, &#39;Pxe&#39;, &#39;UefiShell&#39;, &#39;UefiHttp&#39;, &#39;UefiTarget&#39;], &#39;UefiTargetBootSourceOverride&#39;: &#39;None&#39;, &#39;UefiTargetBootSourceOverride@Redfish.AllowableValues&#39;: [&#39;HD(1,GPT,0940C33C-EAF1-43CD-8C8F-4426672227FE,0x800,0x4E000)/\\EFI\\sles\\shim.efi&#39;, &#39;HD(1,GPT,22F62F69-47E7-4334-BCE6-A0B321810BA1,0x800,0x64000)/\\EFI\\redhat\\shimx64.efi&#39;, &#39;PciRoot(0x0)/Pci(0x1C,0x0)/Pci(0x0,0x0)/MAC(98F2B32CB4A8,0x0)/IPv4(0.0.0.0)/Uri()&#39;, &#39;PciRoot(0x0)/Pci(0x1C,0x0)/Pci(0x0,0x0)/MAC(98F2B32CB4A8,0x0)/IPv4(0.0.0.0)&#39;, &#39;PciRoot(0x0)/Pci(0x1C,0x0)/Pci(0x0,0x0)/MAC(98F2B32CB4A8,0x0)/IPv6(0000:0000:0000:0000:0000:0000:0000:0000)/Uri()&#39;, &#39;PciRoot(0x0)/Pci(0x1C,0x0)/Pci(0x0,0x0)/MAC(98F2B32CB4A8,0x0)/IPv6(0000:0000:0000:0000:0000:0000:0000:0000)&#39;, &#39;PciRoot(0x3)/Pci(0x0,0x0)/Pci(0x0,0x0)/Scsi(0x0,0x0)&#39;, &#39;PciRoot(0x3)/Pci(0x0,0x0)/Pci(0x0,0x0)/Scsi(0x0,0x1)&#39;, &#39;PciRoot(0x3)/Pci(0x0,0x0)/Pci(0x0,0x0)/Scsi(0x0,0x2)&#39;, &#39;PciRoot(0x3)/Pci(0x0,0x0)/Pci(0x0,0x0)/Scsi(0x0,0x3)&#39;, &#39;PciRoot(0x0)/Pci(0x14,0x0)/USB(0xD,0x0)/USB(0x1,0x0)&#39;, &#39;PciRoot(0x0)/Pci(0x14,0x0)/USB(0xD,0x0)/USB(0x1,0x1)&#39;]}, &#39;EthernetInterfaces&#39;: {&#39;@odata.id&#39;: &#39;/redfish/v1/Systems/1/EthernetInterfaces/&#39;}, &#39;HostName&#39;: &#39;localhost.americas.hpqcorp.net&#39;, &#39;IndicatorLED&#39;: &#39;Off&#39;, &#39;Links&#39;: {&#39;ManagedBy&#39;: [{&#39;@odata.id&#39;: &#39;/redfish/v1/Managers/1/&#39;}], &#39;Chassis&#39;: [{&#39;@odata.id&#39;: &#39;/redfish/v1/Chassis/1/&#39;}]}, &#39;LogServices&#39;: {&#39;@odata.id&#39;: &#39;/redfish/v1/Systems/1/LogServices/&#39;}, &#39;Manufacturer&#39;: &#39;HPE&#39;, &#39;Memory&#39;: {&#39;@odata.id&#39;: &#39;/redfish/v1/Systems/1/Memory/&#39;}, &#39;MemoryDomains&#39;: {&#39;@odata.id&#39;: &#39;/redfish/v1/Systems/1/MemoryDomains/&#39;}, &#39;MemorySummary&#39;: {&#39;Status&#39;: {&#39;HealthRollup&#39;: &#39;OK&#39;}, &#39;TotalSystemMemoryGiB&#39;: 32, &#39;TotalSystemPersistentMemoryGiB&#39;: 0}, &#39;Model&#39;: &#39;ProLiant DL360 Gen10&#39;, &#39;Name&#39;: &#39;Computer System&#39;, &#39;NetworkInterfaces&#39;: {&#39;@odata.id&#39;: &#39;/redfish/v1/Systems/1/NetworkInterfaces/&#39;}, &#39;Oem&#39;: {&#39;Hpe&#39;: {&#39;@odata.context&#39;: &#39;/redfish/v1/$metadata#HpeComputerSystemExt.HpeComputerSystemExt&#39;, &#39;@odata.type&#39;: &#39;#HpeComputerSystemExt.v2_9_0.HpeComputerSystemExt&#39;, &#39;Actions&#39;: {&#39;#HpeComputerSystemExt.PowerButton&#39;: {&#39;PushType@Redfish.AllowableValues&#39;: [&#39;Press&#39;, &#39;PressAndHold&#39;], &#39;target&#39;: &#39;/redfish/v1/Systems/1/Actions/Oem/Hpe/HpeComputerSystemExt.PowerButton/&#39;}, &#39;#HpeComputerSystemExt.SecureSystemErase&#39;: {&#39;target&#39;: &#39;/redfish/v1/Systems/1/Actions/Oem/Hpe/HpeComputerSystemExt.SecureSystemErase/&#39;}, &#39;#HpeComputerSystemExt.SystemReset&#39;: {&#39;ResetType@Redfish.AllowableValues&#39;: [&#39;ColdBoot&#39;, &#39;AuxCycle&#39;], &#39;target&#39;: &#39;/redfish/v1/Systems/1/Actions/Oem/Hpe/HpeComputerSystemExt.SystemReset/&#39;}}, &#39;AggregateHealthStatus&#39;: {&#39;AgentlessManagementService&#39;: &#39;Unavailable&#39;, &#39;BiosOrHardwareHealth&#39;: {&#39;Status&#39;: {&#39;Health&#39;: &#39;OK&#39;}}, &#39;FanRedundancy&#39;: &#39;Redundant&#39;, &#39;Fans&#39;: {&#39;Status&#39;: {&#39;Health&#39;: &#39;OK&#39;}}, &#39;Memory&#39;: {&#39;Status&#39;: {&#39;Health&#39;: &#39;OK&#39;}}, &#39;Network&#39;: {&#39;Status&#39;: {&#39;Health&#39;: &#39;OK&#39;}}, &#39;PowerSupplies&#39;: {&#39;PowerSuppliesMismatch&#39;: False, &#39;Status&#39;: {&#39;Health&#39;: &#39;OK&#39;}}, &#39;Processors&#39;: {&#39;Status&#39;: {&#39;Health&#39;: &#39;OK&#39;}}, &#39;Storage&#39;: {&#39;Status&#39;: {&#39;Health&#39;: &#39;Warning&#39;}}, &#39;Temperatures&#39;: {&#39;Status&#39;: {&#39;Health&#39;: &#39;OK&#39;}}}, &#39;Bios&#39;: {&#39;Backup&#39;: {&#39;Date&#39;: &#39;11/13/2019&#39;, &#39;Family&#39;: &#39;U32&#39;, &#39;VersionString&#39;: &#39;U32 v2.22 (11/13/2019)&#39;}, &#39;Current&#39;: {&#39;Date&#39;: &#39;11/13/2019&#39;, &#39;Family&#39;: &#39;U32&#39;, &#39;VersionString&#39;: &#39;U32 v2.22 (11/13/2019)&#39;}, &#39;UefiClass&#39;: 2}, &#39;CriticalTempRemainOff&#39;: False, &#39;CurrentPowerOnTimeSeconds&#39;: None, &#39;DeviceDiscoveryComplete&#39;: {&#39;AMSDeviceDiscovery&#39;: &#39;NoAMS&#39;, &#39;DeviceDiscovery&#39;: &#39;vMainDeviceDiscoveryComplete&#39;, &#39;SmartArrayDiscovery&#39;: &#39;Complete&#39;}, &#39;ElapsedEraseTimeInMinutes&#39;: 0, &#39;EndOfPostDelaySeconds&#39;: None, &#39;EstimatedEraseTimeInMinutes&#39;: 0, &#39;IntelligentProvisioningAlwaysOn&#39;: True, &#39;IntelligentProvisioningIndex&#39;: 8, &#39;IntelligentProvisioningLocation&#39;: &#39;System Board&#39;, &#39;IntelligentProvisioningVersion&#39;: &#39;3.60.12&#39;, &#39;IsColdBooting&#39;: False, &#39;Links&#39;: {&#39;HpeIpProvider&#39;: {&#39;@odata.id&#39;: &#39;/redfish/v1/systems/1/hpeip/&#39;}, &#39;SUT&#39;: {&#39;@odata.id&#39;: &#39;/redfish/v1/systems/1/hpsut/&#39;}, &#39;PCIDevices&#39;: {&#39;@odata.id&#39;: &#39;/redfish/v1/Systems/1/PCIDevices/&#39;}, &#39;PCISlots&#39;: {&#39;@odata.id&#39;: &#39;/redfish/v1/Systems/1/PCISlots/&#39;}, &#39;NetworkAdapters&#39;: {&#39;@odata.id&#39;: &#39;/redfish/v1/Systems/1/BaseNetworkAdapters/&#39;}, &#39;SmartStorage&#39;: {&#39;@odata.id&#39;: &#39;/redfish/v1/Systems/1/SmartStorage/&#39;}, &#39;USBPorts&#39;: {&#39;@odata.id&#39;: &#39;/redfish/v1/Systems/1/USBPorts/&#39;}, &#39;USBDevices&#39;: {&#39;@odata.id&#39;: &#39;/redfish/v1/Systems/1/USBDevices/&#39;}, &#39;EthernetInterfaces&#39;: {&#39;@odata.id&#39;: &#39;/redfish/v1/Systems/1/EthernetInterfaces/&#39;}, &#39;WorkloadPerformanceAdvisor&#39;: {&#39;@odata.id&#39;: &#39;/redfish/v1/Systems/1/WorkloadPerformanceAdvisor/&#39;}, &#39;SecureEraseReportService&#39;: {&#39;@odata.id&#39;: &#39;/redfish/v1/Systems/1/SecureEraseReportService/&#39;}}, &#39;PCAPartNumber&#39;: &#39;847479-001&#39;, &#39;PCASerialNumber&#39;: &#39;PVZEK0ARHA014I&#39;, &#39;PostDiscoveryCompleteTimeStamp&#39;: None, &#39;PostDiscoveryMode&#39;: None, &#39;PostMode&#39;: None, &#39;PostState&#39;: &#39;FinishedPost&#39;, &#39;PowerAllocationLimit&#39;: 500, &#39;PowerAutoOn&#39;: &#39;Restore&#39;, &#39;PowerOnDelay&#39;: &#39;Minimum&#39;, &#39;PowerOnMinutes&#39;: 80090, &#39;PowerRegulatorMode&#39;: &#39;OSControl&#39;, &#39;PowerRegulatorModesSupported&#39;: [&#39;OSControl&#39;, &#39;Dynamic&#39;, &#39;Max&#39;, &#39;Min&#39;], &#39;ProcessorJitterControl&#39;: {&#39;ConfiguredFrequencyLimitMHz&#39;: 0, &#39;Mode&#39;: &#39;Disabled&#39;}, &#39;SMBIOS&#39;: {&#39;extref&#39;: &#39;/smbios&#39;}, &#39;ServerFQDN&#39;: &#39;&#39;, &#39;SmartStorageConfig&#39;: [{&#39;@odata.id&#39;: &#39;/redfish/v1/systems/1/smartstorageconfig/&#39;}], &#39;SystemROMAndiLOEraseComponentStatus&#39;: {&#39;BIOSSettingsEraseStatus&#39;: &#39;Idle&#39;, &#39;iLOSettingsEraseStatus&#39;: &#39;Idle&#39;}, &#39;SystemROMAndiLOEraseStatus&#39;: &#39;Idle&#39;, &#39;UserDataEraseComponentStatus&#39;: {}, &#39;UserDataEraseStatus&#39;: &#39;Idle&#39;, &#39;VirtualProfile&#39;: &#39;Inactive&#39;}}, &#39;PowerState&#39;: &#39;On&#39;, &#39;ProcessorSummary&#39;: {&#39;Count&#39;: 1, &#39;Model&#39;: &#39;Intel(R) Xeon(R) Bronze 3106 CPU @ 1.70GHz&#39;, &#39;Status&#39;: {&#39;HealthRollup&#39;: &#39;OK&#39;}}, &#39;Processors&#39;: {&#39;@odata.id&#39;: &#39;/redfish/v1/Systems/1/Processors/&#39;}, &#39;SKU&#39;: &#39;DL3000GEN10&#39;, &#39;SecureBoot&#39;: {&#39;@odata.id&#39;: &#39;/redfish/v1/Systems/1/SecureBoot/&#39;}, &#39;SerialNumber&#39;: &#39;TX86NP0121&#39;, &#39;Status&#39;: {&#39;Health&#39;: &#39;Warning&#39;, &#39;HealthRollup&#39;: &#39;Warning&#39;, &#39;State&#39;: &#39;Enabled&#39;}, &#39;Storage&#39;: {&#39;@odata.id&#39;: &#39;/redfish/v1/Systems/1/Storage/&#39;}, &#39;SystemType&#39;: &#39;Physical&#39;, &#39;TrustedModules&#39;: [{&#39;Oem&#39;: {&#39;Hpe&#39;: {&#39;@odata.context&#39;: &#39;/redfish/v1/$metadata#HpeTrustedModuleExt.HpeTrustedModuleExt&#39;, &#39;@odata.type&#39;: &#39;#HpeTrustedModuleExt.v2_0_0.HpeTrustedModuleExt&#39;}}, &#39;Status&#39;: {&#39;State&#39;: &#39;Absent&#39;}}], &#39;UUID&#39;: &#39;30334C44-3030-5854-3836-4E5030313231&#39;}], &#39;Members@odata.count&#39;: 1}
</pre></div>
</div>
</div>
</div>
<div class="section" id="find-ilo-mac-address">
<h2>Find iLO MAC Address<a class="headerlink" href="#find-ilo-mac-address" title="Permalink to this headline">¶</a></h2>
<p>Retrieve MAC Addresses for iLO Management Network Interfaces.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">find_ilo_mac_address</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">):</span>

    <span class="n">ethernet_data</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">resource_instances</span> <span class="o">=</span> <span class="n">get_resource_directory</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DISABLE_RESOURCE_DIR</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">resource_instances</span><span class="p">:</span>
        <span class="c1">#if we do not have a resource directory or want to force it&#39;s non use to find the</span>
        <span class="c1">#relevant URI</span>
        <span class="n">managers_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Managers&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">managers_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">managers_uri</span><span class="p">)</span>
        <span class="n">managers_members_uri</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">managers_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]))[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">managers_members_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">managers_members_uri</span><span class="p">)</span>
        <span class="n">manager_ethernet_interfaces</span> <span class="o">=</span> <span class="n">managers_members_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;EthernetInterfaces&#39;</span><span class="p">]</span>\
                                                                                    <span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">manager_ethernet_interfaces_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">manager_ethernet_interfaces</span><span class="p">)</span>
        <span class="n">manager_ethernet_interfaces_members</span> <span class="o">=</span> <span class="n">manager_ethernet_interfaces_response</span><span class="o">.</span>\
                                                            <span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">_member</span> <span class="ow">in</span> <span class="n">manager_ethernet_interfaces_members</span><span class="p">:</span>
            <span class="n">_tmp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">_member</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">obj</span>
            <span class="n">ethernet_data</span><span class="p">[</span><span class="n">_member</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">_tmp</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#Use Resource directory to find the relevant URI</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">resource_instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;#EthernetInterfaceCollection.&#39;</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.type&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="s1">&#39;Managers&#39;</span> <span class="ow">in</span> \
                                                                        <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]:</span>
                <span class="n">ethernet_uri</span> <span class="o">=</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
                <span class="n">ethernet_interfaces</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ethernet_uri</span><span class="p">)</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">_ethernet_interface</span> <span class="ow">in</span> <span class="n">ethernet_interfaces</span><span class="p">:</span>
                    <span class="n">ethernet_data</span><span class="p">[</span><span class="n">_ethernet_interface</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span>\
                                                        <span class="n">get</span><span class="p">(</span><span class="n">_ethernet_interface</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">dict</span>
    <span class="k">for</span> <span class="n">iface</span> <span class="ow">in</span> <span class="n">ethernet_data</span><span class="p">:</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;iLO Network Manager Interface: </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ethernet_data</span><span class="p">[</span><span class="n">iface</span><span class="p">][</span><span class="s1">&#39;Id&#39;</span><span class="p">])</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">iLO Mac Address: </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ethernet_data</span><span class="p">[</span><span class="n">iface</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;MACAddress&#39;</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="id2">
<h3>Response Example<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>Standard response:</p>
<div class="highlight-TEXT notranslate"><div class="highlight"><pre><span></span>iLO Network Manager Interface: &#39;1&#39;
    iLO Mac Address: &#39;98:F2:B3:21:7B:48&#39;
iLO Network Manager Interface: &#39;2&#39;
    iLO Mac Address: &#39;98:F2:B3:21:7B:49&#39;
iLO Network Manager Interface: &#39;3&#39;
    iLO Mac Address: &#39;0A:CA:FE:F0:0D:04&#39;
</pre></div>
</div>
</div>
</div>
<div class="section" id="get-certificate-signing-request">
<h2>Get Certificate Signing Request<a class="headerlink" href="#get-certificate-signing-request" title="Permalink to this headline">¶</a></h2>
<p>Obtain an iLO Certificate Signing Request for use with Secure Socket Layer (SSL)/Transport Layer Security (TLS) Certificate.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This process may take some time to complete on iLO (~5 minutes).</p>
</div>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">generate_csr</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">,</span> <span class="n">csr_file</span><span class="p">,</span> <span class="n">csr_properties</span><span class="p">):</span>

    <span class="n">csr_uri</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">generate_csr_uri</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">resource_instances</span> <span class="o">=</span> <span class="n">get_resource_directory</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DISABLE_RESOURCE_DIR</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">resource_instances</span><span class="p">:</span>
        <span class="c1">#if we do not have a resource directory or want to force it&#39;s non use to find the</span>
        <span class="c1">#relevant URI</span>
        <span class="n">managers_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Managers&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">managers_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">managers_uri</span><span class="p">)</span>
        <span class="n">managers_members_uri</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">managers_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]))[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">managers_members_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">managers_members_uri</span><span class="p">)</span>
        <span class="n">security_service_uri</span> <span class="o">=</span> <span class="n">managers_members_response</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">Oem</span><span class="o">.</span><span class="n">Hpe</span><span class="o">.</span><span class="n">Links</span>\
                                                                <span class="p">[</span><span class="s1">&#39;SecurityService&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">security_service_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">security_service_uri</span><span class="p">)</span>
        <span class="n">csr_uri</span> <span class="o">=</span> <span class="n">security_service_response</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">Links</span><span class="p">[</span><span class="s1">&#39;HttpsCert&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">https_cert_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">csr_uri</span><span class="p">)</span>
        <span class="n">generate_csr_uri</span> <span class="o">=</span> <span class="n">https_cert_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Actions&#39;</span><span class="p">][</span><span class="s1">&#39;#HpeHttpsCert.GenerateCSR&#39;</span><span class="p">]</span>\
                                                                                    <span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#Use Resource directory to find the relevant URI</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">resource_instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;#HpeHttpsCert.&#39;</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.type&#39;</span><span class="p">]:</span>
                <span class="n">csr_uri</span> <span class="o">=</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
                <span class="n">generate_csr_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">csr_uri</span><span class="p">)</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Actions&#39;</span><span class="p">]</span>\
                                                        <span class="p">[</span><span class="s1">&#39;#HpeHttpsCert.GenerateCSR&#39;</span><span class="p">][</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
                <span class="k">break</span>

    <span class="k">if</span> <span class="n">generate_csr_uri</span><span class="p">:</span>
        <span class="n">body</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">body</span><span class="p">[</span><span class="s2">&quot;Action&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;HpeHttpsCert.GenerateCSR&quot;</span>
        <span class="n">body</span><span class="p">[</span><span class="s2">&quot;City&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">csr_properties</span><span class="p">[</span><span class="s2">&quot;City&quot;</span><span class="p">]</span>
        <span class="n">body</span><span class="p">[</span><span class="s2">&quot;CommonName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">csr_properties</span><span class="p">[</span><span class="s2">&quot;CommonName&quot;</span><span class="p">]</span>
        <span class="n">body</span><span class="p">[</span><span class="s2">&quot;Country&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">csr_properties</span><span class="p">[</span><span class="s2">&quot;Country&quot;</span><span class="p">]</span>
        <span class="n">body</span><span class="p">[</span><span class="s2">&quot;OrgName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">csr_properties</span><span class="p">[</span><span class="s2">&quot;OrgName&quot;</span><span class="p">]</span>
        <span class="n">body</span><span class="p">[</span><span class="s2">&quot;OrgUnit&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">csr_properties</span><span class="p">[</span><span class="s2">&quot;OrgUnit&quot;</span><span class="p">]</span>
        <span class="n">body</span><span class="p">[</span><span class="s2">&quot;State&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">csr_properties</span><span class="p">[</span><span class="s2">&quot;State&quot;</span><span class="p">]</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">generate_csr_uri</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">201</span><span class="p">]:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Generating CSR, this may take a few minutes</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Sleeping for 5 minutes...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">600</span><span class="p">)</span>
            <span class="n">csr_resp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">csr_uri</span><span class="p">)</span><span class="o">.</span><span class="n">dict</span><span class="p">[</span><span class="s1">&#39;CertificateSigningRequest&#39;</span><span class="p">]</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">csr_file</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">csroutput</span><span class="p">:</span>
                <span class="n">csroutput</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">csr_resp</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;CSR Data saved to file: &#39;</span><span class="si">%s</span><span class="s2">&#39;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">csr_file</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1">#If iLO responds with soemthing outside of 200 or 201 then lets check the iLO extended</span>
            <span class="c1">#info error message to see what went wrong</span>
            <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">201</span><span class="p">]:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="s1">&#39;@Message.ExtendedInfo&#39;</span><span class="p">],</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> \
                                                                                    <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">excp</span><span class="p">:</span>
                    <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;A response error occurred, unable to access iLO &quot;</span>\
                                     <span class="s2">&quot;Extended Message Info...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="get-ahs-data">
<h2>Get AHS Data<a class="headerlink" href="#get-ahs-data" title="Permalink to this headline">¶</a></h2>
<p>Obtain Active Health System Data.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>AHS data is saved to a file, the contents of which are encoded. The use of an AHS Viewer to decode and parse
is required. Please review Active Health System Viewer Documentation for further details:
<a class="reference external" href="https://support.hpe.com/hpesc/public/docDisplay?docId=c05384164">https://support.hpe.com/hpesc/public/docDisplay?docId=c05384164</a></p>
</div>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_ahs_data</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">,</span> <span class="n">logfile</span><span class="p">):</span>

    <span class="n">active_health_system_uri</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">resource_instances</span> <span class="o">=</span> <span class="n">get_resource_directory</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DISABLE_RESOURCE_DIR</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">resource_instances</span><span class="p">:</span>
        <span class="c1">#if we do not have a resource directory or want to force it&#39;s non use to find the</span>
        <span class="c1">#relevant URI</span>
        <span class="n">managers_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Managers&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">managers_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">managers_uri</span><span class="p">)</span>
        <span class="n">managers_members_uri</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">managers_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]))[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">managers_members_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">managers_members_uri</span><span class="p">)</span>
        <span class="n">active_health_system_uri</span> <span class="o">=</span> <span class="n">managers_members_response</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">Oem</span><span class="o">.</span><span class="n">Hpe</span><span class="o">.</span><span class="n">Links</span>\
                                    <span class="p">[</span><span class="s1">&#39;ActiveHealthSystem&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#Use Resource directory to find the relevant URI</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">resource_instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;#HpeiLOActiveHealthSystem.&#39;</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.type&#39;</span><span class="p">]:</span>
                <span class="n">active_health_system_uri</span> <span class="o">=</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">active_health_system_uri</span><span class="p">:</span>
        <span class="n">active_health_system_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">active_health_system_uri</span><span class="p">)</span>
        <span class="n">active_health_system_log_uri</span> <span class="o">=</span> <span class="n">active_health_system_response</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">Links</span><span class="p">[</span><span class="s1">&#39;AHSLocation&#39;</span><span class="p">]</span>\
                                                                                        <span class="p">[</span><span class="s1">&#39;extref&#39;</span><span class="p">]</span>
        <span class="n">active_health_system_log_resp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">active_health_system_log_uri</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">active_health_system_log_resp</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">400</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">active_health_system_log_resp</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">]</span>\
                                 <span class="p">[</span><span class="s1">&#39;@Message.ExtendedInfo&#39;</span><span class="p">],</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;A response error occurred, unable to access iLO Extended &quot;</span>\
                                 <span class="s2">&quot;Message Info...&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">active_health_system_log_resp</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;An http response of </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s2"> was returned.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Success!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">logfile</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ahsoutput</span><span class="p">:</span>
                <span class="n">ahsoutput</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">active_health_system_log_resp</span><span class="o">.</span><span class="n">ori</span><span class="p">)</span>
                <span class="n">ahsoutput</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;AHS Data saved successfully as: </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">logfile</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="get-base-registries">
<h2>Get Base Registries<a class="headerlink" href="#get-base-registries" title="Permalink to this headline">¶</a></h2>
<p>Obtain Registry Providers. Registry providers allow for the transaction of data between properties and firmware.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_base_registry</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">):</span>

<span class="n">registries_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Registries&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>

<span class="k">if</span> <span class="n">registries_uri</span><span class="p">:</span>
    <span class="n">registries_members</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">registries_uri</span><span class="p">)</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">registry</span> <span class="ow">in</span> <span class="n">registries_members</span><span class="p">:</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Registry URI at &#39;</span><span class="si">%s</span><span class="s2">&#39;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">registry</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">])</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="get-eskm">
<h2>Get ESKM<a class="headerlink" href="#get-eskm" title="Permalink to this headline">¶</a></h2>
<p>Obtain HPE Enterprise Secure Key Manager Encryption Data.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_ESKM</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">):</span>

    <span class="n">security_service_eskm_uri</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">resource_instances</span> <span class="o">=</span> <span class="n">get_resource_directory</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DISABLE_RESOURCE_DIR</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">resource_instances</span><span class="p">:</span>
        <span class="c1">#if we do not have a resource directory or want to force it&#39;s non use to find the</span>
        <span class="c1">#relevant URI</span>
        <span class="n">managers_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Managers&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">managers_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">managers_uri</span><span class="p">)</span>
        <span class="n">managers_members_uri</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">managers_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]))[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">managers_members_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">managers_members_uri</span><span class="p">)</span>
        <span class="n">security_service_uri</span> <span class="o">=</span> <span class="n">managers_members_response</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">Oem</span><span class="o">.</span><span class="n">Hpe</span><span class="o">.</span><span class="n">Links</span>\
                                                                <span class="p">[</span><span class="s1">&#39;SecurityService&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">security_service_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">security_service_uri</span><span class="p">)</span>
        <span class="n">security_service_eskm_uri</span> <span class="o">=</span> <span class="n">security_service_response</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">Links</span><span class="p">[</span><span class="s1">&#39;ESKM&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">resource_instances</span><span class="p">:</span>
            <span class="c1">#Use Resource directory to find the relevant URI</span>
            <span class="k">if</span> <span class="s1">&#39;#HpeESKM.&#39;</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.type&#39;</span><span class="p">]:</span>
                <span class="n">security_service_eskm_uri</span> <span class="o">=</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
                <span class="k">break</span>

    <span class="k">if</span> <span class="n">security_service_eskm_uri</span><span class="p">:</span>
        <span class="n">security_service_eskm_resp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">security_service_eskm_uri</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">security_service_eskm_resp</span><span class="o">.</span><span class="n">dict</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="id3">
<h3>Response Example<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<div class="highlight-JSON notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;@odata.context&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/$metadata#HpeESKM.HpeESKM&quot;</span><span class="p">,</span>
    <span class="nt">&quot;@odata.etag&quot;</span><span class="p">:</span> <span class="s2">&quot;W/\&quot;87058EB1\&quot;&quot;</span><span class="p">,</span>
    <span class="nt">&quot;@odata.id&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/Managers/1/SecurityService/ESKM/&quot;</span><span class="p">,</span>
    <span class="nt">&quot;@odata.type&quot;</span><span class="p">:</span> <span class="s2">&quot;#HpeESKM.v2_0_0.HpeESKM&quot;</span><span class="p">,</span>
    <span class="nt">&quot;Actions&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;#HpeESKM.ClearESKMLog&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/Managers/1/SecurityService/ESKM/Actions/HpeESKM.ClearESKMLog/&quot;</span>
        <span class="p">},</span>
        <span class="nt">&quot;#HpeESKM.TestESKMConnections&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/Managers/1/SecurityService/ESKM/Actions/HpeESKM.TestESKMConnections/&quot;</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="nt">&quot;Id&quot;</span><span class="p">:</span> <span class="s2">&quot;ESKM&quot;</span><span class="p">,</span>
    <span class="nt">&quot;KeyManagerConfig&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;AccountGroup&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="nt">&quot;AccountName&quot;</span><span class="p">:</span> <span class="s2">&quot;ilo-98f2b3217b48&quot;</span><span class="p">,</span>
        <span class="nt">&quot;ESKMLocalCACertificateName&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="nt">&quot;ImportedCertificateIssuer&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="nt">&quot;ImportedCertificateSubject&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;KeyServerRedundancyReq&quot;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="nt">&quot;PrimaryKeyServerAddress&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="nt">&quot;PrimaryKeyServerPort&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="nt">&quot;SecondaryKeyServerAddress&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="nt">&quot;SecondaryKeyServerPort&quot;</span><span class="p">:</span> <span class="kc">null</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="get-ilo-ip">
<h2>Get iLO IP<a class="headerlink" href="#get-ilo-ip" title="Permalink to this headline">¶</a></h2>
<p>Obtain iLO Network Management Interface(s) IP Address(s).</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_ilo_ip</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">):</span>
    <span class="n">ethernet_data</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">resource_instances</span> <span class="o">=</span> <span class="n">get_resource_directory</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DISABLE_RESOURCE_DIR</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">resource_instances</span><span class="p">:</span>
        <span class="c1">#if we do not have a resource directory or want to force it&#39;s non use to find the</span>
        <span class="c1">#relevant URI</span>
        <span class="n">managers_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Managers&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">managers_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">managers_uri</span><span class="p">)</span>
        <span class="n">managers_members_uri</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">managers_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]))[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">managers_members_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">managers_members_uri</span><span class="p">)</span>
        <span class="n">manager_ethernet_interfaces</span> <span class="o">=</span> <span class="n">managers_members_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;EthernetInterfaces&#39;</span><span class="p">]</span>\
                                                                                    <span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">manager_ethernet_interfaces_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">manager_ethernet_interfaces</span><span class="p">)</span>
        <span class="n">manager_ethernet_interfaces_members</span> <span class="o">=</span> <span class="n">manager_ethernet_interfaces_response</span><span class="o">.</span>\
                                                            <span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">_member</span> <span class="ow">in</span> <span class="n">manager_ethernet_interfaces_members</span><span class="p">:</span>
            <span class="n">_tmp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">_member</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">obj</span>
            <span class="n">ethernet_data</span><span class="p">[</span><span class="n">_member</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">_tmp</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">resource_instances</span><span class="p">:</span>
            <span class="c1">#Use Resource directory to find the relevant URI</span>
            <span class="k">if</span> <span class="s1">&#39;#EthernetInterfaceCollection.&#39;</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.type&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="s1">&#39;Managers&#39;</span> <span class="ow">in</span> \
                                                                        <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]:</span>
                <span class="n">ethernet_uri</span> <span class="o">=</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
                <span class="n">ethernet_interfaces</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ethernet_uri</span><span class="p">)</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">_ethernet_interface</span> <span class="ow">in</span> <span class="n">ethernet_interfaces</span><span class="p">:</span>
                    <span class="n">ethernet_data</span><span class="p">[</span><span class="n">_ethernet_interface</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span>\
                                                        <span class="n">get</span><span class="p">(</span><span class="n">_ethernet_interface</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">dict</span>
                <span class="k">break</span>

    <span class="k">if</span> <span class="n">ethernet_data</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">ethernet_interface</span> <span class="ow">in</span> <span class="n">ethernet_data</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Showing iLO IPv4 Address Info on: </span><span class="si">%s</span><span class="se">\n\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ethernet_interface</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">ethernet_data</span><span class="p">[</span><span class="n">ethernet_interface</span><span class="p">][</span><span class="s1">&#39;IPv4Addresses&#39;</span><span class="p">],</span>\
                                                                        <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="id4">
<h3>Response Example<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>Response data for each available network management interface is parsed for the Redfish IPv4 Data including:
IP Address, Address Origin (Static/DHCP), Network Gateway, and Network Subnet Mask</p>
</div>
</div>
<div class="section" id="get-ilo-nic">
<h2>Get iLO NIC<a class="headerlink" href="#get-ilo-nic" title="Permalink to this headline">¶</a></h2>
<p>Obtain iLO Network Management Interface(s) Interface Enabled states. Modify lines 34-37 to display
relevant desired data or all key-value pairs.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_ilo_nic</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">,</span> <span class="n">get_enabled</span><span class="p">):</span>
    <span class="n">ethernet_data</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">resource_instances</span> <span class="o">=</span> <span class="n">get_resource_directory</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DISABLE_RESOURCE_DIR</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">resource_instances</span><span class="p">:</span>
        <span class="c1">#if we do not have a resource directory or want to force it&#39;s non use to find the</span>
        <span class="c1">#relevant URI</span>
        <span class="n">managers_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Managers&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">managers_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">managers_uri</span><span class="p">)</span>
        <span class="n">managers_members_uri</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">managers_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]))[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">managers_members_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">managers_members_uri</span><span class="p">)</span>
        <span class="n">manager_ethernet_interfaces</span> <span class="o">=</span> <span class="n">managers_members_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;EthernetInterfaces&#39;</span><span class="p">]</span>\
                                                                                    <span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">manager_ethernet_interfaces_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">manager_ethernet_interfaces</span><span class="p">)</span>
        <span class="n">manager_ethernet_interfaces_members</span> <span class="o">=</span> <span class="n">manager_ethernet_interfaces_response</span><span class="o">.</span>\
                                                            <span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">_member</span> <span class="ow">in</span> <span class="n">manager_ethernet_interfaces_members</span><span class="p">:</span>
            <span class="n">_tmp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">_member</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">obj</span>
            <span class="n">ethernet_data</span><span class="p">[</span><span class="n">_member</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">_tmp</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">resource_instances</span><span class="p">:</span>
            <span class="c1">#Use Resource directory to find the relevant URI</span>
            <span class="k">if</span> <span class="s1">&#39;#EthernetInterfaceCollection.&#39;</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.type&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="s1">&#39;Managers&#39;</span> <span class="ow">in</span> \
                                                                        <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]:</span>
                <span class="n">ethernet_uri</span> <span class="o">=</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
                <span class="n">ethernet_interfaces</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ethernet_uri</span><span class="p">)</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">_ethernet_interface</span> <span class="ow">in</span> <span class="n">ethernet_interfaces</span><span class="p">:</span>
                    <span class="n">ethernet_data</span><span class="p">[</span><span class="n">_ethernet_interface</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span>\
                                                        <span class="n">get</span><span class="p">(</span><span class="n">_ethernet_interface</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">dict</span>
                <span class="k">break</span>

    <span class="k">if</span> <span class="n">ethernet_data</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">ethernet_interface</span> <span class="ow">in</span> <span class="n">ethernet_data</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Showing iLO IPv4 Address Info on: </span><span class="si">%s</span><span class="se">\n\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ethernet_interface</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\&#39;</span><span class="s2">Interface_Enabled</span><span class="se">\&#39;</span><span class="s2">: </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">ethernet_data</span>\
                                    <span class="p">[</span><span class="n">ethernet_interface</span><span class="p">][</span><span class="n">get_enabled</span><span class="p">],</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="id5">
<h3>Response Example<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p>Response data for each available network management interface is parsed for the Redfish IPv4 Data including:
IP Address, Address Origin (Static/DHCP), Network Gateway, and Network Subnet Mask</p>
</div>
</div>
<div class="section" id="get-license-key">
<h2>Get License Key<a class="headerlink" href="#get-license-key" title="Permalink to this headline">¶</a></h2>
<p>Obtain iLO Licensing Key Information.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_license_key</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">):</span>
    <span class="n">license_uri</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">license_data</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">resource_instances</span> <span class="o">=</span> <span class="n">get_resource_directory</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DISABLE_RESOURCE_DIR</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">resource_instances</span><span class="p">:</span>
        <span class="c1">#if we do not have a resource directory or want to force it&#39;s non use to find the</span>
        <span class="c1">#relevant URI</span>
        <span class="n">managers_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Managers&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">managers_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">managers_uri</span><span class="p">)</span>
        <span class="n">managers_members_uri</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">managers_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]))[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">managers_members_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">managers_members_uri</span><span class="p">)</span>
        <span class="n">hp_hpe</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">managers_members_response</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">Oem</span><span class="p">))</span>
        <span class="n">license_collection_uri</span> <span class="o">=</span> <span class="n">managers_members_response</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">Oem</span><span class="p">[</span><span class="n">hp_hpe</span><span class="p">]</span><span class="o">.</span><span class="n">Links</span><span class="p">[</span><span class="s1">&#39;LicenseService&#39;</span><span class="p">]</span>\
                                                                                    <span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">license_collection_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">license_collection_uri</span><span class="p">)</span>
        <span class="n">license_collection_members_uri</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">license_collection_response</span><span class="o">.</span><span class="n">obj</span>\
                                                                        <span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]))[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">license_data</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">license_collection_members_uri</span><span class="p">)</span><span class="o">.</span><span class="n">dict</span>
        <span class="n">license_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">license_collection_members_uri</span><span class="p">)</span><span class="o">.</span><span class="n">dict</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">resource_instances</span><span class="p">:</span>
            <span class="c1">#Use Resource directory to find the relevant URI</span>
            <span class="k">if</span> <span class="s1">&#39;#HpeiLOLicense.&#39;</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.type&#39;</span><span class="p">]:</span>
                <span class="n">license_uri</span> <span class="o">=</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
                <span class="n">license_data</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">license_uri</span><span class="p">)</span><span class="o">.</span><span class="n">dict</span>
                <span class="k">break</span>

    <span class="k">if</span> <span class="n">license_data</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\&#39;</span><span class="s2">License Info</span><span class="se">\&#39;</span><span class="s2">: </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;\n</span><span class="s2">&quot;</span> <span class="o">%</span> \
            <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">license_data</span><span class="p">[</span><span class="s1">&#39;ConfirmationRequest&#39;</span><span class="p">][</span><span class="s1">&#39;EON&#39;</span><span class="p">],</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\&#39;</span><span class="s2">License Info</span><span class="se">\&#39;</span><span class="s2">: </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;\n</span><span class="s2">&quot;</span> <span class="o">%</span> \
            <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">license_data</span><span class="p">[</span><span class="s1">&#39;LicenseKey&#39;</span><span class="p">],</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="id6">
<h3>Response Example<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p>Response Data will include the License Type, License Key (iLO 5) and State.</p>
</div>
</div>
<div class="section" id="get-logical-drives">
<h2>Get Logical Drives<a class="headerlink" href="#get-logical-drives" title="Permalink to this headline">¶</a></h2>
<p>List all logical drives associated with a smart array controller.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_SmartArray_LogicalDrives</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">):</span>

    <span class="n">smartstorage_response</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">smartarraycontrollers</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

    <span class="n">resource_instances</span> <span class="o">=</span> <span class="n">get_resource_directory</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DISABLE_RESOURCE_DIR</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">resource_instances</span><span class="p">:</span>
        <span class="c1">#if we do not have a resource directory or want to force it&#39;s non use to find the</span>
        <span class="c1">#relevant URI</span>
        <span class="n">systems_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Systems&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">systems_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">systems_uri</span><span class="p">)</span>
        <span class="n">systems_members_uri</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">systems_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]))[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">systems_members_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">systems_members_uri</span><span class="p">)</span>
        <span class="n">smart_storage_uri</span> <span class="o">=</span> <span class="n">systems_members_response</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">Oem</span><span class="o">.</span><span class="n">Hpe</span><span class="o">.</span><span class="n">Links</span>\
                                                                <span class="p">[</span><span class="s1">&#39;SmartStorage&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">smart_storage_arraycontrollers_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">smart_storage_uri</span><span class="p">)</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">Links</span>\
                                                                <span class="p">[</span><span class="s1">&#39;ArrayControllers&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">smartstorage_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">smart_storage_arraycontrollers_uri</span><span class="p">)</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">resource_instances</span><span class="p">:</span>
            <span class="c1">#Use Resource directory to find the relevant URI</span>
            <span class="k">if</span> <span class="s1">&#39;#HpeSmartStorageArrayController.&#39;</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.type&#39;</span><span class="p">]:</span>
                <span class="n">smartstorage_uri</span> <span class="o">=</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
                <span class="n">smartstorage_resp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">smartstorage_uri</span><span class="p">)</span><span class="o">.</span><span class="n">obj</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Logical Drive URIs for Smart Storage Array Controller &quot;</span> \
                    <span class="s2">&quot;&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s2"> : </span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">smartstorage_resp</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Id&#39;</span><span class="p">))</span>
                <span class="n">logicaldrives_uri</span> <span class="o">=</span> <span class="n">smartstorage_resp</span><span class="o">.</span><span class="n">Links</span><span class="p">[</span><span class="s1">&#39;LogicalDrives&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
                <span class="n">logicaldrives_resp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">logicaldrives_uri</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">logicaldrives_resp</span><span class="o">.</span><span class="n">dict</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]:</span>
                    <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Logical drives are not available for this controller.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">drives</span> <span class="ow">in</span> <span class="n">logicaldrives_resp</span><span class="o">.</span><span class="n">dict</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]:</span>
                    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2"> An associated logical drive: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">drives</span><span class="p">)</span>
                    <span class="n">drive_data</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">drives</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">dict</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">drive_data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="id7">
<h3>Response Example<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<p>Logical drives listed</p>
</div>
</div>
<div class="section" id="get-power-metrics">
<h2>Get Power Metrics<a class="headerlink" href="#get-power-metrics" title="Permalink to this headline">¶</a></h2>
<p>Obtain Redfish power metrics.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_powermetrics_average</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">):</span>

    <span class="n">power_metrics_uri</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">resource_instances</span> <span class="o">=</span> <span class="n">get_resource_directory</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DISABLE_RESOURCE_DIR</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">resource_instances</span><span class="p">:</span>
        <span class="c1">#if we do not have a resource directory or want to force it&#39;s non use to find the</span>
        <span class="c1">#relevant URI</span>
        <span class="n">chassis_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Chassis&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">chassis_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">chassis_uri</span><span class="p">)</span>
        <span class="n">chassis_members_uri</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">chassis_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]))[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">chassis_members_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">chassis_members_uri</span><span class="p">)</span>
        <span class="n">power_metrics_uri</span> <span class="o">=</span> <span class="n">chassis_members_response</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">Oem</span><span class="o">.</span><span class="n">Hpe</span><span class="p">[</span><span class="s1">&#39;Power&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">resource_instances</span><span class="p">:</span>
            <span class="c1">#Use Resource directory to find the relevant URI</span>
            <span class="k">if</span> <span class="s1">&#39;#Power.&#39;</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.type&#39;</span><span class="p">]:</span>
                <span class="n">power_metrics_uri</span> <span class="o">=</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
                <span class="k">break</span>

    <span class="k">if</span> <span class="n">power_metrics_uri</span><span class="p">:</span>
        <span class="n">power_metrics_data</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">power_metrics_uri</span><span class="p">)</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">Oem</span><span class="o">.</span><span class="n">Hpe</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Power Data:</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">power_metrics_data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="id8">
<h3>Response Example<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<p>Power Metric Data</p>
</div>
</div>
<div class="section" id="get-resource-directory">
<h2>Get Resource Directory<a class="headerlink" href="#get-resource-directory" title="Permalink to this headline">¶</a></h2>
<p>Obtain iLO Resource Directory, quick access to all <a class="reference external" href="mailto:'&#37;&#52;&#48;odata&#46;type">‘<span>&#64;</span>odata<span>&#46;</span>type</a>’ references and respective <a class="reference external" href="mailto:'&#37;&#52;&#48;odata&#46;id">‘<span>&#64;</span>odata<span>&#46;</span>id</a>’.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This resource is only available on iLO systems.</p>
</div>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_resource_directory</span><span class="p">(</span><span class="n">redfishobj</span><span class="p">):</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">resource_uri</span> <span class="o">=</span> <span class="n">redfishobj</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">Oem</span><span class="o">.</span><span class="n">Hpe</span><span class="o">.</span><span class="n">Links</span><span class="o">.</span><span class="n">ResourceDirectory</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Resource directory is only available on HPE servers.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="n">response</span> <span class="o">=</span> <span class="n">redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">resource_uri</span><span class="p">)</span>
    <span class="n">resources</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Found resource directory at /redfish/v1/resourcedirectory&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">resources</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">dict</span><span class="p">[</span><span class="s2">&quot;Instances&quot;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Resource directory missing at /redfish/v1/resourcedirectory&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">resources</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="id9">
<h3>Response Example<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<p>Snippet of Resource directory</p>
</div>
</div>
<div class="section" id="get-schemas">
<h2>Get Schemas<a class="headerlink" href="#get-schemas" title="Permalink to this headline">¶</a></h2>
<p>Obtain schema data.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_schema</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">):</span>
    <span class="n">schema_members_uris</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">schema_members_expanded</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">schema_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;JsonSchemas&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
    <span class="n">schema_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">schema_uri</span><span class="p">)</span>
    <span class="n">schema_members_uris</span> <span class="o">=</span> <span class="n">schema_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">member</span> <span class="ow">in</span> <span class="n">schema_members_uris</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">member</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">dict</span>
        <span class="n">instance_id</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Location&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Location&#39;</span><span class="p">])))</span>
        <span class="n">schema_uri</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Location&#39;</span><span class="p">][</span><span class="n">instance_id</span><span class="p">][</span><span class="s1">&#39;Uri&#39;</span><span class="p">]</span>
        <span class="n">schema</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">schema_uri</span><span class="p">)</span><span class="o">.</span><span class="n">dict</span>
        <span class="c1">#I am just replacing the URI link for the sub-schema with the actual schema. You will</span>
        <span class="c1">#see EVERYTHING</span>
        <span class="n">_tmp</span> <span class="o">=</span> <span class="p">{</span><span class="n">schema_uri</span> <span class="o">+</span> <span class="s1">&#39; -&gt;&#39;</span><span class="p">:</span> <span class="n">schema</span><span class="p">}</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Location&#39;</span><span class="p">][</span><span class="n">instance_id</span><span class="p">][</span><span class="s1">&#39;Uri&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">_tmp</span>
        <span class="n">schema_members_expanded</span><span class="p">[</span><span class="n">member</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">data</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">schema_members_expanded</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="id10">
<h3>Response Example<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h3>
<p>Snippet of schema data for <em>HpeiLOManagerNetworkService</em></p>
</div>
</div>
<div class="section" id="get-smart-array-encryption">
<h2>Get Smart Array Encryption<a class="headerlink" href="#get-smart-array-encryption" title="Permalink to this headline">¶</a></h2>
<p>Obtain Smart Array controller encryption property data.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_SmartArray_EncryptionSettings</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">,</span> <span class="n">desired_properties</span><span class="p">):</span>

    <span class="n">smartstorage_response</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">smartarraycontrollers</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

    <span class="n">resource_instances</span> <span class="o">=</span> <span class="n">get_resource_directory</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DISABLE_RESOURCE_DIR</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">resource_instances</span><span class="p">:</span>
        <span class="c1">#if we do not have a resource directory or want to force it&#39;s non use to find the</span>
        <span class="c1">#relevant URI</span>
        <span class="n">systems_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Systems&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">systems_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">systems_uri</span><span class="p">)</span>
        <span class="n">systems_members_uri</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">systems_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]))[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">systems_members_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">systems_members_uri</span><span class="p">)</span>
        <span class="n">smart_storage_uri</span> <span class="o">=</span> <span class="n">systems_members_response</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">Oem</span><span class="o">.</span><span class="n">Hpe</span><span class="o">.</span><span class="n">Links</span>\
                                                                <span class="p">[</span><span class="s1">&#39;SmartStorage&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">smart_storage_arraycontrollers_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">smart_storage_uri</span><span class="p">)</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">Links</span>\
                                                                <span class="p">[</span><span class="s1">&#39;ArrayControllers&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">smartstorage_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">smart_storage_arraycontrollers_uri</span><span class="p">)</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">resource_instances</span><span class="p">:</span>
            <span class="c1">#Use Resource directory to find the relevant URI</span>
            <span class="k">if</span> <span class="s1">&#39;#HpeSmartStorageArrayControllerCollection.&#39;</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.type&#39;</span><span class="p">]:</span>
                <span class="n">smartstorage_uri</span> <span class="o">=</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
                <span class="n">smartstorage_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">smartstorage_uri</span><span class="p">)</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]</span>
                <span class="k">break</span>

    <span class="k">for</span> <span class="n">controller</span> <span class="ow">in</span> <span class="n">smartstorage_response</span><span class="p">:</span>
        <span class="n">smartarraycontrollers</span><span class="p">[</span><span class="n">controller</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">controller</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">])</span><span class="o">.</span>\
                                                                                                <span class="n">obj</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Encryption Properties for Smart Storage Array Controller </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s2"> : </span><span class="se">\n</span><span class="s2">&quot;</span> \
                                        <span class="o">%</span> <span class="n">smartarraycontrollers</span><span class="p">[</span><span class="n">controller</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Id&#39;</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">smartarraycontrollers</span><span class="p">[</span><span class="n">controller</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]]:</span>
            <span class="k">if</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">desired_properties</span><span class="p">:</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2"> </span><span class="si">%s</span><span class="s2"> : </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">smartarraycontrollers</span><span class="p">[</span><span class="n">controller</span>\
                                                                        <span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">data</span><span class="p">)))</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="id11">
<h3>Response Example<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h3>
<div class="highlight-JSON notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;@odata.context&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/$metadata#HpeESKM.HpeESKM&quot;</span><span class="p">,</span>
    <span class="nt">&quot;@odata.etag&quot;</span><span class="p">:</span> <span class="s2">&quot;W/\&quot;87058EB1\&quot;&quot;</span><span class="p">,</span>
    <span class="nt">&quot;@odata.id&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/Managers/1/SecurityService/ESKM/&quot;</span><span class="p">,</span>
    <span class="nt">&quot;@odata.type&quot;</span><span class="p">:</span> <span class="s2">&quot;#HpeESKM.v2_0_0.HpeESKM&quot;</span><span class="p">,</span>
    <span class="nt">&quot;Actions&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;#HpeESKM.ClearESKMLog&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/Managers/1/SecurityService/ESKM/Actions/HpeESKM.ClearESKMLog/&quot;</span>
        <span class="p">},</span>
        <span class="nt">&quot;#HpeESKM.TestESKMConnections&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;target&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/Managers/1/SecurityService/ESKM/Actions/HpeESKM.TestESKMConnections/&quot;</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="nt">&quot;Id&quot;</span><span class="p">:</span> <span class="s2">&quot;ESKM&quot;</span><span class="p">,</span>
    <span class="nt">&quot;KeyManagerConfig&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;AccountGroup&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="nt">&quot;AccountName&quot;</span><span class="p">:</span> <span class="s2">&quot;ilo-98f2b3217b48&quot;</span><span class="p">,</span>
        <span class="nt">&quot;ESKMLocalCACertificateName&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="nt">&quot;ImportedCertificateIssuer&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="nt">&quot;ImportedCertificateSubject&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;KeyServerRedundancyReq&quot;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="nt">&quot;PrimaryKeyServerAddress&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="nt">&quot;PrimaryKeyServerPort&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="nt">&quot;SecondaryKeyServerAddress&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="nt">&quot;SecondaryKeyServerPort&quot;</span><span class="p">:</span> <span class="kc">null</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="import-ssl-certificate">
<h2>Import SSL Certificate<a class="headerlink" href="#import-ssl-certificate" title="Permalink to this headline">¶</a></h2>
<p>Import Secure Socket Layer Certificate.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">import_ssl</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">,</span> <span class="n">ssl_file_path</span><span class="p">):</span>

    <span class="n">https_cert_uri</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">body</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

    <span class="n">resource_instances</span> <span class="o">=</span> <span class="n">get_resource_directory</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DISABLE_RESOURCE_DIR</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">resource_instances</span><span class="p">:</span>
        <span class="c1">#if we do not have a resource directory or want to force it&#39;s non use to find the</span>
        <span class="c1">#relevant URI</span>
        <span class="n">managers_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Managers&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">managers_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">managers_uri</span><span class="p">)</span>
        <span class="n">managers_members_uri</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">managers_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]))[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">managers_members_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">managers_members_uri</span><span class="p">)</span>
        <span class="n">security_service_uri</span> <span class="o">=</span> <span class="n">managers_members_response</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">Oem</span><span class="o">.</span><span class="n">Hpe</span><span class="o">.</span><span class="n">Links</span><span class="p">[</span><span class="s1">&#39;SecurityService&#39;</span><span class="p">]</span>\
                                                                                    <span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">security_service_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">security_service_uri</span><span class="p">)</span>
        <span class="n">https_cert_uri</span> <span class="o">=</span> <span class="n">security_service_response</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">Links</span><span class="p">[</span><span class="s1">&#39;HttpsCert&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">resource_instances</span><span class="p">:</span>
            <span class="c1">#Use Resource directory to find the relevant URI</span>
            <span class="k">if</span> <span class="s1">&#39;#HpeHttpsCert.&#39;</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.type&#39;</span><span class="p">]:</span>
                <span class="n">https_cert_uri</span> <span class="o">=</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
                <span class="k">break</span>

    <span class="k">if</span> <span class="n">https_cert_uri</span><span class="p">:</span>
        <span class="n">https_cert_import_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">https_cert_uri</span><span class="p">)</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Actions&#39;</span><span class="p">]</span>\
                                                <span class="p">[</span><span class="s1">&#39;#HpeHttpsCert.ImportCertificate&#39;</span><span class="p">][</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
        <span class="n">body</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">body</span><span class="p">[</span><span class="s2">&quot;Action&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;HpeHttpsCert.ImportCertificate&quot;</span>
        <span class="n">body</span><span class="p">[</span><span class="s2">&quot;Certificate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ssl_cert</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">https_cert_import_uri</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span>
        <span class="c1">#If iLO responds with soemthing outside of 200 or 201 then lets check the iLO extended info</span>
        <span class="c1">#error message to see what went wrong</span>
        <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">400</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="s1">&#39;@Message.ExtendedInfo&#39;</span><span class="p">],</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> \
                                                                                <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">excp</span><span class="p">:</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;A response error occurred, unable to access iLO Extended &quot;</span>\
                                 <span class="s2">&quot;Message Info...&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;An http response of </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s2"> was returned.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Success!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">dict</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Importing SSL Certificate may take a few minutes...</span><span class="se">\n</span><span class="s2"> &quot;</span>\
                  <span class="s2">&quot;iLO will reset with new changes.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="modify-ilo-management-user-account">
<h2>Modify iLO Management User Account<a class="headerlink" href="#modify-ilo-management-user-account" title="Permalink to this headline">¶</a></h2>
<p>Modify a management interface user account.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">modify_ilo_user_account</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">,</span> <span class="n">username_to_modify</span><span class="p">,</span> <span class="n">new_loginname</span><span class="p">,</span> <span class="n">new_username</span><span class="p">,</span> \
                         <span class="n">new_password</span><span class="p">,</span> <span class="n">role_id</span><span class="p">,</span> <span class="n">privilege_dict</span><span class="p">):</span>

    <span class="n">account_collection_uri</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">resource_instances</span> <span class="o">=</span> <span class="n">get_resource_directory</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">DISABLE_RESOURCE_DIR</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">resource_instances</span><span class="p">:</span>
        <span class="c1">#resource directory is not available so we will navigate through paths manually to obtain</span>
        <span class="c1">#account info</span>
        <span class="n">account_service_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;AccountService&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">account_service_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">account_service_uri</span><span class="p">)</span>
        <span class="n">account_collection_uri</span> <span class="o">=</span> <span class="n">account_service_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Accounts&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="c1">#modify role id</span>
        <span class="k">if</span> <span class="n">role_id</span><span class="p">:</span>
            <span class="n">body</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;RoleId&quot;</span><span class="p">:</span> <span class="n">role_id</span><span class="p">}</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#obtain all account instances from resource directory</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">resource_instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;#ManagerAccountCollection.&#39;</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.type&#39;</span><span class="p">]:</span>
                <span class="n">account_collection_uri</span> <span class="o">=</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">privilege_dict</span><span class="p">:</span>
            <span class="c1">#HPE server, so modify privileges</span>
            <span class="n">body</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Oem&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;Hpe&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;Privileges&quot;</span><span class="p">:</span> <span class="p">{}}}}</span>
            <span class="k">for</span> <span class="n">priv</span> <span class="ow">in</span> <span class="n">privilege_dict</span><span class="p">:</span>
                <span class="n">body</span><span class="p">[</span><span class="s2">&quot;Oem&quot;</span><span class="p">][</span><span class="s2">&quot;Hpe&quot;</span><span class="p">][</span><span class="s2">&quot;Privileges&quot;</span><span class="p">][</span><span class="n">priv</span><span class="p">]</span> <span class="o">=</span> <span class="n">privilege_dict</span><span class="p">[</span><span class="n">priv</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">new_loginname</span><span class="p">:</span>
            <span class="c1">#modify login name</span>
            <span class="n">body</span><span class="p">[</span><span class="s2">&quot;Oem&quot;</span><span class="p">][</span><span class="s2">&quot;Hpe&quot;</span><span class="p">][</span><span class="s2">&quot;LoginName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_loginname</span>

    <span class="k">if</span> <span class="n">new_username</span><span class="p">:</span>
        <span class="n">body</span><span class="p">[</span><span class="s2">&quot;UserName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_username</span>
    <span class="k">if</span> <span class="n">new_password</span><span class="p">:</span>
        <span class="n">body</span><span class="p">[</span><span class="s2">&quot;Password&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_password</span>

    <span class="c1">#find the account to modify</span>
    <span class="n">account_uri_to_modify</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">account_uris</span> <span class="o">=</span> <span class="n">REDFISHOBJ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">account_collection_uri</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">account_uri</span> <span class="ow">in</span> <span class="n">account_uris</span><span class="o">.</span><span class="n">dict</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]:</span>
        <span class="n">account</span> <span class="o">=</span> <span class="n">REDFISHOBJ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">account_uri</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">account</span><span class="o">.</span><span class="n">dict</span><span class="p">[</span><span class="s1">&#39;UserName&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">username_to_modify</span><span class="p">:</span>
            <span class="n">account_uri_to_modify</span> <span class="o">=</span> <span class="n">account_uri</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
            <span class="k">break</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">account_uri_to_modify</span><span class="p">:</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Cannot find account to modify&quot;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="c1">#modify the account</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">REDFISHOBJ</span><span class="o">.</span><span class="n">patch</span><span class="p">(</span><span class="n">account_uri_to_modify</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span>

    <span class="c1">#If iLO responds with soemthing outside of 200 or 201 then lets check the iLO extended info</span>
    <span class="c1">#error message to see what went wrong</span>
    <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">400</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="s1">&#39;@Message.ExtendedInfo&#39;</span><span class="p">],</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">excp</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;A response error occurred, unable to access iLO Extended Message &quot;</span>\
                             <span class="s2">&quot;Info...&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;An http response of &#39;</span><span class="si">%s</span><span class="s2">&#39; was returned.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Success!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">dict</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="id12">
<h3>Response Example<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h3>
<p>An example Redfish response error message.</p>
<div class="highlight-JSON notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;error&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;@Message.ExtendedInfo&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nt">&quot;MessageId&quot;</span><span class="p">:</span> <span class="s2">&quot;Base.1.4.AccountModified&quot;</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="nt">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;iLO.0.10.ExtendedInfo&quot;</span><span class="p">,</span>
        <span class="nt">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;See @Message.ExtendedInfo for more information.&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="modify-virtual-media">
<h2>Modify Virtual Media<a class="headerlink" href="#modify-virtual-media" title="Permalink to this headline">¶</a></h2>
<p>Modify a virtual media entry.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mount_virtual_media_iso</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">,</span> <span class="n">iso_url</span><span class="p">,</span> <span class="n">media_type</span><span class="p">,</span> <span class="n">boot_on_next_server_reset</span><span class="p">):</span>

    <span class="n">virtual_media_uri</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">virtual_media_response</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">resource_instances</span> <span class="o">=</span> <span class="n">get_resource_directory</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DISABLE_RESOURCE_DIR</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">resource_instances</span><span class="p">:</span>
        <span class="c1">#if we do not have a resource directory or want to force it&#39;s non use to find the</span>
        <span class="c1">#relevant URI</span>
        <span class="n">managers_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Managers&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">managers_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">managers_uri</span><span class="p">)</span>
        <span class="n">managers_members_uri</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">managers_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]))[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">managers_members_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">managers_members_uri</span><span class="p">)</span>
        <span class="n">virtual_media_uri</span> <span class="o">=</span> <span class="n">managers_members_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;VirtualMedia&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">resource_instances</span><span class="p">:</span>
            <span class="c1">#Use Resource directory to find the relevant URI</span>
            <span class="k">if</span> <span class="s1">&#39;#VirtualMediaCollection.&#39;</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.type&#39;</span><span class="p">]:</span>
                <span class="n">virtual_media_uri</span> <span class="o">=</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">virtual_media_uri</span><span class="p">:</span>
        <span class="n">virtual_media_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">virtual_media_uri</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">virtual_media_slot</span> <span class="ow">in</span> <span class="n">virtual_media_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">virtual_media_slot</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">media_type</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">dict</span><span class="p">[</span><span class="s1">&#39;MediaTypes&#39;</span><span class="p">]:</span>
                <span class="n">virtual_media_mount_uri</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Actions&#39;</span><span class="p">][</span><span class="s1">&#39;#VirtualMedia.InsertMedia&#39;</span><span class="p">][</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
                <span class="n">post_body</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Image&quot;</span><span class="p">:</span> <span class="n">iso_url</span><span class="p">}</span>

                <span class="k">if</span> <span class="n">iso_url</span><span class="p">:</span>
                    <span class="n">resp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">virtual_media_mount_uri</span><span class="p">,</span> <span class="n">post_body</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">boot_on_next_server_reset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">patch_body</span> <span class="o">=</span> <span class="p">{}</span>
                        <span class="n">patch_body</span><span class="p">[</span><span class="s2">&quot;Oem&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Hpe&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;BootOnNextServerReset&quot;</span><span class="p">:</span> \
                                                 <span class="n">boot_on_next_server_reset</span><span class="p">}}</span>
                        <span class="n">boot_resp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">patch</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">],</span> <span class="n">patch_body</span><span class="p">)</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">boot_resp</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
                            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Failure setting BootOnNextServerReset&quot;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">400</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="s1">&#39;@Message.ExtendedInfo&#39;</span><span class="p">],</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> \
                                                                                    <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
                        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">excp</span><span class="p">:</span>
                            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;A response error occurred, unable to access iLO&quot;</span>
                                             <span class="s2">&quot;Extended Message Info...&quot;</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
                        <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;An http response of </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s2"> was returned.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Success!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">dict</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
                <span class="k">break</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="id13">
<h3>Response Example<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h3>
<p>An example Redfish response error message following a successful modification of a user account.</p>
<div class="highlight-JSON notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;error&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;@Message.ExtendedInfo&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nt">&quot;MessageId&quot;</span><span class="p">:</span> <span class="s2">&quot;Base.1.4.Success&quot;</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="nt">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;iLO.0.10.ExtendedInfo&quot;</span><span class="p">,</span>
        <span class="nt">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;See @Message.ExtendedInfo for more information.&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="reboot-server">
<h2>Reboot Server<a class="headerlink" href="#reboot-server" title="Permalink to this headline">¶</a></h2>
<p>Reboot a server.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">reboot_server</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">):</span>

    <span class="n">systems_members_response</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">resource_instances</span> <span class="o">=</span> <span class="n">get_resource_directory</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DISABLE_RESOURCE_DIR</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">resource_instances</span><span class="p">:</span>
        <span class="c1">#if we do not have a resource directory or want to force it&#39;s non use to find the</span>
        <span class="c1">#relevant URI</span>
        <span class="n">systems_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Systems&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">systems_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">systems_uri</span><span class="p">)</span>
        <span class="n">systems_members_uri</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">systems_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]))[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">systems_members_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">systems_members_uri</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">resource_instances</span><span class="p">:</span>
            <span class="c1">#Use Resource directory to find the relevant URI</span>
            <span class="k">if</span> <span class="s1">&#39;#ComputerSystem.&#39;</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.type&#39;</span><span class="p">]:</span>
                <span class="n">systems_members_uri</span> <span class="o">=</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
                <span class="n">systems_members_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">systems_uri</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">systems_members_response</span><span class="p">:</span>
        <span class="n">system_reboot_uri</span> <span class="o">=</span> <span class="n">systems_members_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Actions&#39;</span><span class="p">][</span><span class="s1">&#39;#ComputerSystem.Reset&#39;</span><span class="p">]</span>\
                                                                                        <span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
        <span class="n">body</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">body</span><span class="p">[</span><span class="s1">&#39;Action&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;ComputerSystem.Reset&#39;</span>
        <span class="n">body</span><span class="p">[</span><span class="s1">&#39;ResetType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ForceRestart&quot;</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">system_reboot_uri</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span>
        <span class="c1">#If iLO responds with soemthing outside of 200 or 201 then lets check the iLO extended info</span>
        <span class="c1">#error message to see what went wrong</span>
        <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">400</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="s1">&#39;@Message.ExtendedInfo&#39;</span><span class="p">],</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> \
                                                                                    <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">excp</span><span class="p">:</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;A response error occurred, unable to access iLO Extended &quot;</span>
                                 <span class="s2">&quot;Message Info...&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;An http response of </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s2"> was returned.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Success!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">dict</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="id14">
<h3>Response Example<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h3>
<p>An example Redfish response error message following a successful application of virtual media.</p>
<div class="highlight-JSON notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;error&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;@Message.ExtendedInfo&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nt">&quot;MessageId&quot;</span><span class="p">:</span> <span class="s2">&quot;Base.1.4.Success&quot;</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="nt">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;iLO.0.10.ExtendedInfo&quot;</span><span class="p">,</span>
        <span class="nt">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;See @Message.ExtendedInfo for more information.&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="remove-an-ilo-user-management-account">
<h2>Remove an iLO User Management Account<a class="headerlink" href="#remove-an-ilo-user-management-account" title="Permalink to this headline">¶</a></h2>
<p>Delete an iLO User Management Account</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">reboot_server</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">):</span>

    <span class="n">systems_members_response</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">resource_instances</span> <span class="o">=</span> <span class="n">get_resource_directory</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DISABLE_RESOURCE_DIR</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">resource_instances</span><span class="p">:</span>
        <span class="c1">#if we do not have a resource directory or want to force it&#39;s non use to find the</span>
        <span class="c1">#relevant URI</span>
        <span class="n">systems_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Systems&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">systems_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">systems_uri</span><span class="p">)</span>
        <span class="n">systems_members_uri</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">systems_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]))[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">systems_members_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">systems_members_uri</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">resource_instances</span><span class="p">:</span>
            <span class="c1">#Use Resource directory to find the relevant URI</span>
            <span class="k">if</span> <span class="s1">&#39;#ComputerSystem.&#39;</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.type&#39;</span><span class="p">]:</span>
                <span class="n">systems_members_uri</span> <span class="o">=</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
                <span class="n">systems_members_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">systems_uri</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">systems_members_response</span><span class="p">:</span>
        <span class="n">system_reboot_uri</span> <span class="o">=</span> <span class="n">systems_members_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Actions&#39;</span><span class="p">][</span><span class="s1">&#39;#ComputerSystem.Reset&#39;</span><span class="p">]</span>\
                                                                                        <span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
        <span class="n">body</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">body</span><span class="p">[</span><span class="s1">&#39;Action&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;ComputerSystem.Reset&#39;</span>
        <span class="n">body</span><span class="p">[</span><span class="s1">&#39;ResetType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ForceRestart&quot;</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">system_reboot_uri</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span>
        <span class="c1">#If iLO responds with soemthing outside of 200 or 201 then lets check the iLO extended info</span>
        <span class="c1">#error message to see what went wrong</span>
        <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">400</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="s1">&#39;@Message.ExtendedInfo&#39;</span><span class="p">],</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> \
                                                                                    <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">excp</span><span class="p">:</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;A response error occurred, unable to access iLO Extended &quot;</span>
                                 <span class="s2">&quot;Message Info...&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;An http response of </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s2"> was returned.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Success!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">dict</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="id15">
<h3>Response Example<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h3>
<p>An example Redfish response error message following a successful application of virtual media.</p>
<div class="highlight-JSON notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;error&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;@Message.ExtendedInfo&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nt">&quot;MessageId&quot;</span><span class="p">:</span> <span class="s2">&quot;Base.1.4.Success&quot;</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="nt">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;iLO.0.10.ExtendedInfo&quot;</span><span class="p">,</span>
        <span class="nt">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;See @Message.ExtendedInfo for more information.&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="reset-eskm-event-log">
<h2>Reset ESKM Event log<a class="headerlink" href="#reset-eskm-event-log" title="Permalink to this headline">¶</a></h2>
<p>Reset Enterprise Secure Key Manager event log.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">reset_ESKM_eventlog</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">):</span>

    <span class="n">body</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="n">security_service_eskm_uri</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">resource_instances</span> <span class="o">=</span> <span class="n">get_resource_directory</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DISABLE_RESOURCE_DIR</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">resource_instances</span><span class="p">:</span>
        <span class="c1">#if we do not have a resource directory or want to force it&#39;s non use to find the</span>
        <span class="c1">#relevant URI</span>
        <span class="n">managers_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Managers&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">managers_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">managers_uri</span><span class="p">)</span>
        <span class="n">managers_members_uri</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">managers_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]))[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">managers_members_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">managers_members_uri</span><span class="p">)</span>
        <span class="n">security_service_uri</span> <span class="o">=</span> <span class="n">managers_members_response</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">Oem</span><span class="o">.</span><span class="n">Hpe</span><span class="o">.</span><span class="n">Links</span>\
                                                                <span class="p">[</span><span class="s1">&#39;SecurityService&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">security_service_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">security_service_uri</span><span class="p">)</span>
        <span class="n">security_service_eskm_uri</span> <span class="o">=</span> <span class="n">security_service_response</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">Links</span><span class="p">[</span><span class="s1">&#39;ESKM&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#Use Resource directory to find the relevant URI</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">resource_instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;#HpeESKM.&#39;</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.type&#39;</span><span class="p">]:</span>
                <span class="n">security_service_eskm_uri</span> <span class="o">=</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
                <span class="k">break</span>

    <span class="k">if</span> <span class="n">security_service_eskm_uri</span><span class="p">:</span>
        <span class="n">security_service_eskm_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">security_service_uri</span><span class="p">)</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">Links</span>\
                                                                            <span class="p">[</span><span class="s1">&#39;ESKM&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">security_service_eskm_resp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">security_service_eskm_uri</span><span class="p">)</span>
        <span class="n">security_service_eskm_clearlog_uri</span> <span class="o">=</span> <span class="n">security_service_eskm_resp</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Actions&#39;</span><span class="p">]</span>\
                                                                <span class="p">[</span><span class="s1">&#39;#HpeESKM.ClearESKMLog&#39;</span><span class="p">][</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
        <span class="n">body</span><span class="p">[</span><span class="s2">&quot;Action&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;HpeESKM.ClearESKMLog&quot;</span>
        <span class="c1">#We pass the URI and the dictionary as a POST command (part of the redfish object)</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">security_service_eskm_clearlog_uri</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span>
        <span class="c1">#If iLO responds with something outside of 200 or 201 then lets check the iLO extended info</span>
        <span class="c1">#error message to see what went wrong</span>

        <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">400</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="s1">&#39;@Message.ExtendedInfo&#39;</span><span class="p">],</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> \
                                                                                <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">excp</span><span class="p">:</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;A response error occurred, unable to access iLO Extended &quot;</span>\
                                 <span class="s2">&quot;Message Info...&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;An http response of </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s2"> was returned.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Success!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">dict</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="id16">
<h3>Response Example<a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h3>
<p>An example Redfish response error message following a successful reset of ESKM log.</p>
<div class="highlight-JSON notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;error&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;@Message.ExtendedInfo&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nt">&quot;MessageId&quot;</span><span class="p">:</span> <span class="s2">&quot;Base.1.4.Success&quot;</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="nt">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;iLO.0.10.ExtendedInfo&quot;</span><span class="p">,</span>
        <span class="nt">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;See @Message.ExtendedInfo for more information.&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="reset-ilo">
<h2>Reset iLO<a class="headerlink" href="#reset-ilo" title="Permalink to this headline">¶</a></h2>
<p>Reset iLO BMC.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">reset_ilo</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">):</span>

    <span class="n">managers_members_response</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">resource_instances</span> <span class="o">=</span> <span class="n">get_resource_directory</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DISABLE_RESOURCE_DIR</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">resource_instances</span><span class="p">:</span>
        <span class="c1">#if we do not have a resource directory or want to force it&#39;s non use to find the</span>
        <span class="c1">#relevant URI</span>
        <span class="n">managers_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Managers&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">managers_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">managers_uri</span><span class="p">)</span>
        <span class="n">managers_members_uri</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">managers_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]))[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">managers_members_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">managers_members_uri</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#Use Resource directory to find the relevant URI</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">resource_instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;#Manager.&#39;</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.type&#39;</span><span class="p">]:</span>
                <span class="n">managers_members_uri</span> <span class="o">=</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
                <span class="n">managers_members_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">managers_members_uri</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">managers_members_response</span><span class="p">:</span>
        <span class="n">reset_ilo_uri</span> <span class="o">=</span> <span class="n">managers_members_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Actions&#39;</span><span class="p">][</span><span class="s1">&#39;#Manager.Reset&#39;</span><span class="p">][</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
        <span class="n">body</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Action&#39;</span><span class="p">:</span> <span class="s1">&#39;Manager.Reset&#39;</span><span class="p">}</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">reset_ilo_uri</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span>

    <span class="c1">#If iLO responds with soemthing outside of 200 or 201 then lets check the iLO extended info</span>
    <span class="c1">#error message to see what went wrong</span>
    <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">400</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="s1">&#39;@Message.ExtendedInfo&#39;</span><span class="p">],</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">excp</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;A response error occurred, unable to access iLO Extended Message &quot;</span>\
                             <span class="s2">&quot;Info...&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;An http response of </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s2"> was returned.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Success!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">dict</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="id17">
<h3>Response Example<a class="headerlink" href="#id17" title="Permalink to this headline">¶</a></h3>
<p>An example Redfish response error message following a successful reset of iLO.</p>
<div class="highlight-JSON notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="nt">&quot;error&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;@Message.ExtendedInfo&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nt">&quot;MessageId&quot;</span><span class="p">:</span> <span class="s2">&quot;iLO.2.14.ResetInProgress&quot;</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="nt">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;iLO.0.10.ExtendedInfo&quot;</span><span class="p">,</span>
        <span class="nt">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;See @Message.ExtendedInfo for more information.&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="sessions">
<h2>Sessions<a class="headerlink" href="#sessions" title="Permalink to this headline">¶</a></h2>
<p>Example of session management.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sessions</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">,</span> <span class="n">login_account</span><span class="p">,</span> <span class="n">login_password</span><span class="p">):</span>

    <span class="n">new_session</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;UserName&quot;</span><span class="p">:</span> <span class="n">login_account</span><span class="p">,</span> <span class="s2">&quot;Password&quot;</span><span class="p">:</span> <span class="n">login_password</span><span class="p">}</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s1">&#39;/redfish/v1/Sessions&#39;</span><span class="p">,</span> <span class="n">new_session</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">201</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Success!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">session_uri</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">getheader</span><span class="p">(</span><span class="s2">&quot;location&quot;</span><span class="p">)</span>
        <span class="n">session_uri</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urlparse</span><span class="p">(</span><span class="n">session_uri</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Session &quot;</span> <span class="o">+</span> <span class="n">session_uri</span><span class="o">.</span><span class="n">path</span> <span class="o">+</span> <span class="s2">&quot; created.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">x_auth_token</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">getheader</span><span class="p">(</span><span class="s2">&quot;x-auth-token&quot;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">This is the session X-Auth Token key &quot;</span> <span class="o">+</span> <span class="n">x_auth_token</span> <span class="o">+</span> <span class="s2">&quot;.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">dict</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

        <span class="c1"># Delete the created session</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Terminating this session.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">sessresp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">session_uri</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">sessresp</span><span class="o">.</span><span class="n">dict</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;ERROR: failed to create a session.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">sessresp</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="s1">&#39;@Message.ExtendedInfo&#39;</span><span class="p">],</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> \
                                                                            <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">excp</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;A response error occurred, unable to access iLO Extended&quot;</span>
                             <span class="s2">&quot; Message Info...&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="session-creation">
<h3>Session Creation<a class="headerlink" href="#session-creation" title="Permalink to this headline">¶</a></h3>
<p>Session token and URI. Session tokens can be cached and used for authentication for all subsequent calls
as long as the session has not been terminated by the client or timed out by the server.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is only true in production mode. Some higher security modes may require additional authentication
techniques to be performed.</p>
</div>
<div class="highlight-TEXT notranslate"><div class="highlight"><pre><span></span>Session X-Auth Token: 61ac3d750eeda276749cdd2138117a8f
Session URI: /redfish/v1/SessionService/Sessions/admin000000005f3d4cbfdbde43a8
</pre></div>
</div>
<p>An example Redfish response error message following a successful creation.</p>
<div class="highlight-JSON notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;@odata.context&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/$metadata#Session.Session&quot;</span><span class="p">,</span>
    <span class="nt">&quot;@odata.etag&quot;</span><span class="p">:</span> <span class="s2">&quot;W/\&quot;F1F51DF3\&quot;&quot;</span><span class="p">,</span>
    <span class="nt">&quot;@odata.id&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/SessionService/Sessions/admin000000005f3d4cbfdbde43a8&quot;</span><span class="p">,</span>
    <span class="nt">&quot;@odata.type&quot;</span><span class="p">:</span> <span class="s2">&quot;#Session.v1_0_0.Session&quot;</span><span class="p">,</span>
    <span class="nt">&quot;Description&quot;</span><span class="p">:</span> <span class="s2">&quot;Manager User Session&quot;</span><span class="p">,</span>
    <span class="nt">&quot;Id&quot;</span><span class="p">:</span> <span class="s2">&quot;admin000000005f3d4cbfdbde43a8&quot;</span><span class="p">,</span>
    <span class="nt">&quot;Name&quot;</span><span class="p">:</span> <span class="s2">&quot;User Session&quot;</span><span class="p">,</span>
    <span class="nt">&quot;Oem&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;Hpe&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;@odata.context&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/$metadata#HpeiLOSession.HpeiLOSession&quot;</span><span class="p">,</span>
            <span class="nt">&quot;@odata.type&quot;</span><span class="p">:</span> <span class="s2">&quot;#HpeiLOSession.v2_1_0.HpeiLOSession&quot;</span><span class="p">,</span>
            <span class="nt">&quot;AccessTime&quot;</span><span class="p">:</span> <span class="s2">&quot;2020-08-19T16:01:03Z&quot;</span><span class="p">,</span>
            <span class="nt">&quot;LoginTime&quot;</span><span class="p">:</span> <span class="s2">&quot;2020-08-19T16:01:03Z&quot;</span><span class="p">,</span>
            <span class="nt">&quot;MySession&quot;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
            <span class="nt">&quot;UserExpires&quot;</span><span class="p">:</span> <span class="s2">&quot;2020-08-19T16:31:03Z&quot;</span><span class="p">,</span>
            <span class="nt">&quot;UserIP&quot;</span><span class="p">:</span> <span class="s2">&quot;16.214.34.25&quot;</span><span class="p">,</span>
            <span class="nt">&quot;UserTag&quot;</span><span class="p">:</span> <span class="s2">&quot;REST&quot;</span><span class="p">,</span>
            <span class="nt">&quot;UserType&quot;</span><span class="p">:</span> <span class="s2">&quot;Local&quot;</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="nt">&quot;UserName&quot;</span><span class="p">:</span> <span class="s2">&quot;admin&quot;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="id18">
<h3>Session Creation<a class="headerlink" href="#id18" title="Permalink to this headline">¶</a></h3>
<p>Terminating a session from the client side simply requires deletion of the session URI.
Attempting to re-access the session results in the following response message.</p>
<div class="highlight-JSON notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;error&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;@Message.ExtendedInfo&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nt">&quot;MessageId&quot;</span><span class="p">:</span> <span class="s2">&quot;Base.1.4.NoValidSession&quot;</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="nt">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;iLO.0.10.ExtendedInfo&quot;</span><span class="p">,</span>
        <span class="nt">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;See @Message.ExtendedInfo for more information.&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="ilo-management-nic-data">
<h2>iLO Management NIC Data<a class="headerlink" href="#ilo-management-nic-data" title="Permalink to this headline">¶</a></h2>
<p>Example of ethernet management NIC enablement/disablement. On iLO systems:
* <em>Ethernet Management Interface 1</em> is typically the physical NIC port
* <em>Ethernet Management Interface 2</em> is typically the shared NIC interface.
** Shared physical System/iLO NIC.
** iLO USB port (requires the use of a USB to NIC adapter)
* <em>Ethernet Management Interface 3</em> is typically the virtual NIC interface. This is generally
PnP with a supported Kernel/kernel virtual usb drivers.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">set_active_ilo_nic</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">):</span>

    <span class="n">ethernet_data</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">resource_instances</span> <span class="o">=</span> <span class="n">get_resource_directory</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DISABLE_RESOURCE_DIR</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">resource_instances</span><span class="p">:</span>
        <span class="c1">#if we do not have a resource directory or want to force it&#39;s non use to find the</span>
        <span class="c1">#relevant URI</span>
        <span class="n">managers_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Managers&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">managers_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">managers_uri</span><span class="p">)</span>
        <span class="n">managers_members_uri</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">managers_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]))[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">managers_members_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">managers_members_uri</span><span class="p">)</span>
        <span class="n">manager_ethernet_interfaces</span> <span class="o">=</span> <span class="n">managers_members_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;EthernetInterfaces&#39;</span><span class="p">]</span>\
                                                                                    <span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">manager_ethernet_interfaces_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">manager_ethernet_interfaces</span><span class="p">)</span>
        <span class="n">manager_ethernet_interfaces_members</span> <span class="o">=</span> <span class="n">manager_ethernet_interfaces_response</span><span class="o">.</span>\
                                                            <span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">_member</span> <span class="ow">in</span> <span class="n">manager_ethernet_interfaces_members</span><span class="p">:</span>
            <span class="n">_tmp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">_member</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">obj</span>
            <span class="n">ethernet_data</span><span class="p">[</span><span class="n">_member</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">_tmp</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#Use Resource directory to find the relevant URI</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">resource_instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;#EthernetInterfaceCollection.&#39;</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.type&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="s1">&#39;Managers&#39;</span> <span class="ow">in</span> \
                                                                        <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]:</span>
                <span class="n">ethernet_uri</span> <span class="o">=</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
                <span class="n">ethernet_interfaces</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ethernet_uri</span><span class="p">)</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">_ethernet_interface</span> <span class="ow">in</span> <span class="n">ethernet_interfaces</span><span class="p">:</span>
                    <span class="n">ethernet_data</span><span class="p">[</span><span class="n">_ethernet_interface</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span>\
                                                        <span class="n">get</span><span class="p">(</span><span class="n">_ethernet_interface</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">dict</span>
                <span class="k">break</span>

    <span class="k">if</span> <span class="n">ethernet_data</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Showing all available ethernet management interfaces before changes:</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">interface</span> <span class="ow">in</span> <span class="n">ethernet_data</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Ethernet Management Inteface </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ethernet_data</span>\
                                                                            <span class="p">[</span><span class="n">interface</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Id&#39;</span><span class="p">))</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t\&#39;</span><span class="s2">Interface Enabled</span><span class="se">\&#39;</span><span class="s2">: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ethernet_data</span><span class="p">[</span><span class="n">interface</span><span class="p">]</span><span class="o">.</span>\
                                                                        <span class="n">get</span><span class="p">(</span><span class="s1">&#39;InterfaceEnabled&#39;</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">ethernet</span> <span class="ow">in</span> <span class="n">ethernet_data</span><span class="p">:</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Ethernet Interface: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ethernet</span><span class="p">)</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Would you like to enable/disable this interface? (enable/disable)</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;en&quot;</span> <span class="ow">in</span> <span class="n">ans</span><span class="p">:</span>
            <span class="n">body</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;InterfaceEnabled&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">body</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;InterfaceEnabled&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">patch</span><span class="p">(</span><span class="n">ethernet</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">400</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="s1">&#39;@Message.ExtendedInfo&#39;</span><span class="p">],</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> \
                                                                                <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">excp</span><span class="p">:</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;A response error occurred, unable to access iLO Extended &quot;</span>\
                                 <span class="s2">&quot;Message Info...&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;An http response of </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s2"> was returned.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Success! You will need to reset iLO for this change to take effect.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">dict</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="bios-iscsi">
<h2>BIOS iSCSI<a class="headerlink" href="#bios-iscsi" title="Permalink to this headline">¶</a></h2>
<p>Configure iSCSI (Internet Small Computer Systems Interface) for ip based network attached storage.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">set_bios_iscsi</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">,</span> <span class="n">iscsi_properties</span><span class="p">):</span>

    <span class="n">iscsi_uri</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">iscsi_data</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">resource_instances</span> <span class="o">=</span> <span class="n">get_resource_directory</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DISABLE_RESOURCE_DIR</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">resource_instances</span><span class="p">:</span>
        <span class="c1">#if we do not have a resource directory or want to force it&#39;s non use to find the</span>
        <span class="c1">#relevant URI</span>
        <span class="n">systems_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Systems&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">systems_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">systems_uri</span><span class="p">)</span>
        <span class="n">systems_members_uri</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">systems_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]))[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">systems_members_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">systems_members_uri</span><span class="p">)</span>
        <span class="n">bios_uri</span> <span class="o">=</span> <span class="n">systems_members_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Bios&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">bios_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">bios_uri</span><span class="p">)</span>
        <span class="n">iscsi_uri</span> <span class="o">=</span> <span class="n">bios_response</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">Oem</span><span class="o">.</span><span class="n">Hpe</span><span class="o">.</span><span class="n">Links</span><span class="p">[</span><span class="s1">&#39;iScsi&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">iscsi_data</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">iscsi_uri</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#Use Resource directory to find the relevant URI</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">resource_instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;#HpeiSCSISoftwareInitiator.&#39;</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.type&#39;</span><span class="p">]:</span>
                <span class="n">iscsi_uri</span> <span class="o">=</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
                <span class="n">iscsi_data</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">iscsi_uri</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">iscsi_data</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">indx</span><span class="p">,</span> <span class="n">inst</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">iscsi_data</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;iSCSISources&#39;</span><span class="p">]):</span>
            <span class="k">if</span> <span class="n">iscsi_properties</span><span class="p">[</span><span class="s1">&#39;iSCSIBootInstance&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">indx</span><span class="p">:</span>
                <span class="n">iscsi_data</span><span class="o">.</span><span class="n">dict</span><span class="p">[</span><span class="s1">&#39;iSCSISources&#39;</span><span class="p">][</span><span class="n">indx</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">iscsi_properties</span><span class="p">)</span>
                <span class="n">resp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">patch</span><span class="p">(</span><span class="n">iscsi_uri</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;iSCSISources&#39;</span> <span class="p">:</span> <span class="n">iscsi_data</span><span class="o">.</span><span class="n">dict</span><span class="p">[</span><span class="s1">&#39;iSCSISources&#39;</span><span class="p">]})</span>
                <span class="c1">#If iLO responds with soemthing outside of 200 or 201 then lets check the</span>
                <span class="c1">#iLO extended info error message to see what went wrong</span>
                <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">400</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="s1">&#39;@Message.ExtendedInfo&#39;</span><span class="p">],</span> \
                                                                        <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">excp</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">ori</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
                        <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;A response error occurred, unable to access iLO &quot;</span> \
                                         <span class="s2">&quot;Extended Message Info...&quot;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
                    <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;An http response of </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s2"> was returned.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Success! A system reboot will be required to complete the change.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">dict</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
                <span class="k">break</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="id19">
<h3>Response Example<a class="headerlink" href="#id19" title="Permalink to this headline">¶</a></h3>
<p>Successful modification of iSCSI data.</p>
<div class="highlight-JSON notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;error&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;@Message.ExtendedInfo&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nt">&quot;MessageId&quot;</span><span class="p">:</span> <span class="s2">&quot;iLO.2.14.SystemResetRequired&quot;</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="nt">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;iLO.0.10.ExtendedInfo&quot;</span><span class="p">,</span>
        <span class="nt">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;See @Message.ExtendedInfo for more information.&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="set-bios-password">
<h2>Set BIOS Password<a class="headerlink" href="#set-bios-password" title="Permalink to this headline">¶</a></h2>
<p>Set BIOS Password.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">set_bios_password</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">,</span> <span class="n">new_password</span><span class="p">,</span> <span class="n">bios_password</span><span class="p">):</span>

    <span class="n">bios_uri</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">resource_instances</span> <span class="o">=</span> <span class="n">get_resource_directory</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DISABLE_RESOURCE_DIR</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">resource_instances</span><span class="p">:</span>
        <span class="c1">#if we do not have a resource directory or want to force it&#39;s non use to find the</span>
        <span class="c1">#relevant URI</span>
        <span class="n">systems_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Systems&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">systems_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">systems_uri</span><span class="p">)</span>
        <span class="n">systems_members_uri</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">systems_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]))[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">systems_members_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">systems_members_uri</span><span class="p">)</span>
        <span class="n">bios_uri</span> <span class="o">=</span> <span class="n">systems_members_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Bios&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#Use Resource directory to find the relevant URI</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">resource_instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;#Bios.&#39;</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.type&#39;</span><span class="p">]:</span>
                <span class="n">bios_uri</span> <span class="o">=</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
                <span class="k">break</span>

    <span class="k">if</span> <span class="n">bios_uri</span><span class="p">:</span>
        <span class="n">bios_data</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">bios_uri</span><span class="p">)</span>
        <span class="n">bios_change_pass_uri</span> <span class="o">=</span> <span class="n">bios_data</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Actions&#39;</span><span class="p">][</span><span class="s1">&#39;#Bios.ChangePassword&#39;</span><span class="p">][</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
        <span class="n">body</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="n">body</span><span class="p">[</span><span class="s2">&quot;PasswordName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Administrator&quot;</span>
        <span class="n">body</span><span class="p">[</span><span class="s2">&quot;OldPassword&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bios_password</span>
        <span class="n">body</span><span class="p">[</span><span class="s2">&quot;NewPassword&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_password</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">bios_change_pass_uri</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span>
        <span class="c1">#If iLO responds with soemthing outside of 200 or 201 then lets check the iLO extended info</span>
        <span class="c1">#error message to see what went wrong</span>
        <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">400</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="s1">&#39;@Message.ExtendedInfo&#39;</span><span class="p">],</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> \
                                                                                <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">excp</span><span class="p">:</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;A response error occurred, unable to access iLO Extended &quot;</span>\
                                 <span class="s2">&quot;Message Info...&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;An http response of </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s2"> was returned.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Success!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">dict</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="id20">
<h3>Response Example<a class="headerlink" href="#id20" title="Permalink to this headline">¶</a></h3>
<p>Successful modification of BIOS password.</p>
<div class="highlight-JSON notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;error&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;@Message.ExtendedInfo&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nt">&quot;MessageId&quot;</span><span class="p">:</span> <span class="s2">&quot;Base.1.4.Success&quot;</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="nt">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;iLO.0.10.ExtendedInfo&quot;</span><span class="p">,</span>
        <span class="nt">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;See @Message.ExtendedInfo for more information.&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="set-eskm-primary-key">
<h2>Set ESKM Primary Key<a class="headerlink" href="#set-eskm-primary-key" title="Permalink to this headline">¶</a></h2>
<p>Set HPE Enterprise Secure Key Manager Key Manager Config.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A valid ESKM key manager config is required and is tested upon patch submission.
An error initializing ESKM may occur if the ESKM key manager or associated required
properties are invalid. See <a class="reference external" href="mailto:'&#37;&#52;&#48;Message&#46;ExtendedInfo">‘<span>&#64;</span>Message<span>&#46;</span>ExtendedInfo</a>’ in the http response message.</p>
</div>
<div class="highlight-JSON notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;error&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;iLO.0.10.ExtendedInfo&quot;</span><span class="p">,</span>
        <span class="nt">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;See @Message.ExtendedInfo for more information.&quot;</span><span class="p">,</span>
        <span class="nt">&quot;@Message.ExtendedInfo&quot;</span><span class="p">:</span> <span class="p">[{</span>
            <span class="nt">&quot;MessageId&quot;</span><span class="p">:</span> <span class="s2">&quot;iLO.2.14.ErrorIntializingESKM&quot;</span>
        <span class="p">}]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">set_ESKM_PrimaryKeyServer</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">,</span> <span class="n">primary_key_server_address</span><span class="p">,</span> <span class="n">primary_key_server_port</span><span class="p">):</span>

    <span class="n">eskm_uri</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">body</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

    <span class="n">resource_instances</span> <span class="o">=</span> <span class="n">get_resource_directory</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DISABLE_RESOURCE_DIR</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">resource_instances</span><span class="p">:</span>
        <span class="c1">#if we do not have a resource directory or want to force it&#39;s non use to find the</span>
        <span class="c1">#relevant URI</span>
        <span class="n">managers_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Managers&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">managers_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">managers_uri</span><span class="p">)</span>
        <span class="n">managers_members_uri</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">managers_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]))[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">managers_members_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">managers_members_uri</span><span class="p">)</span>
        <span class="n">security_service_uri</span> <span class="o">=</span> <span class="n">managers_members_response</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">Oem</span><span class="o">.</span><span class="n">Hpe</span><span class="o">.</span><span class="n">Links</span><span class="p">[</span><span class="s1">&#39;SecurityService&#39;</span><span class="p">]</span>\
                                                                                    <span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">security_service_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">security_service_uri</span><span class="p">)</span>
        <span class="n">eskm_uri</span> <span class="o">=</span> <span class="n">security_service_response</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">Links</span><span class="p">[</span><span class="s1">&#39;ESKM&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#Use Resource directory to find the relevant URI</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">resource_instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;#HpeESKM.&#39;</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.type&#39;</span><span class="p">]:</span>
                <span class="n">eskm_uri</span> <span class="o">=</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
                <span class="k">break</span>

    <span class="k">if</span> <span class="n">eskm_uri</span><span class="p">:</span>

        <span class="n">body</span><span class="p">[</span><span class="s2">&quot;PrimaryKeyServerAddress&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">primary_key_server_address</span>
        <span class="n">body</span><span class="p">[</span><span class="s2">&quot;PrimaryKeyServerPort&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">primary_key_server_port</span><span class="p">)</span>

        <span class="n">resp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">eskm_uri</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span>
        <span class="c1">#If iLO responds with soemthing outside of 200 or 201 then lets check the iLO extended info</span>
        <span class="c1">#error message to see what went wrong</span>
        <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">400</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="s1">&#39;@Message.ExtendedInfo&#39;</span><span class="p">],</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> \
                                                                                <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">excp</span><span class="p">:</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;A response error occurred, unable to access iLO Extended &quot;</span>\
                                 <span class="s2">&quot;Message Info...&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;An http response of </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s2"> was returned.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Success!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">dict</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<p>Configure Ethernet Management NIC(s) for DHCP/Static Network Addressing.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">set_ilo_static_ipv4</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">,</span> <span class="n">ipv4_dict</span><span class="p">,</span> <span class="n">dns_dict</span><span class="p">):</span>

    <span class="n">ethernet_data</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">body</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

    <span class="n">resource_instances</span> <span class="o">=</span> <span class="n">get_resource_directory</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DISABLE_RESOURCE_DIR</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">resource_instances</span><span class="p">:</span>
        <span class="c1">#if we do not have a resource directory or want to force it&#39;s non use to find the</span>
        <span class="c1">#relevant URI</span>
        <span class="n">managers_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Managers&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">managers_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">managers_uri</span><span class="p">)</span>
        <span class="n">managers_members_uri</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">managers_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]))[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">managers_members_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">managers_members_uri</span><span class="p">)</span>
        <span class="n">manager_ethernet_interfaces</span> <span class="o">=</span> <span class="n">managers_members_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;EthernetInterfaces&#39;</span><span class="p">]</span>\
                                                                                    <span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">manager_ethernet_interfaces_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">manager_ethernet_interfaces</span><span class="p">)</span>
        <span class="n">manager_ethernet_interfaces_members</span> <span class="o">=</span> <span class="n">manager_ethernet_interfaces_response</span><span class="o">.</span>\
                                                            <span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">_member</span> <span class="ow">in</span> <span class="n">manager_ethernet_interfaces_members</span><span class="p">:</span>
            <span class="n">_tmp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">_member</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">obj</span>
            <span class="n">ethernet_data</span><span class="p">[</span><span class="n">_member</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">_tmp</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#Use Resource directory to find the relevant URI</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">resource_instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;#EthernetInterfaceCollection.&#39;</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.type&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="s1">&#39;Managers&#39;</span> <span class="ow">in</span> \
                                                                        <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]:</span>
                <span class="n">ethernet_uri</span> <span class="o">=</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
                <span class="n">ethernet_interfaces</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ethernet_uri</span><span class="p">)</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">_ethernet_interface</span> <span class="ow">in</span> <span class="n">ethernet_interfaces</span><span class="p">:</span>
                    <span class="n">ethernet_data</span><span class="p">[</span><span class="n">_ethernet_interface</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span>\
                                                        <span class="n">get</span><span class="p">(</span><span class="n">_ethernet_interface</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">dict</span>
                <span class="k">break</span>

    <span class="k">if</span> <span class="n">ethernet_data</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Showing all available ethernet management interfaces before changes:</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">interface</span> <span class="ow">in</span> <span class="n">ethernet_data</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Ethernet Management Inteface </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ethernet_data</span>\
                                                                            <span class="p">[</span><span class="n">interface</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Id&#39;</span><span class="p">))</span>

            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\&#39;</span><span class="s2">DHCPv4</span><span class="se">\&#39;</span><span class="s2">:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ethernet_data</span><span class="p">[</span><span class="n">interface</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DHCPv4&#39;</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">ethernet_data</span><span class="p">[</span><span class="n">interface</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DHCPv4&#39;</span><span class="p">),</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">ethernet_data</span><span class="p">[</span><span class="n">interface</span><span class="p">][</span><span class="s1">&#39;Oem&#39;</span><span class="p">][</span><span class="s1">&#39;Hpe&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;DHCPv4&#39;</span><span class="p">),</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> \
                                                                                <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\&#39;</span><span class="s2">IPv4</span><span class="se">\&#39;</span><span class="s2">:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ethernet_data</span><span class="p">[</span><span class="n">interface</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;IPv4StaticAddresses&#39;</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">ethernet_data</span><span class="p">[</span><span class="n">interface</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;IPv4Addresses&#39;</span><span class="p">),</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> \
                                                                                <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\&#39;</span><span class="s2">StaticNameServers</span><span class="se">\&#39;</span><span class="s2">:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ethernet_data</span><span class="p">[</span><span class="n">interface</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;StaticNameServers&#39;</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">ethernet_data</span><span class="p">[</span><span class="n">interface</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;StaticNameServers&#39;</span><span class="p">),</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> \
                                                                                <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">ethernet</span> <span class="ow">in</span> <span class="n">ethernet_data</span><span class="p">:</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Ethernet Interface: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ethernet</span><span class="p">)</span>
        <span class="n">ans</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Would you like to modify this interface? (y/n)</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;n&quot;</span> <span class="ow">in</span> <span class="n">ans</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="s1">&#39;DHCPv4&#39;</span> <span class="ow">in</span> <span class="n">ethernet_data</span><span class="p">[</span><span class="n">ethernet</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">ethernet_data</span><span class="p">[</span><span class="n">ethernet</span><span class="p">][</span><span class="s1">&#39;DHCPv4&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;UseDNSServers&#39;</span><span class="p">):</span>
                <span class="n">resp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">patch</span><span class="p">(</span><span class="n">ethernet</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;DHCPv4&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;UseDNSServers&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}})</span>
                <span class="n">ilo_response</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">,</span> <span class="n">resp</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ethernet_data</span><span class="p">[</span><span class="n">ethernet</span><span class="p">][</span><span class="s1">&#39;DHCPv4&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;UseGateway&#39;</span><span class="p">):</span>
                <span class="n">resp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">pathc</span><span class="p">(</span><span class="n">ethernet</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;DHCPv4&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;UseGateway&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}})</span>
                <span class="n">ilo_response</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">,</span> <span class="n">resp</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;IPv4StaticAddresses&#39;</span> <span class="ow">in</span> <span class="n">ethernet_data</span><span class="p">[</span><span class="n">ethernet</span><span class="p">]:</span>
            <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;IPv4Addresses&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">ipv4_dict</span><span class="p">]})</span>
        <span class="k">if</span> <span class="s1">&#39;StaticNameServers&#39;</span> <span class="ow">in</span> <span class="n">ethernet_data</span><span class="p">[</span><span class="n">ethernet</span><span class="p">]:</span>
            <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;StaticNameServers&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="n">dns_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PrimaryDNS&#39;</span><span class="p">),</span> \
                                                                    <span class="n">dns_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SecondaryDNS&#39;</span><span class="p">)]})</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">body</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;Oem&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;Hpe&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;IPv4&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;DNSServers&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">dns_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PrimaryDNS&#39;</span><span class="p">),</span> \
                                                                 <span class="n">dns_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;SecondaryDNS&#39;</span><span class="p">)]}}}})</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">patch</span><span class="p">(</span><span class="n">ethernet</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span>
        <span class="n">ilo_response</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">,</span> <span class="n">resp</span><span class="p">)</span>
        <span class="k">break</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="set-ilo-ntp-server-settings">
<h2>Set iLO NTP Server Settings<a class="headerlink" href="#set-ilo-ntp-server-settings" title="Permalink to this headline">¶</a></h2>
<p>Configure NTP Server Settings.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The physical or shared ethernet networking adapter must be configured with <em>‘StaticNTPServers’:’True’</em>,
if static network time protocol servers are to be used. DHCP must also be disabled. The following is an error
message which will occur in the event DHCP is enabled while attempting to configure static NTP server entries.</p>
<div class="highlight-JSON notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;MessageArgs&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;StaticNTPServers&quot;</span>
    <span class="p">],</span>
    <span class="nt">&quot;MessageId&quot;</span><span class="p">:</span> <span class="s2">&quot;iLO.2.14.SNTPConfigurationManagedByDHCPAndIsReadOnly&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">set_ilo_ntp_servers</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">,</span> <span class="n">ntp_server_list</span><span class="p">):</span>

    <span class="n">date_time_uri</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">resource_instances</span> <span class="o">=</span> <span class="n">get_resource_directory</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DISABLE_RESOURCE_DIR</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">resource_instances</span><span class="p">:</span>
        <span class="c1">#if we do not have a resource directory or want to force it&#39;s non use to find the</span>
        <span class="c1">#relevant URI</span>
        <span class="n">managers_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Managers&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">managers_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">managers_uri</span><span class="p">)</span>
        <span class="n">managers_members_uri</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">managers_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]))[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">managers_members_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">managers_members_uri</span><span class="p">)</span>
        <span class="n">date_time_uri</span> <span class="o">=</span> <span class="n">managers_members_response</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">Oem</span><span class="o">.</span><span class="n">Hpe</span><span class="o">.</span><span class="n">Links</span><span class="p">[</span><span class="s1">&#39;DateTimeService&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#Use Resource directory to find the relevant URI</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">resource_instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;#HpeiLODateTime.&#39;</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.type&#39;</span><span class="p">]:</span>
                <span class="n">date_time_uri</span> <span class="o">=</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">date_time_uri</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">date_time_uri</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;StaticNTPServers&#39;</span><span class="p">):</span>
            <span class="n">resp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">patch</span><span class="p">(</span><span class="n">date_time_uri</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;StaticNTPServers&#39;</span><span class="p">:</span> <span class="n">ntp_server_list</span><span class="p">})</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\&#39;</span><span class="s2">StaticNTPServers</span><span class="se">\&#39;</span><span class="s2"> property is not available/modifyable.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1">#If iLO responds with soemthing outside of 200 or 201 then lets check the iLO extended info</span>
        <span class="c1">#error message to see what went wrong</span>
        <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">400</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="s1">&#39;@Message.ExtendedInfo&#39;</span><span class="p">],</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> \
                                                                                <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">excp</span><span class="p">:</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;A response error occurred, unable to access iLO Extended &quot;</span> \
                                 <span class="s2">&quot;Message Info...&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;An http response of </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s2"> was returned.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Success!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">dict</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            <span class="n">ntp_data</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">date_time_uri</span><span class="p">)</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;StaticNTPServers&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Printing updated NTP Servers:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">ntp_data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="id21">
<h3>Response Example<a class="headerlink" href="#id21" title="Permalink to this headline">¶</a></h3>
<p>Successful modification of StaticNTPServers. (Only displaying response from <em>iLODateTime</em>)</p>
<blockquote>
<div><div class="highlight-JSON notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;error&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;@Message.ExtendedInfo&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nt">&quot;MessageId&quot;</span><span class="p">:</span> <span class="s2">&quot;iLO.2.14.SystemResetRequired&quot;</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="nt">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;iLO.0.10.ExtendedInfo&quot;</span><span class="p">,</span>
        <span class="nt">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;See @Message.ExtendedInfo for more information.&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div></blockquote>
</div>
</div>
<div class="section" id="set-timezone">
<h2>Set Timezone<a class="headerlink" href="#set-timezone" title="Permalink to this headline">¶</a></h2>
<p>Configure Network Time Protocol Time zone.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>DHCP must be disabled. The following is an error message which will occur in the event DHCP is enabled while
attempting to modify the NTP timezone.</p>
<div class="highlight-JSON notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;MessageArgs&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;StaticNTPServers&quot;</span>
    <span class="p">],</span>
    <span class="nt">&quot;MessageId&quot;</span><span class="p">:</span> <span class="s2">&quot;iLO.2.14.SNTPConfigurationManagedByDHCPAndIsReadOnly&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">set_timezone</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">,</span> <span class="n">timezone</span><span class="p">):</span>

    <span class="n">date_time_uri</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">resource_instances</span> <span class="o">=</span> <span class="n">get_resource_directory</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DISABLE_RESOURCE_DIR</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">resource_instances</span><span class="p">:</span>
        <span class="c1">#if we do not have a resource directory or want to force it&#39;s non use to find the</span>
        <span class="c1">#relevant URI</span>
        <span class="n">managers_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Managers&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">managers_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">managers_uri</span><span class="p">)</span>
        <span class="n">managers_members_uri</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">managers_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]))[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">managers_members_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">managers_members_uri</span><span class="p">)</span>
        <span class="n">date_time_uri</span> <span class="o">=</span> <span class="n">managers_members_response</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">Oem</span><span class="o">.</span><span class="n">Hpe</span><span class="o">.</span><span class="n">Links</span><span class="p">[</span><span class="s1">&#39;DateTimeService&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#Use Resource directory to find the relevant URI</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">resource_instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;#HpeiLODateTime.&#39;</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.type&#39;</span><span class="p">]:</span>
                <span class="n">date_time_uri</span> <span class="o">=</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">date_time_uri</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">date_time_uri</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TimeZone&#39;</span><span class="p">):</span>
            <span class="n">_data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;TimeZone&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;Name&quot;</span><span class="p">:</span> <span class="n">timezone</span><span class="p">}}</span>
            <span class="n">resp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">patch</span><span class="p">(</span><span class="n">date_time_uri</span><span class="p">,</span> <span class="n">_data</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\&#39;</span><span class="s2">TimeZone</span><span class="se">\&#39;</span><span class="s2"> property is not available/modifyable.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1">#If iLO responds with soemthing outside of 200 or 201 then lets check the iLO extended info</span>
        <span class="c1">#error message to see what went wrong</span>
        <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">400</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="s1">&#39;@Message.ExtendedInfo&#39;</span><span class="p">],</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> \
                                                                                <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TimeZoneList&#39;</span><span class="p">),</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Check the TimeZone value...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">excp</span><span class="p">:</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;A response error occurred, unable to access iLO Extended &quot;</span> \
                                 <span class="s2">&quot;Message Info...&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;An http response of </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s2"> was returned.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Success!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">dict</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            <span class="n">ntp_data</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">date_time_uri</span><span class="p">)</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;TimeZone&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Printing updated NTP Servers:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">ntp_data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="id22">
<h3>Response Example<a class="headerlink" href="#id22" title="Permalink to this headline">¶</a></h3>
<p>Successful modification of iLO timezone.</p>
<div class="highlight-JSON notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;error&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;@Message.ExtendedInfo&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nt">&quot;MessageId&quot;</span><span class="p">:</span> <span class="s2">&quot;Base.1.4.Success&quot;</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="nt">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;iLO.0.10.ExtendedInfo&quot;</span><span class="p">,</span>
        <span class="nt">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;See @Message.ExtendedInfo for more information.&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="configure-ilo-license-key">
<h2>Configure iLO License Key<a class="headerlink" href="#configure-ilo-license-key" title="Permalink to this headline">¶</a></h2>
<p>Configure iLO License Key.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">set_license_key</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">,</span> <span class="n">ilo_key</span><span class="p">):</span>

    <span class="n">ilo_lic_uri</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">resource_instances</span> <span class="o">=</span> <span class="n">get_resource_directory</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DISABLE_RESOURCE_DIR</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">resource_instances</span><span class="p">:</span>
        <span class="c1">#if we do not have a resource directory or want to force it&#39;s non use to find the</span>
        <span class="c1">#relevant URI</span>
        <span class="n">managers_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Managers&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">managers_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">managers_uri</span><span class="p">)</span>
        <span class="n">managers_members_uri</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">managers_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]))[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">managers_members_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">managers_members_uri</span><span class="p">)</span>
        <span class="n">ilo_lic_uri</span> <span class="o">=</span> <span class="n">managers_members_response</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">Oem</span><span class="o">.</span><span class="n">Hpe</span><span class="o">.</span><span class="n">Links</span><span class="p">[</span><span class="s1">&#39;LicenseService&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#Use Resource directory to find the relevant URI</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">resource_instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;#HpeiLOLicense.&#39;</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.type&#39;</span><span class="p">]:</span>
                <span class="n">ilo_lic_uri</span> <span class="o">=</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">ilo_lic_uri</span><span class="p">:</span>
        <span class="n">ilo_license_collection</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ilo_lic_uri</span><span class="p">)</span>
        <span class="n">ilo_license_member_uri</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">ilo_license_collection</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]))[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">ilo_license_data</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ilo_license_member_uri</span><span class="p">)</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;ConfirmationRequest&#39;</span><span class="p">]</span>\
                                                                                            <span class="p">[</span><span class="s1">&#39;EON&#39;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;This machine will not show the full License Key.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">ilo_license_data</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ilo_license_member_uri</span><span class="p">)</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;LicenseKey&#39;</span><span class="p">]</span>

        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Current iLO License Data:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">ilo_license_data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">ilo_lic_uri</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;LicenseKey&#39;</span> <span class="p">:</span> <span class="n">ilo_key</span><span class="p">})</span>
        <span class="c1">#If iLO responds with soemthing outside of 200 or 201 then lets check the iLO extended info</span>
        <span class="c1">#error message to see what went wrong</span>
        <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">400</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="s1">&#39;@Message.ExtendedInfo&#39;</span><span class="p">],</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> \
                                                                                <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Check the validity of your license key...</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">excp</span><span class="p">:</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;A response error occurred, unable to access iLO &quot;</span> \
                                 <span class="s2">&quot;Extended Message Info...&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;An http response of </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s2"> was returned.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Success!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">dict</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="response-example-valid">
<h3>Response Example Valid<a class="headerlink" href="#response-example-valid" title="Permalink to this headline">¶</a></h3>
<p>Successful addition/modification of iLO license key.</p>
<div class="highlight-JSON notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;error&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;@Message.ExtendedInfo&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nt">&quot;MessageId&quot;</span><span class="p">:</span> <span class="s2">&quot;Base.1.4.Success&quot;</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="nt">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;iLO.0.10.ExtendedInfo&quot;</span><span class="p">,</span>
        <span class="nt">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;See @Message.ExtendedInfo for more information.&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="response-example-invalid">
<h3>Response Example Invalid<a class="headerlink" href="#response-example-invalid" title="Permalink to this headline">¶</a></h3>
<p>An invalid iLO license key.</p>
<div class="highlight-JSON notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;error&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;@Message.ExtendedInfo&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nt">&quot;MessageId&quot;</span><span class="p">:</span> <span class="s2">&quot;iLO.2.14.InvalidLicenseKey&quot;</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="nt">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;iLO.0.10.ExtendedInfo&quot;</span><span class="p">,</span>
        <span class="nt">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;See @Message.ExtendedInfo for more information.&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="server-asset-tag">
<h2>Server Asset Tag<a class="headerlink" href="#server-asset-tag" title="Permalink to this headline">¶</a></h2>
<p>Configure Redfish asset tag.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">set_server_asset_tag</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">,</span> <span class="n">tag</span><span class="p">):</span>

    <span class="n">systems_members_uri</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">systems_members_response</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">resource_instances</span> <span class="o">=</span> <span class="n">get_resource_directory</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DISABLE_RESOURCE_DIR</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">resource_instances</span><span class="p">:</span>
        <span class="c1">#if we do not have a resource directory or want to force it&#39;s non use to find the</span>
        <span class="c1">#relevant URI</span>
        <span class="n">systems_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Systems&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">systems_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">systems_uri</span><span class="p">)</span>
        <span class="n">systems_members_uri</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">systems_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]))[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">systems_members_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">systems_members_uri</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#Use Resource directory to find the relevant URI</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">resource_instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;#ComputerSystem.&#39;</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.type&#39;</span><span class="p">]:</span>
                <span class="n">systems_members_uri</span> <span class="o">=</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
                <span class="n">systems_members_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">systems_members_uri</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">systems_members_response</span> <span class="ow">and</span> <span class="n">systems_members_uri</span> <span class="ow">and</span> <span class="n">tag</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Current Asset Tag: </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">systems_members_response</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;AssetTag&quot;</span><span class="p">))</span>

        <span class="n">resp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">patch</span><span class="p">(</span><span class="n">systems_members_uri</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;AssetTag&quot;</span> <span class="p">:</span> <span class="n">tag</span><span class="p">})</span>
        <span class="c1">#If iLO responds with soemthing outside of 200 or 201 then lets check the iLO extended info</span>
        <span class="c1">#error message to see what went wrong</span>
        <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">400</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="s1">&#39;@Message.ExtendedInfo&#39;</span><span class="p">],</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> \
                                                                                <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">excp</span><span class="p">:</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;A response error occurred, unable to access iLO Extended &quot;</span>\
                                 <span class="s2">&quot;Message Info...&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;An http response of </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s2"> was returned.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Success!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">dict</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="c1">#going to wait 10 seconds before obtaining the LED indicator state</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Updated Asset Tag: </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">_redfishobj</span><span class="o">.</span>\
                                                    <span class="n">get</span><span class="p">(</span><span class="n">systems_members_uri</span><span class="p">)</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;AssetTag&quot;</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="id23">
<h3>Response Example<a class="headerlink" href="#id23" title="Permalink to this headline">¶</a></h3>
<p>Successful addition/modification of Redfish asset tag.</p>
<div class="highlight-JSON notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;error&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;@Message.ExtendedInfo&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nt">&quot;MessageId&quot;</span><span class="p">:</span> <span class="s2">&quot;Base.1.4.Success&quot;</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="nt">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;iLO.0.10.ExtendedInfo&quot;</span><span class="p">,</span>
        <span class="nt">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;See @Message.ExtendedInfo for more information.&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="server-uid-light">
<h2>Server UID Light<a class="headerlink" href="#server-uid-light" title="Permalink to this headline">¶</a></h2>
<p>Configure System Unit Identification Light as either ‘Lit’ or ‘Off’.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">set_uid_light</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">):</span>

    <span class="n">body</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="n">systems_members_uri</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">systems_members_response</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">resource_instances</span> <span class="o">=</span> <span class="n">get_resource_directory</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DISABLE_RESOURCE_DIR</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">resource_instances</span><span class="p">:</span>
        <span class="c1">#if we do not have a resource directory or want to force it&#39;s non use to find the</span>
        <span class="c1">#relevant URI</span>
        <span class="n">systems_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Systems&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">systems_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">systems_uri</span><span class="p">)</span>
        <span class="n">systems_members_uri</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">systems_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]))[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">systems_members_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">systems_members_uri</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#Use Resource directory to find the relevant URI</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">resource_instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;#ComputerSystem.&#39;</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.type&#39;</span><span class="p">]:</span>
                <span class="n">systems_members_uri</span> <span class="o">=</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
                <span class="n">systems_members_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">systems_members_uri</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">systems_members_response</span> <span class="ow">and</span> <span class="n">systems_members_uri</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Current Indicator LED Status: </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">systems_members_response</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span>\
                                                                            <span class="n">get</span><span class="p">(</span><span class="s2">&quot;IndicatorLED&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="s2">&quot;Off&quot;</span> <span class="ow">in</span> <span class="n">systems_members_response</span><span class="o">.</span><span class="n">dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;IndicatorLED&quot;</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Will illuminate indicator LED.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">body</span><span class="p">[</span><span class="s2">&quot;IndicatorLED&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Lit&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Will extinguish indicator LED.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">body</span><span class="p">[</span><span class="s2">&quot;IndicatorLED&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Off&quot;</span>

        <span class="n">resp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">patch</span><span class="p">(</span><span class="n">systems_members_uri</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span>
        <span class="c1">#If iLO responds with soemthing outside of 200 or 201 then lets check the iLO extended info</span>
        <span class="c1">#error message to see what went wrong</span>
        <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">400</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="s1">&#39;@Message.ExtendedInfo&#39;</span><span class="p">],</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> \
                                                                                <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">excp</span><span class="p">:</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;A response error occurred, unable to access iLO Extended &quot;</span>\
                                 <span class="s2">&quot;Message Info...&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;An http response of </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s2"> was returned.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Success!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">dict</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="c1">#going to wait 10 seconds before obtaining the LED indicator state</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Updated Indicator LED Status: </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">_redfishobj</span><span class="o">.</span>\
                                                    <span class="n">get</span><span class="p">(</span><span class="n">systems_members_uri</span><span class="p">)</span><span class="o">.</span><span class="n">dict</span><span class="p">[</span><span class="s1">&#39;IndicatorLED&#39;</span><span class="p">])</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="id24">
<h3>Response Example<a class="headerlink" href="#id24" title="Permalink to this headline">¶</a></h3>
<p>Successful addition/modification of UID light.</p>
<div class="highlight-JSON notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;error&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;@Message.ExtendedInfo&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nt">&quot;MessageId&quot;</span><span class="p">:</span> <span class="s2">&quot;Base.1.4.Success&quot;</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="nt">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;iLO.0.10.ExtendedInfo&quot;</span><span class="p">,</span>
        <span class="nt">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;See @Message.ExtendedInfo for more information.&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="server-firmware-inventory">
<h2>Server Firmware Inventory<a class="headerlink" href="#server-firmware-inventory" title="Permalink to this headline">¶</a></h2>
<p>List all iLO onboard device firmware.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_inventory_uri</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">,</span> <span class="n">select</span><span class="p">):</span>

    <span class="n">update_service_uri</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">inventory_uri</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">resource_instances</span> <span class="o">=</span> <span class="n">get_resource_directory</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DISABLE_RESOURCE_DIR</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">resource_instances</span><span class="p">:</span>
        <span class="c1">#if we do not have a resource directory or want to force it&#39;s non use to find the</span>
        <span class="c1">#relevant URI</span>
        <span class="n">update_service_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;UpdateService&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#Use Resource directory to find the relevant URI</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">resource_instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;#UpdateService.&#39;</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.type&#39;</span><span class="p">]:</span>
                <span class="n">update_service_uri</span> <span class="o">=</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">update_service_uri</span><span class="p">:</span>
        <span class="n">update_service_resp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">update_service_uri</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;software&quot;</span> <span class="ow">in</span> <span class="n">select</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="n">inventory_uri</span> <span class="o">=</span> <span class="n">update_service_resp</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;SoftwareInventory&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="s2">&quot;firmware&quot;</span> <span class="ow">in</span> <span class="n">select</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
            <span class="n">inventory_uri</span> <span class="o">=</span> <span class="n">update_service_resp</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;FirmwareInventory&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Invalid selection provided: Please select &#39;software&#39; or &#39;firmware&#39; &quot;</span> \
                            <span class="s2">&quot;to obtain the relevant invetory data.&quot;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Printing data in invetory: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">inventory_uri</span><span class="p">)</span>
        <span class="n">get_inventory</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">,</span> <span class="n">inventory_uri</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="id25">
<h3>Response Example<a class="headerlink" href="#id25" title="Permalink to this headline">¶</a></h3>
<p>Snippet of Firmware Inventory Response.</p>
<div class="highlight-JSON notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">[</span>
    <span class="p">{</span>
        <span class="nt">&quot;@odata.context&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/$metadata#SoftwareInventory.SoftwareInventory&quot;</span><span class="p">,</span>
        <span class="nt">&quot;@odata.etag&quot;</span><span class="p">:</span> <span class="s2">&quot;W/\&quot;0539D502\&quot;&quot;</span><span class="p">,</span>
        <span class="nt">&quot;@odata.id&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/UpdateService/FirmwareInventory/15/&quot;</span><span class="p">,</span>
        <span class="nt">&quot;@odata.type&quot;</span><span class="p">:</span> <span class="s2">&quot;#SoftwareInventory.v1_0_0.SoftwareInventory&quot;</span><span class="p">,</span>
        <span class="nt">&quot;Description&quot;</span><span class="p">:</span> <span class="s2">&quot;102b0538159000e4&quot;</span><span class="p">,</span>
        <span class="nt">&quot;Id&quot;</span><span class="p">:</span> <span class="s2">&quot;15&quot;</span><span class="p">,</span>
        <span class="nt">&quot;Name&quot;</span><span class="p">:</span> <span class="s2">&quot;Embedded Video Controller&quot;</span><span class="p">,</span>
        <span class="nt">&quot;Oem&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;Hpe&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;@odata.context&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/$metadata#HpeiLOSoftwareInventory.HpeiLOSoftwareInventory&quot;</span><span class="p">,</span>
                <span class="nt">&quot;@odata.type&quot;</span><span class="p">:</span> <span class="s2">&quot;#HpeiLOSoftwareInventory.v2_0_0.HpeiLOSoftwareInventory&quot;</span><span class="p">,</span>
                <span class="nt">&quot;DeviceClass&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
                <span class="nt">&quot;DeviceContext&quot;</span><span class="p">:</span> <span class="s2">&quot;Embedded Device&quot;</span><span class="p">,</span>
                <span class="nt">&quot;DeviceInstance&quot;</span><span class="p">:</span> <span class="s2">&quot;PciRoot(0x0)/Pci(0x1C,0x4)/Pci(0x0,0x1)&quot;</span><span class="p">,</span>
                <span class="nt">&quot;Targets&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;a6b1a447-382a-5a4f-102b-0538159000e4&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="nt">&quot;Version&quot;</span><span class="p">:</span> <span class="s2">&quot;2.5&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="nt">&quot;@odata.context&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/$metadata#SoftwareInventory.SoftwareInventory&quot;</span><span class="p">,</span>
        <span class="nt">&quot;@odata.etag&quot;</span><span class="p">:</span> <span class="s2">&quot;W/\&quot;0539D502\&quot;&quot;</span><span class="p">,</span>
        <span class="nt">&quot;@odata.id&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/UpdateService/FirmwareInventory/13/&quot;</span><span class="p">,</span>
        <span class="nt">&quot;@odata.type&quot;</span><span class="p">:</span> <span class="s2">&quot;#SoftwareInventory.v1_0_0.SoftwareInventory&quot;</span><span class="p">,</span>
        <span class="nt">&quot;Description&quot;</span><span class="p">:</span> <span class="s2">&quot;14e41657103c22be&quot;</span><span class="p">,</span>
        <span class="nt">&quot;Id&quot;</span><span class="p">:</span> <span class="s2">&quot;13&quot;</span><span class="p">,</span>
        <span class="nt">&quot;Name&quot;</span><span class="p">:</span> <span class="s2">&quot;HPE Ethernet 1Gb 4-port 331i Adapter - NIC&quot;</span><span class="p">,</span>
        <span class="nt">&quot;Oem&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;Hpe&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;@odata.context&quot;</span><span class="p">:</span> <span class="s2">&quot;/redfish/v1/$metadata#HpeiLOSoftwareInventory.HpeiLOSoftwareInventory&quot;</span><span class="p">,</span>
                <span class="nt">&quot;@odata.type&quot;</span><span class="p">:</span> <span class="s2">&quot;#HpeiLOSoftwareInventory.v2_0_0.HpeiLOSoftwareInventory&quot;</span><span class="p">,</span>
                <span class="nt">&quot;DeviceClass&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
                <span class="nt">&quot;DeviceContext&quot;</span><span class="p">:</span> <span class="s2">&quot;Embedded LOM&quot;</span><span class="p">,</span>
                <span class="nt">&quot;DeviceInstance&quot;</span><span class="p">:</span> <span class="s2">&quot;PciRoot(0x0)/Pci(0x1C,0x0)/Pci(0x0,0x0)&quot;</span><span class="p">,</span>
                <span class="nt">&quot;Targets&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="s2">&quot;a6b1a447-382a-5a4f-14e4-1657103c22be&quot;</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="nt">&quot;Version&quot;</span><span class="p">:</span> <span class="s2">&quot;20.6.61&quot;</span>
    <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="test-eskm-connectivity">
<h2>Test ESKM Connectivity<a class="headerlink" href="#test-eskm-connectivity" title="Permalink to this headline">¶</a></h2>
<p>Test HPE Enterprise Secure Key Manager connectivity.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">test_ESKM_connection</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">):</span>

    <span class="n">eskm_uri</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">body</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

    <span class="n">resource_instances</span> <span class="o">=</span> <span class="n">get_resource_directory</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DISABLE_RESOURCE_DIR</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">resource_instances</span><span class="p">:</span>
        <span class="c1">#if we do not have a resource directory or want to force it&#39;s non use to find the</span>
        <span class="c1">#relevant URI</span>
        <span class="n">managers_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Managers&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">managers_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">managers_uri</span><span class="p">)</span>
        <span class="n">managers_members_uri</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">managers_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]))[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">managers_members_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">managers_members_uri</span><span class="p">)</span>
        <span class="n">security_service_uri</span> <span class="o">=</span> <span class="n">managers_members_response</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">Oem</span><span class="o">.</span><span class="n">Hpe</span><span class="o">.</span><span class="n">Links</span><span class="p">[</span><span class="s1">&#39;SecurityService&#39;</span><span class="p">]</span>\
                                                                                    <span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">security_service_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">security_service_uri</span><span class="p">)</span>
        <span class="n">eskm_uri</span> <span class="o">=</span> <span class="n">security_service_response</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">Links</span><span class="p">[</span><span class="s1">&#39;ESKM&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#Use Resource directory to find the relevant URI</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">resource_instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;#HpeESKM.&#39;</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.type&#39;</span><span class="p">]:</span>
                <span class="n">eskm_uri</span> <span class="o">=</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
                <span class="k">break</span>

    <span class="k">if</span> <span class="n">eskm_uri</span><span class="p">:</span>
        <span class="n">eskm_test_conn_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">eskm_uri</span><span class="p">)</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Actions&#39;</span><span class="p">]</span>\
                                                    <span class="p">[</span><span class="s1">&#39;#HpeESKM.TestESKMConnections&#39;</span><span class="p">][</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
        <span class="n">body</span><span class="p">[</span><span class="s2">&quot;Action&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;HpeESKM.TestESKMConnections&quot;</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">eskm_test_conn_uri</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span>
        <span class="c1">#If iLO responds with something outside of 200 or 201 then lets check the iLO extended info</span>
        <span class="c1">#error message to see what went wrong</span>
        <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">400</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="s1">&#39;@Message.ExtendedInfo&#39;</span><span class="p">],</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> \
                                                                                <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">excp</span><span class="p">:</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;A response error occurred, unable to access iLO Extended &quot;</span>\
                                 <span class="s2">&quot;Message Info...&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;An http response of </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s2"> was returned.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Success!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">dict</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="response-example-not-configured">
<h3>Response Example Not Configured<a class="headerlink" href="#response-example-not-configured" title="Permalink to this headline">¶</a></h3>
<p>Response of a failed test ESKM connection action. (ESKM not properly configured)</p>
<div class="highlight-JSON notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;error&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;@Message.ExtendedInfo&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nt">&quot;MessageId&quot;</span><span class="p">:</span> <span class="s2">&quot;iLO.2.14.ESKMServersNotConfigured&quot;</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="nt">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;iLO.0.10.ExtendedInfo&quot;</span><span class="p">,</span>
        <span class="nt">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;See @Message.ExtendedInfo for more information.&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="id26">
<h2>Test ESKM Connectivity<a class="headerlink" href="#id26" title="Permalink to this headline">¶</a></h2>
<p>Test HPE Enterprise Secure Key Manager connectivity.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">test_ESKM_connection</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">):</span>

    <span class="n">eskm_uri</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">body</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

    <span class="n">resource_instances</span> <span class="o">=</span> <span class="n">get_resource_directory</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DISABLE_RESOURCE_DIR</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">resource_instances</span><span class="p">:</span>
        <span class="c1">#if we do not have a resource directory or want to force it&#39;s non use to find the</span>
        <span class="c1">#relevant URI</span>
        <span class="n">managers_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Managers&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">managers_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">managers_uri</span><span class="p">)</span>
        <span class="n">managers_members_uri</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">managers_response</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Members&#39;</span><span class="p">]))[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">managers_members_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">managers_members_uri</span><span class="p">)</span>
        <span class="n">security_service_uri</span> <span class="o">=</span> <span class="n">managers_members_response</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">Oem</span><span class="o">.</span><span class="n">Hpe</span><span class="o">.</span><span class="n">Links</span><span class="p">[</span><span class="s1">&#39;SecurityService&#39;</span><span class="p">]</span>\
                                                                                    <span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
        <span class="n">security_service_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">security_service_uri</span><span class="p">)</span>
        <span class="n">eskm_uri</span> <span class="o">=</span> <span class="n">security_service_response</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">Links</span><span class="p">[</span><span class="s1">&#39;ESKM&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#Use Resource directory to find the relevant URI</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">resource_instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;#HpeESKM.&#39;</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.type&#39;</span><span class="p">]:</span>
                <span class="n">eskm_uri</span> <span class="o">=</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
                <span class="k">break</span>

    <span class="k">if</span> <span class="n">eskm_uri</span><span class="p">:</span>
        <span class="n">eskm_test_conn_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">eskm_uri</span><span class="p">)</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Actions&#39;</span><span class="p">]</span>\
                                                    <span class="p">[</span><span class="s1">&#39;#HpeESKM.TestESKMConnections&#39;</span><span class="p">][</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
        <span class="n">body</span><span class="p">[</span><span class="s2">&quot;Action&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;HpeESKM.TestESKMConnections&quot;</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">eskm_test_conn_uri</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span>
        <span class="c1">#If iLO responds with something outside of 200 or 201 then lets check the iLO extended info</span>
        <span class="c1">#error message to see what went wrong</span>
        <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">400</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="s1">&#39;@Message.ExtendedInfo&#39;</span><span class="p">],</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> \
                                                                                <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">excp</span><span class="p">:</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;A response error occurred, unable to access iLO Extended &quot;</span>\
                                 <span class="s2">&quot;Message Info...&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;An http response of </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s2"> was returned.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Success!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">dict</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<div class="section" id="id27">
<h3>Response Example Not Configured<a class="headerlink" href="#id27" title="Permalink to this headline">¶</a></h3>
<p>Response of a failed test ESKM connection action. (ESKM not properly configured)</p>
<div class="highlight-JSON notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;error&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;@Message.ExtendedInfo&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nt">&quot;MessageId&quot;</span><span class="p">:</span> <span class="s2">&quot;iLO.2.14.ESKMServersNotConfigured&quot;</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="nt">&quot;code&quot;</span><span class="p">:</span> <span class="s2">&quot;iLO.0.10.ExtendedInfo&quot;</span><span class="p">,</span>
        <span class="nt">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;See @Message.ExtendedInfo for more information.&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="update-ilo-firmware">
<h2>Update iLO Firmware<a class="headerlink" href="#update-ilo-firmware" title="Permalink to this headline">¶</a></h2>
<p>Process for a client to invoke a simple update of iLO firmware. Firmware is intended to be hosted
and gathered by iLO by pointing to a URL for iLO to consume. A valid URL will result in an http 202
response code; however, this only indicates iLO will separately handle both downloading and processing
the firmware update. The client will need to separately poll for status information regarding the update
progress.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">update_ilo_firmware</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">,</span> <span class="n">fw_url</span><span class="p">,</span> <span class="n">tpm_flag</span><span class="p">):</span>

    <span class="n">body</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="n">update_service_uri</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">resource_instances</span> <span class="o">=</span> <span class="n">get_resource_directory</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">DISABLE_RESOURCE_DIR</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">resource_instances</span><span class="p">:</span>
        <span class="c1">#if we do not have a resource directory or want to force it&#39;s non use to find the</span>
        <span class="c1">#relevant URI</span>
        <span class="n">update_service_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;UpdateService&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#Use Resource directory to find the relevant URI</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">resource_instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;#UpdateService.&#39;</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.type&#39;</span><span class="p">]:</span>
                <span class="n">update_service_uri</span> <span class="o">=</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
                <span class="k">break</span>

    <span class="k">if</span> <span class="n">update_service_uri</span> <span class="ow">and</span> <span class="n">fw_url</span><span class="p">:</span>
        <span class="n">update_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">update_service_uri</span><span class="p">)</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;Actions&#39;</span><span class="p">]</span>\
                                                        <span class="p">[</span><span class="s1">&#39;#UpdateService.SimpleUpdate&#39;</span><span class="p">][</span><span class="s1">&#39;target&#39;</span><span class="p">]</span>
        <span class="n">body</span><span class="p">[</span><span class="s2">&quot;ImageURI&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fw_url</span>
        <span class="k">if</span> <span class="n">tpm_flag</span><span class="p">:</span>
            <span class="n">body</span><span class="p">[</span><span class="s2">&quot;TPMOverrideFlag&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tpm_flag</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">update_uri</span><span class="p">,</span> <span class="n">body</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">400</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">]</span>\
                                 <span class="p">[</span><span class="s1">&#39;@Message.ExtendedInfo&#39;</span><span class="p">],</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">excp</span><span class="p">:</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;A response error occurred, unable to access iLO Extended &quot;</span>\
                                 <span class="s2">&quot;Message Info...&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;An http response of </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s2"> was returned.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Success!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;error&#39;</span><span class="p">][</span><span class="s1">&#39;@Message.ExtendedInfo&#39;</span><span class="p">],</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="upload-firmware-to-ilo-repository">
<h2>Upload firmware to iLO Repository<a class="headerlink" href="#upload-firmware-to-ilo-repository" title="Permalink to this headline">¶</a></h2>
<p>Upload firmware to iLO’s Absaroka flash based repository. Firmware can be stored and catalogued, to be
used at a later date or in the need to recover the platform from a failure condition. An http response code
of 200 will be supplied upon completion of a successful upload; no other extended message information is provided.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">upload_firmware</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">,</span> <span class="n">firmware_loc</span><span class="p">,</span> <span class="n">update_repo</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">update_target</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">resource_instances</span> <span class="o">=</span> <span class="n">get_resource_directory</span><span class="p">(</span><span class="n">_redfishobj</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">DISABLE_RESOURCE_DIR</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">resource_instances</span><span class="p">:</span>
        <span class="c1">#resource directory is not available so we will navigate through paths manually</span>
        <span class="n">update_service_uri</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;UpdateService&#39;</span><span class="p">][</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#obtain all account instances from resource directory</span>
        <span class="k">for</span> <span class="n">instance</span> <span class="ow">in</span> <span class="n">resource_instances</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;#UpdateService.&#39;</span> <span class="ow">in</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.type&#39;</span><span class="p">]:</span>
                <span class="n">update_service_uri</span> <span class="o">=</span> <span class="n">instance</span><span class="p">[</span><span class="s1">&#39;@odata.id&#39;</span><span class="p">]</span>

    <span class="n">update_service_response</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">update_service_uri</span><span class="p">)</span>

    <span class="n">path</span> <span class="o">=</span> <span class="n">update_service_response</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">HttpPushUri</span>

    <span class="n">body</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">json_data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;UpdateRepository&#39;</span><span class="p">:</span> <span class="n">update_repo</span><span class="p">,</span> <span class="s1">&#39;UpdateTarget&#39;</span><span class="p">:</span> <span class="n">update_target</span><span class="p">,</span> <span class="s1">&#39;ETag&#39;</span><span class="p">:</span> <span class="s1">&#39;atag&#39;</span><span class="p">,</span> <span class="s1">&#39;Section&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
    <span class="n">session_key</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">session_key</span>

    <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">firmware_loc</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">firmware_loc</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fle</span><span class="p">:</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">fle</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

    <span class="n">session_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;sessionKey&#39;</span><span class="p">,</span> <span class="n">session_key</span><span class="p">)</span>
    <span class="n">parameters_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;parameters&#39;</span><span class="p">,</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">json_data</span><span class="p">))</span>
    <span class="n">file_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;file&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="s1">&#39;application/octet-stream&#39;</span><span class="p">))</span>

    <span class="c1">#Build the payload from each multipart-form data tuple</span>
    <span class="n">body</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">session_tuple</span><span class="p">)</span>
    <span class="n">body</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">parameters_tuple</span><span class="p">)</span>
    <span class="n">body</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">file_tuple</span><span class="p">)</span>

    <span class="c1">#Create our header dictionary</span>
    <span class="n">header</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Cookie&#39;</span><span class="p">:</span> <span class="s1">&#39;sessionKey=&#39;</span> <span class="o">+</span> <span class="n">session_key</span><span class="p">}</span>

    <span class="c1">#We pass the whole list payload to post</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">_redfishobj</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">header</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">400</span><span class="p">:</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Failed to upload firmware...&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">201</span><span class="p">]:</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;An http response of &#39;</span><span class="si">%s</span><span class="s2">&#39; was returned.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">resp</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Upload complete!</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
</div>


           </div>
          </div>
          <footer>

    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">

        <a href="Frequently-Asked-Questions.html" class="btn btn-neutral float-right" title="Frequently Asked Questions" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>


        <a href="System-Compatibility.html" class="btn btn-neutral" title="System Compatibility" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>

    </div>


  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Copyright 2020 Hewlett Packard Enterprise Development LP.

    </p>
  </div>


</footer>

        </div>
      </div>

    </section>

  </div>


  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Other Versions</span>
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Versions</dt>
          <dd><a href="https://pages.github.hpe.com/intelligent-provisioning/python-redfish-library/">latest</dd>
          <dd><a href="https://pages.github.hpe.com/intelligent-provisioning/python-redfish-library/3.0/">3.0</dd>
      </dl>

    </div>
  </div>





    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'3.1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/language_data.js"></script>





    <script type="text/javascript" src="_static/js/theme.js"></script>




  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>


</body>
</html>
